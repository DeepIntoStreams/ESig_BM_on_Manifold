(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    720844,      18381]
NotebookOptionsPosition[    704009,      18105]
NotebookOutlinePosition[    704448,      18122]
CellTagsIndexPosition[    704405,      18119]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{3.908703410641102*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"622a88d2-5018-4af6-8546-c6868657da8f"],

Cell[BoxData["\<\"/Users/chaoruiwang/Documents/GitHub/tpower3_coefficient_\
calculation/src\"\>"], "Output",
 CellChangeTimes->{
  3.9087034122532597`*^9, 3.908703445690732*^9, 3.908791558243804*^9, 
   3.908968271743598*^9, 3.909213894344507*^9, 3.909391042449284*^9, 
   3.909484779046637*^9, 3.910074539998634*^9, 3.910172839931673*^9, 
   3.910355558132189*^9, 3.9103559816756077`*^9, 3.9106876126928997`*^9, 
   3.910689251295354*^9, 3.9107001459239283`*^9, 3.910700877020898*^9, 
   3.910701330006886*^9, 3.91198918447285*^9, 3.913297769641354*^9, 
   3.915607133208533*^9, 3.9163723728700733`*^9, 3.917550631105691*^9, 
   3.918723161995001*^9, 3.920100203066517*^9, 3.920113261354819*^9, 
   3.921737019460833*^9, 3.922463390753902*^9, 3.923643600628805*^9, 
   3.926469563954074*^9, {3.929455334514271*^9, 3.9294553372463913`*^9}},
 CellLabel->"Out[2]=",ExpressionUUID->"0b5d706a-a7de-4980-a6ce-f6b2968dc99d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"Import", " ", "the", " ", "package", " ", 
    RowBox[{"ItosLemma", ".", "m"}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Needs", "[", "\"\<ItosLemma`\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "TimeSymbol", ",", "TimeIncrement", ",", "BrownianIncrement", ",", 
       "CorrelationSymbol", ",", "DriftSymbol", ",", "DiffusionSymbol"}], 
      "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "u", ",", "dt", ",", "dB", ",", "correlation", ",", "\[Mu]", ",", 
       "\[Sigma]"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"x", ",", "y"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"Subscript", ",", "x"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"Subscript", ",", "\[Mu]", ",", "\[Sigma]"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"Subscript", ",", "a"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.908703277556401*^9, 3.908703297211985*^9}, 
   3.9087033332874393`*^9, {3.908703365932096*^9, 3.908703429298266*^9}, {
   3.908703463448318*^9, 3.908703464044245*^9}, {3.908707774122493*^9, 
   3.908707824362262*^9}, {3.92010011124699*^9, 3.920100139895142*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"82a62473-b86e-40bb-8d40-a27094d513a1"],

Cell[CellGroupData[{

Cell["General Introduction", "Chapter",
 CellChangeTimes->{{3.920102557055032*^9, 
  3.9201025877237873`*^9}},ExpressionUUID->"b8d705e7-71c4-47df-9638-\
cf7624df4216"],

Cell["\<\
This notebook contains the building blocks for all the calculation for the \
total order 2 cases for the paper entitled \[OpenCurlyDoubleQuote]Expected \
Signature on a Riemannian Manifold and Its Geometric Implications\
\[CloseCurlyDoubleQuote].\
\>", "Text",
 CellChangeTimes->{
  3.922432048807572*^9, {3.929455455401732*^9, 
   3.9294554883033123`*^9}},ExpressionUUID->"871e7092-775b-4520-9b4a-\
0ad7d7a0ae72"],

Cell[TextData[{
 "Recall that the total order 2 cases stand for that the ",
 StyleBox["least expansion orders",
  FontWeight->"Bold"],
 " of four terms in the tensor product ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Pi]", 
              RowBox[{"0", ",", 
                StyleBox["t", "TI"]}], "2"], "\[CircleTimes]", 
             SubsuperscriptBox["\[Pi]", 
              RowBox[{"0", ",", 
                StyleBox["t", "TI"]}], "2"]}], "]"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\mathbb{E}[\\pi^2_{0,t} \\otimes \\pi^2_{0,t}]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "73952d9a-f23b-493a-8d50-96696ec7c591"],
 " add up to 2. (One may refer to section 5.4 for full details). "
}], "Text",
 CellChangeTimes->{{3.920102591211546*^9, 3.920102653682637*^9}, {
   3.922426716377341*^9, 3.922426727924129*^9}, {3.922426940388562*^9, 
   3.922427026773038*^9}, 3.922427198982202*^9, 3.922427240343699*^9, {
   3.922427290642267*^9, 3.922427302767009*^9}, {3.922427480648158*^9, 
   3.9224276019236603`*^9}, {3.92242764733374*^9, 3.922427656855126*^9}, {
   3.922427755207812*^9, 3.922427790241696*^9}, {3.922427868254001*^9, 
   3.922427927379167*^9}, {3.92242798329532*^9, 3.922428065232687*^9}, {
   3.922432044288959*^9, 3.922432046142973*^9}, {3.929455424756633*^9, 
   3.929455432003448*^9}, {3.9294554961175003`*^9, 
   3.929455505766458*^9}},ExpressionUUID->"cc3d0fa1-c919-4ba1-a3e9-\
5e777bf2648d"],

Cell[TextData[{
 "We have the fundamental facts that\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox["\[Pi]", 
          RowBox[{"0", ",", 
            StyleBox["t", "TI"]}], "2"], "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["t", "TI"]], 
         SubscriptBox["\[Gamma]", 
          StyleBox["v", "TI"]], "\[CircleTimes]", 
         StyleBox["d", "TI"], 
         SubscriptBox["\[Gamma]", 
          StyleBox["v", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\pi^2_{0,t} = \\int_0^t \\gamma_v \\otimes d\\gamma_v", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "55cdcbeb-b54d-4955-bf53-d77759cece8e"],
 ", \n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Gamma]", 
          StyleBox["v", "TI"]], "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["v", "TI"]], "\[Phi]", 
         RowBox[{"(", 
           RowBox[{"\[EmptySmallCircle]", 
             StyleBox["d", "TI"], 
             SubscriptBox[
              StyleBox["X", "TI"], 
              StyleBox["u", "TI"]]}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\gamma_v = \\int_0^v \\phi(\\circ dX_u)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b63ca708-20d1-4d83-ae67-366334e6e80f"],
 ",\nand\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Phi]", 
         RowBox[{"(", 
           RowBox[{"\[EmptySmallCircle]", 
             StyleBox["d", "TI"], 
             SubscriptBox[
              StyleBox["X", "TI"], 
              StyleBox["u", "TI"]]}], ")"}], "\[LongEqual]", "-", 
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], 
         RowBox[{"(", 
           SubscriptBox[
            StyleBox["X", "TI"], 
            StyleBox["u", "TI"]], ")"}], 
         FractionBox[
          SubsuperscriptBox[
           StyleBox["X", "TI"], 
           StyleBox["u", "TI"], 
           StyleBox["i", "TI"]], 
          RowBox[{
            StyleBox["t", "TI"], "-", 
            StyleBox["u", "TI"]}]], 
         StyleBox["d", "TI"], 
         StyleBox["u", "TI"], "+", "\[Psi]", 
         RowBox[{"(", 
           SubscriptBox[
            StyleBox["X", "TI"], 
            StyleBox["u", "TI"]], ")"}], 
         StyleBox["d", "TI"], 
         StyleBox["u", "TI"], "+", 
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], 
         RowBox[{"(", 
           SubscriptBox[
            StyleBox["X", "TI"], 
            StyleBox["u", "TI"]], ")"}], 
         SubsuperscriptBox[
          RowBox[{"(", 
            RowBox[{"\[Sigma]", 
              StyleBox["d", "TI"], 
              StyleBox["B", "TI"]}], ")"}], 
          StyleBox["u", "TI"], 
          StyleBox["i", "TI"]], "+", 
         UnderoverscriptBox["\[Sum]", 
          RowBox[{
            StyleBox["k", "TI"], "\[LongEqual]", "1"}], "\[Infinity]", 
          LimitsPositioning -> True], 
         FractionBox[
          RowBox[{"\[PartialD]", 
            SubscriptBox[
             StyleBox["G", "TI"], 
             RowBox[{
               StyleBox["k", "TI"], "+", "1"}]]}], 
          RowBox[{"\[PartialD]", 
            SuperscriptBox[
             StyleBox["x", "TI"], 
             StyleBox["i", "TI"]]}]], 
         RowBox[{"(", 
           RowBox[{
             SubscriptBox[
              StyleBox["X", "TI"], 
              StyleBox["u", "TI"]], ",", "0"}], ")"}], 
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], 
         RowBox[{"(", 
           SubscriptBox[
            StyleBox["X", "TI"], 
            StyleBox["u", "TI"]], ")"}], 
         SuperscriptBox[
          RowBox[{"(", 
            RowBox[{
              StyleBox["t", "TI"], "-", 
              StyleBox["u", "TI"]}], ")"}], 
          StyleBox["k", "TI"]], 
         StyleBox["d", "TI"], 
         StyleBox["u", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi(\\circ dX_u) = -\\phi_i(X_u)\\frac{X^i_u}{t-u}du + \\psi(X_u)du + \
\\phi_i(X_u)(\\sigma dB)^i_u + \\sum_{k=1}^{\\infty}\\frac{\\partial \
G_{k+1}}{\\partial x^i}(X_u, 0)\\phi_i(X_u)(t-u)^kdu", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "234a3867-22ac-4a2a-8d34-be53418f145c"],
 ".\nLet\[CloseCurlyQuote]s denote\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["I", "TI"], 
          StyleBox["u", "TI"]], "\[LongEqual]", "-", 
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], 
         FractionBox[
          SubsuperscriptBox[
           StyleBox["X", "TI"], 
           StyleBox["u", "TI"], 
           StyleBox["i", "TI"]], 
          RowBox[{
            StyleBox["t", "TI"], "-", 
            StyleBox["u", "TI"]}]], 
         StyleBox["d", "TI"], 
         StyleBox["u", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "I_u = -\\phi_i \\frac{X^i_u}{t-u}du", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1589e4d0-312f-42be-98bf-b361573bf964"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["J", "TI"], 
          StyleBox["u", "TI"]], "\[LongEqual]", "\[Psi]", 
         RowBox[{"(", 
           SubscriptBox[
            StyleBox["X", "TI"], 
            StyleBox["u", "TI"]], ")"}], 
         StyleBox["d", "TI"], 
         StyleBox["u", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "J_u = \\psi(X_u)du", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e04b42da-9f58-4357-868c-13a754a2dfac"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["K", "TI"], 
          StyleBox["u", "TI"]], "\[LongEqual]", 
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], 
         RowBox[{"(", 
           SubscriptBox[
            StyleBox["X", "TI"], 
            StyleBox["u", "TI"]], ")"}], 
         SubsuperscriptBox[
          RowBox[{"(", 
            RowBox[{"\[Sigma]", 
              StyleBox["d", "TI"], 
              StyleBox["B", "TI"]}], ")"}], 
          StyleBox["u", "TI"], 
          StyleBox["i", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "K_u = \\phi_i(X_u) (\\sigma dB)_u^i", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "102f54c3-c6a9-44bd-996b-149602839fa4"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["L", "TI"], 
          StyleBox["u", "TI"]], "\[LongEqual]", 
         UnderoverscriptBox["\[Sum]", 
          RowBox[{
            StyleBox["k", "TI"], "\[LongEqual]", "1"}], "\[Infinity]", 
          LimitsPositioning -> True], 
         FractionBox[
          RowBox[{"\[PartialD]", 
            SubscriptBox[
             StyleBox["G", "TI"], 
             RowBox[{
               StyleBox["k", "TI"], "+", "1"}]]}], 
          RowBox[{"\[PartialD]", 
            SuperscriptBox[
             StyleBox["x", "TI"], 
             StyleBox["i", "TI"]]}]], 
         RowBox[{"(", 
           RowBox[{
             SubscriptBox[
              StyleBox["X", "TI"], 
              StyleBox["u", "TI"]], ",", "0"}], ")"}], 
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], 
         RowBox[{"(", 
           SubscriptBox[
            StyleBox["X", "TI"], 
            StyleBox["u", "TI"]], ")"}], 
         SuperscriptBox[
          RowBox[{"(", 
            RowBox[{
              StyleBox["t", "TI"], "-", 
              StyleBox["u", "TI"]}], ")"}], 
          StyleBox["k", "TI"]], 
         StyleBox["d", "TI"], 
         StyleBox["u", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "L_u = \\sum_{k=1}^{\\infty}\\frac{\\partial G_{k+1}}{\\partial \
x^i}(X_u, 0)\\phi_i(X_u)(t-u)^kdu", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "70da94da-66ae-43f9-8fd1-48c37dcb6600"],
 ".\nUse Taylor, we have\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox["\[Pi]", 
          RowBox[{"0", ",", 
            StyleBox["t", "TI"]}], "2"], "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["t", "TI"]], 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["v", "TI"]], 
         RowBox[{"(", 
           RowBox[{
             SubscriptBox[
              StyleBox["I", "TI"], 
              StyleBox["u", "TI"]], "+", 
             SubscriptBox[
              StyleBox["J", "TI"], 
              StyleBox["u", "TI"]], "+", 
             SubscriptBox[
              StyleBox["K", "TI"], 
              StyleBox["u", "TI"]], "+", 
             SubscriptBox[
              StyleBox["L", "TI"], 
              StyleBox["u", "TI"]]}], ")"}], "\[CircleTimes]", 
         RowBox[{"(", 
           RowBox[{
             SubscriptBox[
              StyleBox["I", "TI"], 
              StyleBox["v", "TI"]], "+", 
             SubscriptBox[
              StyleBox["J", "TI"], 
              StyleBox["v", "TI"]], "+", 
             SubscriptBox[
              StyleBox["K", "TI"], 
              StyleBox["v", "TI"]], "+", 
             SubscriptBox[
              StyleBox["L", "TI"], 
              StyleBox["v", "TI"]]}], ")"}], "+", 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["t", "TI"]], 
         SubscriptBox[
          StyleBox["P", "TI"], 
          StyleBox["v", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\pi^2_{0,t} = \\int_0^t \\int_0^v (I_u + J_u + K_u + L_u) \\otimes \
(I_v + J_v + K_v + L_v) + \\int_0^t P_v", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0e99d2a9-f325-4ab9-91f7-69d9d89d650c"],
 ", where ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["P", "TI"], 
        StyleBox["v", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "P_v", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "caf49c1b-fd4f-40a2-b799-a2104380d01f"],
 " is the term that covers the difference between Stratonovich and Taylor, \
which has the expression\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["P", "TI"], 
          StyleBox["u", "TI"]], "\[LongEqual]", 
         FractionBox["1", "2"], 
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], 
         RowBox[{"(", 
           SubscriptBox[
            StyleBox["X", "TI"], 
            StyleBox["v", "TI"]], ")"}], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["j", "TI"]], 
         RowBox[{"(", 
           SubscriptBox[
            StyleBox["X", "TI"], 
            StyleBox["v", "TI"]], ")"}], 
         SuperscriptBox[
          StyleBox["a", "TI"], 
          RowBox[{
            StyleBox["i", "TI"], 
            StyleBox["j", "TI"]}]], 
         RowBox[{"(", 
           SubscriptBox[
            StyleBox["X", "TI"], 
            StyleBox["v", "TI"]], ")"}], 
         StyleBox["d", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "P_u = \\frac{1}{2} \\phi_i(X_v) \\otimes \\phi_j(X_v) a^{ij}(X_v)dv", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "63e936e7-b2c2-4e29-bea3-5960e2c45ec3"],
 "."
}], "Text",
 CellChangeTimes->{
  3.9224280506255207`*^9, {3.929455519191059*^9, 
   3.929455541605443*^9}},ExpressionUUID->"97dc56c2-148a-4914-be07-\
14f2233ef70f"],

Cell[TextData[{
 "Our goal is to calculate the coefficient of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["t", "TI"], "3"], TraditionalForm], "errors" -> {}, "input" -> 
     "t^3", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "761f23cd-794a-4316-a925-48aeee1b89e6"],
 " in the expansion of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Pi]", 
              RowBox[{"0", ",", 
                StyleBox["t", "TI"]}], "2"], "\[CircleTimes]", 
             SubsuperscriptBox["\[Pi]", 
              RowBox[{"0", ",", 
                StyleBox["t", "TI"]}], "2"]}], "]"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\mathbb{E}[\\pi^2_{0,t} \\otimes \\pi^2_{0,t}]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8bca0e7c-02e2-4e7c-a915-5a7664fe4929"],
 " with Brownian loop path. We assume that we start at 0, so our expansion \
will be about the point 0.\nThen we also have the following additional \
fundamental facts.\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox[
          StyleBox["a", "TI"], 
          RowBox[{
            StyleBox["i", "TI"], 
            StyleBox["j", "TI"]}]], 
         RowBox[{"(", "0", ")"}], "\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            StyleBox["i", "TI"], 
            StyleBox["j", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "a^{ij}(0) = \\delta_{ij}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "515f6677-0b40-449f-b515-149897991473"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox[
          StyleBox["b", "TI"], 
          StyleBox["i", "TI"]], 
         RowBox[{"(", "0", ")"}], "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "b^i(0) = 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1c798b79-8a57-4b37-87fa-db438e4557bd"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          RowBox[{"\[PartialD]", 
            SubscriptBox[
             StyleBox["G", "TI"], "1"], 
            RowBox[{"(", 
              RowBox[{"0", ",", "0"}], ")"}]}], 
          RowBox[{"\[PartialD]", 
            SuperscriptBox[
             StyleBox["x", "TI"], 
             StyleBox["i", "TI"]]}]], 
         RowBox[{"(", "0", ")"}], "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\frac{\\partial G_1(0,0)}{\\partial x^i}(0) = 0", "state" -> "Boxes"|>,
    
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "eba97379-f3da-44b8-8b22-6fd3a51b2b55"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[PartialD]", 
          StyleBox["p", "TI"]], 
         SuperscriptBox[
          StyleBox["a", "TI"], 
          RowBox[{
            StyleBox["i", "TI"], 
            StyleBox["j", "TI"]}]], 
         RowBox[{"(", "0", ")"}], "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\partial_p a^{ij}(0) = 0", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ca954329-693e-4118-8f8e-24681ffb273a"],
 ", \n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[PartialD]", 
          StyleBox["i", "TI"]], 
         SuperscriptBox[
          StyleBox["b", "TI"], 
          StyleBox["j", "TI"]], 
         RowBox[{"(", "0", ")"}], "\[LongEqual]", 
         FractionBox["1", "3"], 
         SubscriptBox[
          StyleBox["R", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], 
            StyleBox["p", "TI"], 
            StyleBox["p", "TI"], 
            StyleBox["i", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\partial_i b^j(0) = \\frac{1}{3} R_{jppi}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a01baca6-97ac-44ef-be03-b6bf0fb29121"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{
            StyleBox["p", "TI"], 
            StyleBox["p", "TI"]}]], 
         SuperscriptBox[
          StyleBox["a", "TI"], 
          RowBox[{
            StyleBox["i", "TI"], 
            StyleBox["j", "TI"]}]], 
         RowBox[{"(", "0", ")"}], "\[LongEqual]", 
         FractionBox["2", "3"], 
         SubscriptBox[
          StyleBox["R", "TI"], 
          RowBox[{
            StyleBox["i", "TI"], 
            StyleBox["p", "TI"], 
            StyleBox["j", "TI"], 
            StyleBox["p", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\partial _{pp} a^{ij}(0) = \\frac{2}{3} R_{ipjp}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ca0ed2ec-23ff-49ac-a152-89ef9f9c2839"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          RowBox[{
            SuperscriptBox["\[PartialD]", "2"], 
            SubscriptBox[
             StyleBox["G", "TI"], "1"]}], 
          RowBox[{"\[PartialD]", 
            SuperscriptBox[
             StyleBox["x", "TI"], 
             StyleBox["i", "TI"]], "\[PartialD]", 
            SuperscriptBox[
             StyleBox["x", "TI"], 
             StyleBox["j", "TI"]]}]], 
         RowBox[{"(", 
           RowBox[{"0", ",", "0"}], ")"}], "\[LongEqual]", 
         FractionBox["1", "6"], 
         SubscriptBox[
          StyleBox["R", "TI"], 
          RowBox[{
            StyleBox["p", "TI"], 
            StyleBox["i", "TI"], 
            StyleBox["p", "TI"], 
            StyleBox["i", "TI"], 
            StyleBox["j", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\frac{\\partial^2 G_1}{\\partial x^i \\partial x^j}(0,0) = \
\\frac{1}{6} R_{pipij}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "22fce74b-1284-476f-9416-d98d9d7ff342"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"where", " "}], TraditionalForm]],ExpressionUUID->
  "f294960a-eb7a-4fa4-8b24-6734fa649394"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["R", "TI"], TraditionalForm], "errors" -> {}, "input" -> "R", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2a2bd91a-5640-4fb9-83fb-ce6735c1b18f"],
 " is the curvature tensor."
}], "Text",
 CellChangeTimes->{{3.922428055996557*^9, 3.922428123947956*^9}, {
  3.9224281697960587`*^9, 3.922428310516987*^9}, {3.922428346485724*^9, 
  3.922428450170807*^9}, {3.922428483044095*^9, 3.922428493693597*^9}, {
  3.922428533034689*^9, 
  3.922428597617185*^9}},ExpressionUUID->"aa2ec057-a4c6-4d4c-b072-\
c08851ed61f2"],

Cell[TextData[{
 "The two basic expansions are\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          SubsuperscriptBox[
           StyleBox["X", "TI"], 
           RowBox[{
             StyleBox["t", "TI"], 
             StyleBox["r", "TI"]}], 
           StyleBox["i", "TI"]], 
          RowBox[{"1", "-", 
            StyleBox["r", "TI"]}]], "\[LongEqual]", 
         StyleBox["t", "TI"], 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{
            StyleBox["t", "TI"], 
            StyleBox["r", "TI"]}]], 
         FractionBox["1", 
          RowBox[{
            StyleBox["t", "TI"], "-", 
            StyleBox["u", "TI"]}]], 
         SubsuperscriptBox[
          RowBox[{"(", 
            RowBox[{"\[Sigma]", 
              StyleBox["d", "TI"], 
              StyleBox["B", "TI"]}], ")"}], 
          StyleBox["u", "TI"], 
          StyleBox["i", "TI"]], "+", 
         StyleBox["t", "TI"], 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["r", "TI"]], 
         FractionBox["1", 
          RowBox[{"1", "-", "\[Eta]"}]], 
         OverscriptBox[
          StyleBox["b", "TI"], "_"], 
         RowBox[{"(", 
           SubscriptBox[
            StyleBox["X", "TI"], 
            RowBox[{
              StyleBox["t", "TI"], "\[Eta]"}]], ")"}], 
         StyleBox["d", "TI"], "\[Eta]", "+", 
         StyleBox["O", "TI"], 
         RowBox[{"(", 
           SuperscriptBox[
            StyleBox["t", "TI"], "2"], ")"}], "\[Tilde]", 
         SuperscriptBox[
          StyleBox["t", "TI"], "0.5"], "+", 
         SuperscriptBox[
          StyleBox["t", "TI"], "1.5"], "+", 
         StyleBox["O", "TI"], 
         RowBox[{"(", 
           SuperscriptBox[
            StyleBox["t", "TI"], "2"], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\frac{X^i_{tr}}{1-r} = t  \\int_0^{tr} \\frac{1}{t-u} (\\sigma dB)^i_u \
+ t \\int_0^r \\frac{1}{1-\\eta} \\bar{b}(X_{t\\eta})d\\eta + O(t^2) \\sim \
t^{0.5} + t^{1.5} + O(t^2)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c2675073-ac95-4994-baad-825252340b67"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         OverscriptBox[
          StyleBox["b", "TI"], "_"], 
         RowBox[{"(", 
           StyleBox["x", "TI"], ")"}], "\[LongEqual]", 
         StyleBox["b", "TI"], 
         RowBox[{"(", 
           StyleBox["x", "TI"], ")"}], "+", "\[Del]", 
         SubscriptBox[
          StyleBox["G", "TI"], "1"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["x", "TI"], ",", "0"}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\bar{b}(x) = b(x) + \\nabla G_1(x,0)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "76990e95-e374-456f-93dd-16e9e6c7893e"],
 ",\nand\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["f", "TI"], 
         RowBox[{"(", 
           SubscriptBox[
            StyleBox["X", "TI"], 
            RowBox[{
              StyleBox["t", "TI"], 
              StyleBox["r", "TI"]}]], ")"}], "\[LongEqual]", 
         StyleBox["f", "TI"], 
         RowBox[{"(", "0", ")"}], "+", 
         SubscriptBox["\[PartialD]", 
          StyleBox["p", "TI"]], 
         StyleBox["f", "TI"], 
         RowBox[{"(", "0", ")"}], 
         SubsuperscriptBox["\[CapitalDelta]", 
          RowBox[{
            StyleBox["t", "TI"], 
            StyleBox["r", "TI"]}], 
          StyleBox["p", "TI"]], "+", 
         FractionBox["1", "2"], 
         SubsuperscriptBox["\[PartialD]", 
          RowBox[{
            StyleBox["p", "TI"], 
            StyleBox["q", "TI"]}], "2"], 
         StyleBox["f", "TI"], 
         RowBox[{"(", "0", ")"}], 
         SubsuperscriptBox["\[CapitalDelta]", 
          RowBox[{
            StyleBox["t", "TI"], 
            StyleBox["r", "TI"]}], 
          StyleBox["p", "TI"]], 
         SubsuperscriptBox["\[CapitalDelta]", 
          RowBox[{
            StyleBox["t", "TI"], 
            StyleBox["r", "TI"]}], 
          StyleBox["q", "TI"]], "+", 
         StyleBox["O", "TI"], 
         RowBox[{"(", 
           SuperscriptBox[
            StyleBox["t", "TI"], "1.5"], ")"}], "\[Tilde]", 
         SuperscriptBox[
          StyleBox["t", "TI"], "0"], "+", 
         SuperscriptBox[
          StyleBox["t", "TI"], "0.5"], "+", 
         SuperscriptBox[
          StyleBox["t", "TI"], "1"], "+", 
         SuperscriptBox[
          StyleBox["t", "TI"], "1.5"]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "f(X_{tr}) = f(0) + \\partial_p f(0) \\Delta^p_{tr} + \\frac{1}{2} \
\\partial^2_{pq}f(0) \\Delta^p_{tr} \\Delta^q_{tr} + O(t^{1.5}) \\sim t^0 + \
t^{0.5} + t^{1} + t^{1.5}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b6456de4-14ac-4448-acca-91594a018b5e"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["f", "TI"], ":", 
         SuperscriptBox[
          StyleBox["R", FontSlant -> "Plain"], 
          StyleBox["d", "TI"]], "\[Rule]", 
         StyleBox["E", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "f: \\mathbb{R}^d \\to E", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "bd6a534a-ac15-4fe0-a43a-1f981932f481"],
 " is smooth and \n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox["\[CapitalDelta]", 
          RowBox[{
            StyleBox["t", "TI"], 
            StyleBox["r", "TI"]}], 
          StyleBox["i", "TI"]], "\[LongEqual]", 
         SubscriptBox[
          StyleBox["X", "TI"], 
          RowBox[{
            StyleBox["t", "TI"], 
            StyleBox["r", "TI"]}]], "\[LongEqual]", 
         RowBox[{"(", 
           RowBox[{"1", "-", 
             StyleBox["r", "TI"]}], ")"}], 
         FractionBox[
          SubscriptBox[
           StyleBox["X", "TI"], 
           RowBox[{
             StyleBox["t", "TI"], 
             StyleBox["r", "TI"]}]], 
          RowBox[{"1", "-", 
            StyleBox["r", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\Delta^i_{tr} = X_{tr} = (1-r) \\frac{X_{tr}}{1-r}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9bd178eb-80c1-4743-92b6-40b92cdb8011"],
 "."
}], "Text",
 CellChangeTimes->{{3.922428600243929*^9, 3.922428613992442*^9}, {
   3.92242880234972*^9, 3.922428825470261*^9}, {3.92242890452287*^9, 
   3.922428930281358*^9}, {3.922428978432798*^9, 3.922429006619348*^9}, 
   3.922429161981029*^9, {3.9224293875137*^9, 3.922429388532871*^9}, {
   3.929455766664781*^9, 
   3.929455768791135*^9}},ExpressionUUID->"826606b0-33f8-477c-ad89-\
ea58b52a530b"],

Cell[TextData[{
 "Therefore, we have the small time expansion orders as\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["I", "TI"], 
          StyleBox["u", "TI"]], "\[Tilde]", 
         SuperscriptBox[
          StyleBox["t", "TI"], "0.5"], "+", 
         SuperscriptBox[
          StyleBox["t", "TI"], "1"], "+", 
         StyleBox["O", "TI"], 
         RowBox[{"(", 
           SuperscriptBox[
            StyleBox["t", "TI"], "1.5"], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "I_u \\sim t^{0.5} + t^1 + O(t^{1.5})", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ecc0f8e8-8fef-4903-bdd2-16075507beb8"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["J", "TI"], 
          StyleBox["u", "TI"]], "\[Tilde]", 
         SuperscriptBox[
          StyleBox["t", "TI"], "1"], "+", 
         StyleBox["O", "TI"], 
         RowBox[{"(", 
           SuperscriptBox[
            StyleBox["t", "TI"], "1.5"], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "J_u \\sim t^1 + O(t^{1.5})", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3caedbc2-1e9a-484e-a5d2-215bf2f56eff"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["K", "TI"], 
          StyleBox["u", "TI"]], "\[Tilde]", 
         SuperscriptBox[
          StyleBox["t", "TI"], "0.5"], "+", 
         SuperscriptBox[
          StyleBox["t", "TI"], "1"], "+", 
         StyleBox["O", "TI"], 
         RowBox[{"(", 
           SuperscriptBox[
            StyleBox["t", "TI"], "1.5"], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "K_u \\sim t^{0.5} + t^1 + O(t^{1.5})", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "cca4f35d-9e93-4174-b445-cd5b01db795a"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["L", "TI"], 
          StyleBox["u", "TI"]], "\[LongEqual]", 
         SuperscriptBox[
          StyleBox["t", "TI"], "1"], "+", 
         StyleBox["O", "TI"], 
         RowBox[{"(", 
           SuperscriptBox[
            StyleBox["t", "TI"], "1.5"], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "L_u = t^1 + O(t^{1.5})", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "63955d92-0a9e-4225-afed-7aec7328774d"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["P", "TI"], 
          StyleBox["u", "TI"]], "\[Tilde]", 
         SuperscriptBox[
          StyleBox["t", "TI"], "1"], "+", 
         StyleBox["O", "TI"], 
         RowBox[{"(", 
           SuperscriptBox[
            StyleBox["t", "TI"], "1.5"], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "P_u \\sim  t^1 + O(t^{1.5})", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "73064617-4558-4036-8819-ea55409e836e"],
 "."
}], "Text",
 CellChangeTimes->{{3.922429390690444*^9, 3.92242944662976*^9}, {
   3.922429479123665*^9, 3.922429481321397*^9}, 3.922429723017912*^9, 
   3.922429792970363*^9, 3.92242982773776*^9, {3.922429865728442*^9, 
   3.92242986795046*^9}, {3.922430036797376*^9, 
   3.92243006021859*^9}},ExpressionUUID->"9cff77cb-bd89-4f63-8e47-\
c30339f8a685"],

Cell[TextData[{
 "So the total order 2 cases means that we pick combination of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["I", "TI"], 
          StyleBox["u", "TI"]], ",", 
         SubscriptBox[
          StyleBox["J", "TI"], 
          StyleBox["u", "TI"]], ",", 
         SubscriptBox[
          StyleBox["K", "TI"], 
          StyleBox["u", "TI"]], ",", 
         SubscriptBox[
          StyleBox["L", "TI"], 
          StyleBox["u", "TI"]], ",", 
         SubscriptBox[
          StyleBox["P", "TI"], 
          StyleBox["u", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "I_u,J_u, K_u, L_u, P_u", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "19e3ec73-ab06-40d0-80dd-04d8bc8320c2"],
 " such that the least order in their expansion adds up to 2, and then we \
find the coefficients of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["t", "TI"], "3"], TraditionalForm], "errors" -> {}, "input" -> 
     "t^3", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "fc401328-9315-43ea-9210-b3353ea2f5d7"],
 " in each of these cases.  For example, we can pick ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I_u, I_u; I_u, I_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a8ce5bcd-1b3a-4276-8356-ce4a4a8ecd69"],
 " as a case so that the term we are interested in is\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              StyleBox["t", "TI"]], 
             SubsuperscriptBox["\[Integral]", "0", 
              StyleBox["v", "TI"]], 
             SubscriptBox[
              StyleBox["I", "TI"], 
              StyleBox["u", "TI"]], "\[CircleTimes]", 
             SubscriptBox[
              StyleBox["I", "TI"], 
              StyleBox["v", "TI"]], "\[CircleTimes]", 
             SubsuperscriptBox["\[Integral]", "0", 
              StyleBox["t", "TI"]], 
             SubsuperscriptBox["\[Integral]", "0", 
              StyleBox["v", "TI"]], 
             SubscriptBox[
              StyleBox["I", "TI"], 
              StyleBox["u", "TI"]], "\[CircleTimes]", 
             SubscriptBox[
              StyleBox["I", "TI"], 
              StyleBox["v", "TI"]]}], "]"}], "\[LongEqual]", 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              StyleBox["t", "TI"]], 
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  StyleBox["v", "TI"]], 
                 SubscriptBox["\[Phi]", 
                  StyleBox["i", "TI"]], 
                 RowBox[{"(", 
                   SubscriptBox[
                    StyleBox["W", "TI"], 
                    StyleBox["u", "TI"]], ")"}], 
                 FractionBox[
                  SubsuperscriptBox[
                   StyleBox["W", "TI"], 
                   StyleBox["u", "TI"], 
                   StyleBox["i", "TI"]], 
                  RowBox[{
                    StyleBox["t", "TI"], "-", 
                    StyleBox["u", "TI"]}]], 
                 StyleBox["d", "TI"], 
                 StyleBox["u", "TI"]}], ")"}], "\[CircleTimes]", 
             SubscriptBox["\[Phi]", 
              StyleBox["j", "TI"]], 
             RowBox[{"(", 
               SubscriptBox[
                StyleBox["W", "TI"], 
                StyleBox["v", "TI"]], ")"}], 
             FractionBox[
              SubsuperscriptBox[
               StyleBox["W", "TI"], 
               StyleBox["v", "TI"], 
               StyleBox["j", "TI"]], 
              RowBox[{
                StyleBox["t", "TI"], "-", 
                StyleBox["v", "TI"]}]], 
             StyleBox["d", "TI"], 
             StyleBox["v", "TI"], "\[CircleTimes]", 
             SubsuperscriptBox["\[Integral]", "0", 
              StyleBox["t", "TI"]], 
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  StyleBox["v", "TI"]], 
                 SubscriptBox["\[Phi]", 
                  StyleBox["k", "TI"]], 
                 RowBox[{"(", 
                   SubscriptBox[
                    StyleBox["W", "TI"], 
                    StyleBox["u", "TI"]], ")"}], 
                 FractionBox[
                  SubsuperscriptBox[
                   StyleBox["W", "TI"], 
                   StyleBox["u", "TI"], 
                   StyleBox["k", "TI"]], 
                  RowBox[{
                    StyleBox["t", "TI"], "-", 
                    StyleBox["u", "TI"]}]], 
                 StyleBox["d", "TI"], 
                 StyleBox["u", "TI"]}], ")"}], "\[CircleTimes]", 
             SubscriptBox["\[Phi]", 
              StyleBox["l", "TI"]], 
             RowBox[{"(", 
               SubscriptBox[
                StyleBox["W", "TI"], 
                StyleBox["v", "TI"]], ")"}], 
             FractionBox[
              SubsuperscriptBox[
               StyleBox["W", "TI"], 
               StyleBox["v", "TI"], 
               StyleBox["l", "TI"]], 
              RowBox[{
                StyleBox["t", "TI"], "-", 
                StyleBox["v", "TI"]}]], 
             StyleBox["d", "TI"], 
             StyleBox["v", "TI"]}], "]"}]}], TraditionalForm], "errors" -> {},
      "input" -> 
     "\\mathbb{E}[\\int_0^t \\int_0^v I_u \\otimes I_v \\otimes \\int_0^t \
\\int_0^v I_u \\otimes I_v] = \
\\mathbb{E}\\left[\\int_{0}^{t}\\left(\\int_{0}^{v}\\phi_{i}(W_{u})\\frac{W_{\
u}^{i}}{t-u}du\\right)\\otimes\\phi_{j}\\left(W_{v}\\right)\\frac{W_{v}^{j}}{\
t-v}dv\\otimes\\int_{0}^{t}\\left(\\int_{0}^{v}\\phi_{k}(W_{u})\\frac{W_{u}^{\
k}}{t-u}du\\right)\\otimes\\phi_{l}(W_{v})\\frac{W_{v}^{l}}{t-v}dv\\right]", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a266b074-f31a-4a7c-8d2e-5380d299d816"],
 ". \nThis term has an expansion with the least order term ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "1"], 
         SuperscriptBox[
          StyleBox["t", "TI"], "2"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "C_1 t^2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "923727b8-260d-48f3-afdb-f5b39562d821"],
 ". So we need to pick one of the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["I", "TI"], 
        StyleBox["u", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "I_u", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5f9fc814-9a0b-40a5-bc0b-c955308ea2ca"],
 " (or a pair of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["I", "TI"], 
        StyleBox["u", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "I_u", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b824f085-f412-4dd7-9cfb-ede74a2c3f24"],
 ") in the tensor product to make further expansion, to make up the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["t", "TI"], "1"], TraditionalForm], "errors" -> {}, "input" -> 
     "t^{1}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "db6d6c75-7551-4b37-af59-6eafea06ab0f"],
 " gap to our goal, i.e. the coefficient of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["t", "TI"], "3"], TraditionalForm], "errors" -> {}, "input" -> 
     "t^3", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f5797d7f-2e12-466c-b08a-d70085fcd371"],
 ".  \nFor instance, we can pick the  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Phi]", 
        StyleBox["i", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_i", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c1b55e85-3f33-47be-a409-0f9e8393ed60"],
 " in the first ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[<|"boxes" -> FormBox[
        SubscriptBox[
         StyleBox["I", "TI"], 
         StyleBox["u", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
      "I_u", "state" -> "Boxes"|>,
     "TeXAssistantTemplate"], " "}], TraditionalForm]],ExpressionUUID->
  "acd04c02-4502-45df-8d78-4c6a03eb0a9f"],
 "and expand it to order ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["t", "TI"], "1"], TraditionalForm], "errors" -> {}, "input" -> 
     "t^1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "60ef2b54-18e6-4497-850f-94d36d8cc05e"],
 " while we let no extra expansion in the other ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["I", "TI"], 
        StyleBox["u", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "I_u", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b7731e72-bddf-424a-acea-05facdc53e79"],
 ", so that we have a term with ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox[
          StyleBox["t", "TI"], "1.5"], "\[CircleTimes]", 
         SuperscriptBox[
          StyleBox["t", "TI"], "0.5"], "\[CircleTimes]", 
         SuperscriptBox[
          StyleBox["t", "TI"], "0.5"], "\[CircleTimes]", 
         SuperscriptBox[
          StyleBox["t", "TI"], "0.5"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "t^{1.5} \\otimes t^{0.5} \\otimes t^{0.5} \\otimes t^{0.5}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8159b92b-e985-4e25-b561-8b3cece20662"],
 ", which shall give us a coefficient of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["t", "TI"], "3"], TraditionalForm], "errors" -> {}, "input" -> 
     "t^3", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b1e65715-e0e9-4b39-99a0-520a4660ebe2"],
 ".\nNotice that according to this idea, we ",
 StyleBox["cannot ",
  FontWeight->"Bold"],
 "pick ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["J", "TI"], 
        StyleBox["u", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "J_u", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ec4f8cf6-2b62-4c44-9f86-bd978eedcd0d"],
 " or ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["L", "TI"], 
        StyleBox["u", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "L_u", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "71fefee3-dfe8-4948-8511-d7ef264561ca"],
 ", since if we pick them, the least total order must be greater than 2, \
which will not be in this total order 2 case."
}], "Text",
 CellChangeTimes->{{3.922430063502011*^9, 3.922430167846153*^9}, {
  3.922430276769793*^9, 3.922430279506964*^9}, {3.922430421671178*^9, 
  3.922430458796761*^9}, {3.922430540476205*^9, 3.922430669818453*^9}, {
  3.92243096393785*^9, 3.9224311814395638`*^9}, {3.922431777977825*^9, 
  3.922432014976274*^9}, {3.929455857810068*^9, 
  3.929455859384001*^9}},ExpressionUUID->"f1dd0c08-c7fa-4dc6-b04e-\
db6a2b64a40f"],

Cell[TextData[{
 "Therefore, there are 25 cases, which are\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I_u, I_u; I_u, I_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4d79239d-fbd1-45f4-b59e-b2105c28245a"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I_u, I_u; I_u, K_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7fa17682-2a9d-48b7-b20b-c2e30a3f7d6c"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I_u, I_u; K_u, I_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b7eb7696-f543-4f41-b9a4-a06e22150dd3"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I_u, I_u; K_u, K_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2603935b-2ffa-4bd9-86da-b0a8267983a7"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I_u,K_u; I_u, K_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "33d4ca1c-ef79-486d-8087-769a852dcdfe"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I_u, K_u; K_u, I_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "af160205-4c4a-4a75-8a34-49c0c8029fca"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I_u, K_u; K_u, K_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d9adbb1b-d5e1-4a74-a171-f33be4507c06"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(K_u, I_u; K_u, I_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4429221e-3f62-4f24-94b0-5e40d16f9d2b"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(K_u, I_u; K_u, K_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "97bb71c3-2858-43bd-a974-30adc842c9d1"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(K_u, K_u; K_u, K_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1c8524e2-6539-47c6-a27d-36876061cbe9"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["P", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I_u, I_u; P_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8f789002-abde-45c1-aa33-890567165dc8"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["P", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I_u, K_u; P_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "895df43f-55fd-4e37-8995-0320367e45ec"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["P", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(K_u, I_u; P_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2d619739-4518-45e1-ae49-4e27756ae832"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["P", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(K_u, K_u; P_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9f604fce-8553-4524-8178-eaab27c71db0"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["P", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["P", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(P_u; P_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "55b2d11f-804c-48bd-a050-e499ecb98586"],
 "\nand their associated symmetric cases respectively,\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I_u, K_u; I_u, I_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5d6c2929-8a9c-4da1-9f19-bcdf1af68b60"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(K_u, I_u; I_u, I_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "28d8c19b-b8ff-4c4d-8379-d7083672d682"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(K_u, K_u; I_u, I_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8cee7fc2-b5a6-46dc-93e9-2d4b6189867f"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(K_u, I_u; I_u, K_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "26296f1e-3129-4e4d-8fb7-c670c77f4c76"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(K_u, K_u; I_u, K_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e0fb28e0-27d7-4cb1-b490-3a1f7f20a87c"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(K_u, K_u; K_u, I_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d41cf4a1-e102-42d6-b7db-52707c6714b4"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["P", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(P_u; I_u, I_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1f3eab11-2b97-4817-a273-e1c42e4e3a9e"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["P", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(P_u; I_u, K_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "51dd42ca-172b-4275-98be-3870afca939c"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["P", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(P_u; K_u, I_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0b84e7ca-d1d6-411e-be49-489d5019aed8"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox[
            StyleBox["P", "TI"], 
            StyleBox["u", "TI"]], ";", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]], ",", 
           SubscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(P_u; K_u, K_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d0a63421-5a74-4b30-8b71-74e5b90355cc"]
}], "Text",
 CellChangeTimes->{{3.922430190742217*^9, 3.922430257911817*^9}, {
  3.92243120175211*^9, 3.922431229983059*^9}, {3.922431354375811*^9, 
  3.922431371077966*^9}, {3.922431493572237*^9, 3.922431510268762*^9}, {
  3.922431553252627*^9, 3.922431611852192*^9}, {3.922431710953915*^9, 
  3.922431711126347*^9}, {3.929456055956608*^9, 
  3.9294560639224*^9}},ExpressionUUID->"d88f598b-4962-46ac-a21a-111743bca040"],

Cell[TextData[{
 "In all these cases, it turns out that after expansion, we will end up with \
calculating expectation of products of stochastic integrals. \nDenote ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox[
          StyleBox["X", "TI"], 
          RowBox[{"0", ",", 
            SubscriptBox[
             StyleBox["a", "TI"], 
             StyleBox["i", "TI"]]}], 
          StyleBox["i", "TI"]], ":", "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", "0", 
          SubscriptBox[
           StyleBox["a", "TI"], 
           StyleBox["i", "TI"]]], 
         SuperscriptBox[
          StyleBox["C", "TI"], 
          StyleBox["i", "TI"]], 
         SubsuperscriptBox[
          RowBox[{"(", 
            RowBox[{"\[Sigma]", 
              StyleBox["d", "TI"], 
              StyleBox["B", "TI"]}], ")"}], 
          StyleBox["u", "TI"], 
          StyleBox["i", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "X^i_{0,a_i} := \\int_0^{a_i} C^i (\\sigma dB)^i_u", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "75ef1aed-dd60-49c7-bef5-1dc0fa2381b0"],
 ", where ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], 
          StyleBox["i", "TI"]], "\[Element]", 
         RowBox[{"{", 
           RowBox[{"1", ",", 
             FractionBox["1", 
              RowBox[{
                StyleBox["t", "TI"], "-", 
                StyleBox["u", "TI"]}]]}], "}"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "C_i \\in \\{1, \\frac{1}{t-u}\\}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "02d738ea-fc54-4bdd-832a-379bd0212ecd"],
 ".\nThen more specifically, we need to deal with the following six kinds of \
fundamental cases, or building blocks, of products of stochastic integrals:\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "1"]}], "1"], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "2"]}], "2"]}], "]"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\mathbb{E}[X^1_{0,a_1} X^2_{0,a_2}]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "98b15a05-01da-4979-b2f3-be6d9ddee350"],
 ", \nwhich we shall call the ",
 StyleBox["two-product case",
  FontWeight->"Bold"],
 ". \n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "1"]}], "1"], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "3"]}], "2"], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "3"]}], "3"], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "4"]}], "4"]}], "]"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\mathbb{E}[X^1_{0,a_1} X^2_{0,a_3} X^3_{0,a_3} X^4_{0,a_4}]", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "50b811c5-e044-4841-99db-c9a2f0add0b0"],
 ", \nwhich we shall call the ",
 StyleBox["four-product case",
  FontWeight->"Bold"],
 ". \n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "1"]}], "1"], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "3"]}], "2"], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "3"]}], "3"], 
             RowBox[{"(", 
               SuperscriptBox["\[CapitalXi]", "4"], ")"}]}], "]"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\mathbb{E}[X^1_{0,a_1} X^2_{0,a_3} X^3_{0,a_3}(\\Xi^4)]", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8191b1d1-c105-4da9-b876-fcfbde277cba"],
 ", \nwhere ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox[
          StyleBox["X", "TI"], 
          RowBox[{"0", ",", 
            SubscriptBox[
             StyleBox["a", "TI"], "3"]}], "3"], "(", 
         SuperscriptBox["\[CapitalXi]", "4"], ")"}], TraditionalForm], 
     "errors" -> {}, "input" -> "X^3_{0,a_3}(\\Xi^4)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c7337d8a-bf70-43e5-af99-cc7ed35cc240"],
 " means a stochastic integral whose integrand is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox["\[CapitalXi]", "4"], TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi^4", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "88f9acac-764c-4a6a-b9d8-d9c6e6a1d441"],
 ", which is another expandable stochastic integral (or Lebesgue of \
stochastic integral). We shall call this ",
 StyleBox["improved three-product case",
  FontWeight->"Bold"],
 ".\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "1"]}], "1"], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "3"]}], "2"], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "3"]}], "3"], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "4"]}], "4"], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "5"]}], "5"], 
             RowBox[{"(", 
               SuperscriptBox["\[CapitalXi]", "6"], ")"}]}], "]"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\mathbb{E}[X^1_{0,a_1} X^2_{0,a_3} X^3_{0,a_3} X^4_{0,a_4} \
X^5_{0,a_5}(\\Xi^6)]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b40abe67-8ebb-474d-a3ca-a0139ce35b51"],
 ", \nwhich we shall call the ",
 StyleBox["improved five-product case",
  FontWeight->"Bold"],
 ".\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "1"]}], "1"], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "3"]}], "2"], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "3"]}], "3"], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "4"]}], "4"], 
             RowBox[{"(", 
               RowBox[{
                 SuperscriptBox["\[CapitalXi]", "5"], 
                 SuperscriptBox["\[CapitalXi]", "6"]}], ")"}]}], "]"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\mathbb{E}[X^1_{0,a_1} X^2_{0,a_3} X^3_{0,a_3} X^4_{0,a_4}(\\Xi^5 \
\\Xi^6)]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2dd62e21-f37f-4aae-8445-450d6c7527b3"],
 ", \nwhich we shall call the ",
 StyleBox["four-product with two expansion case",
  FontWeight->"Bold"],
 ".\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "1"]}], "1"], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "3"]}], "2"], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "3"]}], "3"], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "4"]}], "4"], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "5"]}], "5"], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"0", ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "6"]}], "6"]}], "]"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\mathbb{E}[X^1_{0,a_1} X^2_{0,a_3} X^3_{0,a_3} X^4_{0,a_4} X^5_{0,a_5} \
X^6_{0,a_6}]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e065ca31-6111-421c-8e4c-334a1ba75172"],
 ", \nwhich we shall call the ",
 StyleBox["six-product case",
  FontWeight->"Bold"],
 "."
}], "Text",
 CellChangeTimes->{{3.922432073847001*^9, 3.9224321630222178`*^9}, {
  3.92243221888488*^9, 3.922432219175754*^9}, {3.922432251062428*^9, 
  3.922432251592559*^9}, {3.922432298188698*^9, 3.922432299623524*^9}, {
  3.92243235030468*^9, 3.922432389138873*^9}, {3.92243246922501*^9, 
  3.922432492438038*^9}, {3.922432547652923*^9, 3.9224327710723352`*^9}, {
  3.922432815671048*^9, 3.922432911635042*^9}, {3.929456253532209*^9, 
  3.9294563529157343`*^9}, {3.929456395400835*^9, 
  3.9294564173900213`*^9}},ExpressionUUID->"a47c6f90-a60c-4a97-b005-\
4658a7351725"],

Cell["\<\
Full details of the calculation and the implementation idea will be explained \
in the associated sections below.
\
\>", "Text",
 CellChangeTimes->{{3.922433052042177*^9, 3.9224331260170317`*^9}, 
   3.922433246887938*^9},ExpressionUUID->"326b2e98-b275-40e0-b0ec-\
fbbe58930110"],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s now give indices ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["i", "TI"], ",", 
         StyleBox["j", "TI"], ",", 
         StyleBox["k", "TI"], ",", 
         StyleBox["l", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "{i,j,k,l}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f7284c56-2c65-4377-b036-230ddf1cf0a3"],
 " to the four terms in the tensor product in ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["E", "TI"], 
        RowBox[{"\[CircleTimes]", "4"}]], TraditionalForm], "errors" -> {}, 
     "input" -> "E^{\\otimes 4}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a7214e4e-10d7-44c5-acc8-7262767bf8d3"],
 ". As we have mentioned, we need to pick a term ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["I", "TI"], 
          StyleBox["u", "TI"]], ",", 
         SubscriptBox[
          StyleBox["K", "TI"], 
          StyleBox["u", "TI"]], ",", 
         SubscriptBox[
          StyleBox["P", "TI"], 
          StyleBox["u", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "I_u, K_u, P_u", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9aec38f0-78c4-42db-8cf7-4b36e6c56abf"],
 " (or a pair of them) to make a further expansion to make up the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["t", "TI"], "1"], TraditionalForm], "errors" -> {}, "input" -> 
     "t^1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4b7fe02b-1deb-4eaf-9fa6-fa767191d970"],
 " gap.\nIt turns out that there are 12 such ways of picking. They are\n1. \
Expand one of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], ",", 
         SubscriptBox["\[Phi]", 
          StyleBox["j", "TI"]], ",", 
         SubscriptBox["\[Phi]", 
          StyleBox["k", "TI"]], ",", 
         SubscriptBox["\[Phi]", 
          StyleBox["l", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_i, \\phi_j, \\phi_k, \\phi_l", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ee0fa93f-6662-4a5d-b3dd-52ab8e55b452"],
 " to order ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["t", "TI"], "1"], TraditionalForm], "errors" -> {}, "input" -> 
     "t^1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6b620c33-0ebc-4aba-8908-114b07c7a704"],
 ".\n\t(i). expand ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Phi]", 
        StyleBox["i", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_i", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5fe4a0ae-147e-47df-acce-063cc9610cd6"],
 " to order 1.\n\t(ii). expand ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Phi]", 
        StyleBox["j", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_j", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "04c2dfdb-77a8-460e-a81b-ac12efc27f05"],
 " to order 1.\n\t(iii). expand ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Phi]", 
        StyleBox["k", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_k", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9d1af039-0f9f-4994-9d83-0a88e5931406"],
 " to order 1.\n\t(iv). expand ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Phi]", 
        StyleBox["l", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_l", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "15a27f20-91dc-4835-8841-7ec239acd92b"],
 " to order 1.\n2. Expand a pair of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], ",", 
         SubscriptBox["\[Phi]", 
          StyleBox["j", "TI"]], ",", 
         SubscriptBox["\[Phi]", 
          StyleBox["k", "TI"]], ",", 
         SubscriptBox["\[Phi]", 
          StyleBox["l", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_i, \\phi_j, \\phi_k, \\phi_l", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d49b16a8-4eef-4cdc-a5e1-29ede7502801"],
 " and expand each to order ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["t", "TI"], "0.5"], TraditionalForm], "errors" -> {}, 
     "input" -> "t^{0.5}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9102a822-1981-46c7-a586-a3872eff8e65"],
 ".\n\t(i). expand both ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Phi]", 
        StyleBox["i", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_i", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "43eda258-fadb-43eb-aa77-9f352f3b48cf"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Phi]", 
        StyleBox["j", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_j", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d28ecab9-7f1b-4175-aa5f-6629430c2124"],
 " to order 0.5.\n\t(ii). expand both ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Phi]", 
        StyleBox["i", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_i", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "82479ae2-11d6-473f-b039-39c2e3d75cf8"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Phi]", 
        StyleBox["k", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_k", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c2b0ce64-99f4-4b48-9d44-7c1348ff45d8"],
 " to order 0.5.\n\t(iii). expand both ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Phi]", 
        StyleBox["i", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_i", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c597e888-59d9-4c02-a351-f411686a35a5"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Phi]", 
        StyleBox["l", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_l", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "60858621-1c53-4e10-8d24-9303495d132c"],
 " to order 0.5.\n\t(iv). expand both ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Phi]", 
        StyleBox["j", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_j", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c21e63fa-57a8-449a-9b3e-f115bb0b1aa1"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Phi]", 
        StyleBox["k", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_k", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5ba7ef83-fba9-40b5-8a1f-41ae21db7707"],
 " to order 0.5.\n\t(v). expand both ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Phi]", 
        StyleBox["j", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_j", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f4d0745c-366e-4b62-9e8c-33c22f313dba"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Phi]", 
        StyleBox["l", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_l", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8c850458-4ced-49cc-9590-f48a1aae0639"],
 " to order 0.5.\n\t(vi). expand both ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Phi]", 
        StyleBox["k", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_k", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "948c7fe7-ee40-45f2-8db6-e1f0064446e6"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Phi]", 
        StyleBox["l", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_l", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ec481979-b921-49ee-a4cb-3c911fdc8766"],
 " to order 0.5.\n3. expand ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox[
        SubsuperscriptBox[
         StyleBox["W", "TI"], 
         RowBox[{
           StyleBox["t", "TI"], 
           StyleBox["r", "TI"]}], 
         StyleBox["i", "TI"]], 
        RowBox[{"1", "-", 
          StyleBox["r", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\frac{W^i_{tr}}{1-r}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b72944bd-08a3-4f86-8ed6-4dc8da00070d"],
 " to order 1.5.\n4. expand ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["a", "TI"], "(", "\[CenterDot]", ")"}], TraditionalForm], 
     "errors" -> {}, "input" -> "a(\\cdot)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "627d71fc-877f-46e9-9666-12b06cb08996"],
 " to order 1.\nWe shall always follow this order to expand the terms in each \
case.\n"
}], "Text",
 CellChangeTimes->{{3.922433129350266*^9, 3.922433322759094*^9}, {
  3.922433355312393*^9, 3.922433558439933*^9}, {3.922433794597947*^9, 
  3.922433825386134*^9}, {3.922433856470156*^9, 3.922433860837869*^9}, {
  3.922433969375931*^9, 3.922433969949358*^9}, {3.922454821750886*^9, 
  3.922454836181835*^9}, {3.922454885205271*^9, 3.922455041146014*^9}, {
  3.929456463545347*^9, 3.929456463774127*^9}, {3.929456505976478*^9, 
  3.9294565733710003`*^9}},ExpressionUUID->"2d61291d-ea5f-4318-adf1-\
50410028ee69"],

Cell[TextData[{
 "It is worth mentioning here in advance that these 12 different ways of \
expanding give us 12 different kinds of terms in the final result that can \
not be further combined. This will be straightforward to see after one goes \
through the calculation of a case. In particular, they are associated to \n\
term 1: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox["\[PartialD]", 
          RowBox[{
            StyleBox["p", "TI"], 
            StyleBox["q", "TI"]}], "2"], 
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["j", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["k", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["l", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\partial^2_{pq} \\phi_i \\otimes \\phi_j \\otimes \\phi_k \\otimes \
\\phi_l", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "636929b1-d283-4b18-bf94-022a0527719f"],
 "\nterm 2: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], "\[CircleTimes]", 
         SubsuperscriptBox["\[PartialD]", 
          RowBox[{
            StyleBox["p", "TI"], 
            StyleBox["q", "TI"]}], "2"], 
         SubscriptBox["\[Phi]", 
          StyleBox["j", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["k", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["l", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_i \\otimes \\partial^2_{pq}  \\phi_j \\otimes \\phi_k \\otimes \
\\phi_l", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f673b3ff-f622-4fca-b7fd-2ce96bac5b2d"],
 "\nterm 3: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["j", "TI"]], "\[CircleTimes]", 
         SubsuperscriptBox["\[PartialD]", 
          RowBox[{
            StyleBox["p", "TI"], 
            StyleBox["q", "TI"]}], "2"], 
         SubscriptBox["\[Phi]", 
          StyleBox["k", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["l", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_i \\otimes \\phi_j \\otimes \\partial^2_{pq} \\phi_k \\otimes \
\\phi_l", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e8a80da3-749c-45a3-9282-67acb48e940d"],
 "\nterm 4: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["j", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["k", "TI"]], "\[CircleTimes]", 
         SubsuperscriptBox["\[PartialD]", 
          RowBox[{
            StyleBox["p", "TI"], 
            StyleBox["q", "TI"]}], "2"], 
         SubscriptBox["\[Phi]", 
          StyleBox["l", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_i \\otimes \\phi_j \\otimes \\phi_k \\otimes \
\\partial^2_{pq}\\phi_l", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "dc2fd409-fa57-41ea-b07a-8b4b6263bcf3"],
 "\nterm 5: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[PartialD]", 
          StyleBox["p", "TI"]], 
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[PartialD]", 
          StyleBox["q", "TI"]], 
         SubscriptBox["\[Phi]", 
          StyleBox["j", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["k", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["l", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\partial_p \\phi_i \\otimes \\partial_q\\phi_j \\otimes \\phi_k \
\\otimes \\phi_l", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "461a12de-a431-4701-9d3f-873d0ed32980"],
 "\nterm 6: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[PartialD]", 
          StyleBox["p", "TI"]], 
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["j", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[PartialD]", 
          StyleBox["q", "TI"]], 
         SubscriptBox["\[Phi]", 
          StyleBox["k", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["l", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\partial_p \\phi_i \\otimes \\phi_j \\otimes \\partial_q \\phi_k \
\\otimes \\phi_l", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8b2f43be-186a-43ab-a34c-faacc464f8fe"],
 "\nterm 7: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[PartialD]", 
          StyleBox["p", "TI"]], 
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["j", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["k", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[PartialD]", 
          StyleBox["q", "TI"]], 
         SubscriptBox["\[Phi]", 
          StyleBox["l", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\partial_p \\phi_i \\otimes \\phi_j \\otimes \\phi_k \\otimes \
\\partial_q\\phi_l", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "84f0c795-86d2-4607-90eb-f775a2064999"],
 "\nterm 8: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[PartialD]", 
          StyleBox["p", "TI"]], 
         SubscriptBox["\[Phi]", 
          StyleBox["j", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[PartialD]", 
          StyleBox["q", "TI"]], 
         SubscriptBox["\[Phi]", 
          StyleBox["k", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["l", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_i \\otimes \\partial_p \\phi_j \\otimes \\partial_q \\phi_k \
\\otimes \\phi_l", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "31f17048-ad5d-4438-9256-58042590f0df"],
 "\nterm 9: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[PartialD]", 
          StyleBox["p", "TI"]], 
         SubscriptBox["\[Phi]", 
          StyleBox["j", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["k", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[PartialD]", 
          StyleBox["q", "TI"]], 
         SubscriptBox["\[Phi]", 
          StyleBox["l", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_i \\otimes \\partial_p \\phi_j \\otimes \\phi_k \\otimes \
\\partial_q\\phi_l", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "298a6400-9056-4a87-b0ce-63f6cc9d627b"],
 "\nterm 10: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["j", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[PartialD]", 
          StyleBox["p", "TI"]], 
         SubscriptBox["\[Phi]", 
          StyleBox["k", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[PartialD]", 
          StyleBox["q", "TI"]], 
         SubscriptBox["\[Phi]", 
          StyleBox["l", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_i \\otimes \\phi_j \\otimes \\partial_p \\phi_k \\otimes \
\\partial_q \\phi_l", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "624ab69e-907f-4bc3-a6e3-28ef506ec62f"],
 "\nterm 11: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[PartialD]", 
          StyleBox["p", "TI"]], 
         StyleBox["b", "TI"], 
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["j", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["k", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["l", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\partial_p b \\phi_i \\otimes \\phi_j \\otimes \\phi_k \\otimes \
\\phi_l", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5dc5a980-e662-4d18-9ad6-76cc8b976d8a"],
 "\nterm 12: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox["\[PartialD]", 
          RowBox[{
            StyleBox["p", "TI"], 
            StyleBox["q", "TI"]}], "2"], 
         StyleBox["a", "TI"], 
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["j", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["k", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["l", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\partial^2_{pq} a \\phi_i \\otimes \\phi_j \\otimes \\phi_k \\otimes \
\\phi_l", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5d701e4c-8b31-4001-86c2-f283a23800dd"],
 "\nwhere ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["p", "TI"], ",", 
         StyleBox["q", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "p,q", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6707874c-77ee-4e68-b072-26b5c47dde48"],
 " are indices of the partial derivatives.\n"
}], "Text",
 CellChangeTimes->{{3.9224338630917*^9, 3.922434228852899*^9}, {
  3.9224342748405647`*^9, 3.922434279985222*^9}, {3.9224343242361717`*^9, 
  3.92243433021944*^9}, {3.922434363477737*^9, 3.922434373267528*^9}, {
  3.922434410798449*^9, 3.922434412530175*^9}, {3.922434448749496*^9, 
  3.922434456151854*^9}, {3.922434497942335*^9, 3.922434499827761*^9}, {
  3.922435530831008*^9, 3.922435560335762*^9}, {3.9294567060170727`*^9, 
  3.929456731079074*^9}},ExpressionUUID->"be3e6ff6-b7e8-425a-b41e-\
516ec4c94e1a"],

Cell[TextData[{
 "Each of the terms here indicates a type of tensor product. Actually, the \
full expression of each term contains products of Kronecker deltas.  For \
instance, for term 1, the full expression can be written as\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox["\[PartialD]", 
          RowBox[{
            StyleBox["p", "TI"], 
            StyleBox["q", "TI"]}], "2"], 
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["j", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["k", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["l", "TI"]], 
         RowBox[{"(", 
           RowBox[{
             UnderscriptBox["\[Sum]", "\[Sigma]", LimitsPositioning -> True], 
             
             SubscriptBox[
              StyleBox["C", "TI"], "\[Sigma]"], 
             SubscriptBox["\[Delta]", 
              RowBox[{"\[Sigma]", 
                RowBox[{"(", 
                  StyleBox["i", "TI"], ")"}], "\[Sigma]", 
                RowBox[{"(", 
                  StyleBox["j", "TI"], ")"}]}]], 
             SubscriptBox["\[Delta]", 
              RowBox[{"\[Sigma]", 
                RowBox[{"(", 
                  StyleBox["k", "TI"], ")"}], "\[Sigma]", 
                RowBox[{"(", 
                  StyleBox["l", "TI"], ")"}]}]], 
             SubscriptBox["\[Delta]", 
              RowBox[{"\[Sigma]", 
                RowBox[{"(", 
                  StyleBox["p", "TI"], ")"}], "\[Sigma]", 
                RowBox[{"(", 
                  StyleBox["q", "TI"], ")"}]}]]}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\partial^2_{pq} \\phi_i \\otimes \\phi_j \\otimes \\phi_k \\otimes \
\\phi_l (\\sum_{\\sigma} C_{\\sigma} \\delta_{\\sigma(i)\\sigma(j)} \\delta_{\
\\sigma(k) \\sigma(l)} \\delta_{\\sigma(p) \\sigma(q)})", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "84fba86c-7d56-4496-9c7a-173d862c9335"],
 ", \nwhere ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Sigma]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\sigma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b9e223c8-c854-446f-83dd-0004573c4a26"],
 " is the permutation of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{
           StyleBox["i", "TI"], ",", 
           StyleBox["j", "TI"], ",", 
           StyleBox["k", "TI"], ",", 
           StyleBox["l", "TI"], ",", 
           StyleBox["p", "TI"], ",", 
           StyleBox["q", "TI"]}], "}"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\{i,j,k,l,p,q\\}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5a9fdd18-2832-44dc-8d2c-129f402cbc93"],
 ". Based on the list of indices, there are 15 such kinds of three-product of \
Kronecker deltas. \nTo make the simplification process easier later, we can \
fix a global list of three-products of Kronecker deltas and regard it as the \
basis. This is the basis we introduced in the paper in Appendix B.3. In this \
notebook, they are called ",
 StyleBox["globalDeltaList",
  FontWeight->"Bold"],
 "\n\nFor term 11 and 12, we have a slightly different form, since they \
contain two-product of Kronecker deltas, with permutation over ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{
           StyleBox["i", "TI"], ",", 
           StyleBox["j", "TI"], ",", 
           StyleBox["k", "TI"], ",", 
           StyleBox["l", "TI"], ",", 
           StyleBox["p", "TI"]}], "}"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\{i,j,k,l,p\\}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f7c3c531-b526-46dc-80d1-1ea28ea0af6b"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{
           StyleBox["i", "TI"], ",", 
           StyleBox["j", "TI"], ",", 
           StyleBox["k", "TI"], ",", 
           StyleBox["l", "TI"], ",", 
           StyleBox["p", "TI"], ",", 
           StyleBox["q", "TI"]}], "}"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\{i,j,k,l,p,q\\}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8f12582c-b90e-4221-b6d7-e857d29a5326"],
 " respectively. But we can still create and fix a list of all the possible \
partition and combination of the indices and use it as the global basis for \
all such terms in all 25 cases. In this notebook, they are called ",
 StyleBox["globalTwoDeltaList",
  FontWeight->"Bold"],
 " and ",
 StyleBox["globalTwoDeltaList2",
  FontWeight->"Bold"],
 " respectively.\n"
}], "Text",
 CellChangeTimes->{{3.922434581151168*^9, 3.922434586495446*^9}, {
   3.9224346313228807`*^9, 3.922434697886325*^9}, {3.922434833993619*^9, 
   3.922434846955248*^9}, {3.922434910847249*^9, 3.922434970845443*^9}, 
   3.922435026315755*^9, {3.92243508620178*^9, 3.922435204256871*^9}, {
   3.9224352542808533`*^9, 3.9224354789068747`*^9}, {3.922435576895741*^9, 
   3.922435592600644*^9}, 3.922435647515183*^9, {3.922435679988893*^9, 
   3.9224356839664783`*^9}, 3.922435722843137*^9, 3.929456671412281*^9, {
   3.929456751530278*^9, 
   3.929456889183494*^9}},ExpressionUUID->"4057f7e3-51b5-49bc-8a56-\
b553e41086aa"],

Cell[TextData[{
 "One final thing to mention is the symmetric cases. It is worth noticing \
that two cases that are symmetric with each other should be the same up to a \
permutation of indices. For example, let\[CloseCurlyQuote]s consider the \
cases ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["i", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["j", "TI"]], ";", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["k", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["l", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I^i_u, I^j_u; I^k_u, K^l_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "878f7d50-2df1-43f3-9b10-4c319c2a6610"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["i", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["j", "TI"]], ";", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["k", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["l", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I^i_u, K^j_u; I^k_u, I^l_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1f3a6f11-a5d1-44d7-b4ad-31b28cd125fa"],
 ". Notice that ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["k", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["l", "TI"]], ";", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["i", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["j", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I^k_u, I^l_u; I^i_u, K^j_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7eb60f89-408f-4ba9-8c6f-785efd3dc2a6"],
 "  and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["i", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["j", "TI"]], ";", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["k", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["l", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I^i_u, K^j_u; I^k_u, I^l_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f1a11f79-4aed-4d6d-a64e-4811b00e5d08"],
 " have the same coefficient if we expand ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubsuperscriptBox[
        StyleBox["I", "TI"], 
        StyleBox["u", "TI"], 
        StyleBox["k", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "I^k_u", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "526da123-7eaa-4c5f-b28c-81428b9e989f"],
 ", except that we change from term 1 to term 3. In other words, to get the \
coefficient with term 3 of  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["i", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["j", "TI"]], ";", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["k", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["l", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I^i_u, K^j_u; I^k_u, I^l_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b5a884d8-ddd1-48aa-af57-3e0f2601f3a0"],
 ", we can use the result of the coefficient with term 1 of  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["i", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["j", "TI"]], ";", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["k", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["l", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I^i_u, I^j_u; I^k_u, K^l_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1a557a6a-a676-4264-9a3d-3e33d9459008"],
 " and permute the indices ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         RowBox[{"(", 
           RowBox[{
             StyleBox["i", "TI"], ",", 
             StyleBox["j", "TI"]}], ")"}], "\[Rule]", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["k", "TI"], ",", 
             StyleBox["l", "TI"]}], ")"}]}], TraditionalForm], "errors" -> {},
      "input" -> "(i,j) \\to (k,l)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2e0b5e70-48c9-40e1-9baa-988163fd53f0"],
 ". We shall call this \[OpenCurlyDoubleQuote]symmetric\
\[CloseCurlyDoubleQuote] function later. \n\nAnother \
\[OpenCurlyDoubleQuote]symmetric2\[CloseCurlyDoubleQuote] function take into \
account the situation where beside changing the sub-indices, the partial \
derivative indices ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["p", "TI"], TraditionalForm], "errors" -> {}, "input" -> "p", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a2236531-d3db-457c-9e58-59e98bf8b084"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["q", "TI"], TraditionalForm], "errors" -> {}, "input" -> "q", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "43e5b151-b93c-4dfd-8964-65ad034e99c4"],
 " also need to be interchanged. This is because we always arrange indices \
according to the ordered list ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{
           StyleBox["i", "TI"], ",", 
           StyleBox["j", "TI"], ",", 
           StyleBox["k", "TI"], ",", 
           StyleBox["l", "TI"]}], "}"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\{i,j,k,l\\}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0295ee0b-e5e0-44fd-a23e-440fc27a6e49"],
 ", and we always take the partial derivative ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["p", "TI"], TraditionalForm], "errors" -> {}, "input" -> "p", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "215b3743-0fbb-4628-9512-e6af2ab877fa"],
 " of a term with index appearing first, then take the partial derivative ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["q", "TI"], TraditionalForm], "errors" -> {}, "input" -> "q", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "dfe87e67-7754-41f6-92f9-b118b3415a0d"],
 " of a term with index appearing later, i.e. there ",
 StyleBox["cannot",
  FontWeight->"Bold"],
 " be a term like  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[PartialD]", 
          StyleBox["q", "TI"]], 
         SubscriptBox["\[Phi]", 
          StyleBox["i", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[PartialD]", 
          StyleBox["p", "TI"]], 
         SubscriptBox["\[Phi]", 
          StyleBox["j", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["k", "TI"]], "\[CircleTimes]", 
         SubscriptBox["\[Phi]", 
          StyleBox["l", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\partial_q \\phi_i \\otimes \\partial_p \\phi_j \\otimes \\phi_k \
\\otimes \\phi_l", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3602efe8-8f3b-4fee-98fc-01d12d5cd96b"],
 ". \nTaking the above example of the cases ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["i", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["j", "TI"]], ";", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["k", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["l", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I^i_u, I^j_u; I^k_u, K^l_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "06feca21-61cc-4811-a1ed-9a272d49ae49"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["i", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["j", "TI"]], ";", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["k", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["l", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I^i_u, K^j_u; I^k_u, I^l_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b16ab086-718f-43b5-878d-68b1a1c6abd0"],
 " again. Notice that ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["i", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["j", "TI"]], ";", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["k", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["l", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I^i_u, K^j_u; I^k_u, I^l_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "97665298-7cab-4653-a780-7440fd98e624"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["k", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["l", "TI"]], ";", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["i", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["j", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I^k_u, I^l_u; I^i_u, K^j_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ebe3a16d-098e-4b6c-8ed7-83f63d84f0be"],
 "  have the same coefficient if we expand both ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubsuperscriptBox[
        StyleBox["K", "TI"], 
        StyleBox["u", "TI"], 
        StyleBox["j", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "K^j_u", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8524a3df-daab-444a-bf42-e2beb44bce60"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubsuperscriptBox[
        StyleBox["I", "TI"], 
        StyleBox["u", "TI"], 
        StyleBox["k", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "I^k_u", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a901371a-1630-4368-9bce-94dc2f2eb698"],
 ", except that we change from term 8 to term 7, which with derivative \
indices is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox["\[PartialD]", 
            StyleBox["q", "TI"]], 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["k", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["l", "TI"]], ";", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["i", "TI"]], ",", 
           SubscriptBox["\[PartialD]", 
            StyleBox["p", "TI"]], 
           SubsuperscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["j", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(\\partial_q I^k_u, I^l_u; I^i_u, \\partial_p K^j_u)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d28448d0-3512-4a7f-9acc-f83bd3f335d1"],
 ". In other words, to get the coefficient with term 8 of  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["i", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["j", "TI"]], ";", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["k", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["l", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I^i_u, K^j_u; I^k_u, I^l_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f6e6217a-7ccd-4d13-b7cd-b36d1a3d36e6"],
 ", we can use the result of the coefficient with term 7 of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["i", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["j", "TI"]], ";", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["k", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["l", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(I^i_u, I^j_u; I^k_u, K^l_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b5add178-7017-4bd4-84bc-ead7875580fe"],
 ", which with derivative indices is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{
           SubscriptBox["\[PartialD]", 
            StyleBox["p", "TI"]], 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["i", "TI"]], ",", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["j", "TI"]], ";", 
           SubsuperscriptBox[
            StyleBox["I", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["k", "TI"]], ",", 
           SubscriptBox["\[PartialD]", 
            StyleBox["q", "TI"]], 
           SubsuperscriptBox[
            StyleBox["K", "TI"], 
            StyleBox["u", "TI"], 
            StyleBox["l", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "(\\partial_p I^i_u, I^j_u; I^k_u, \\partial_q K^l_u)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "54d9d3ba-f3e5-4476-818f-ad39c3da577c"],
 ", and permute the indices as ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         RowBox[{"(", 
           RowBox[{
             StyleBox["i", "TI"], ",", 
             StyleBox["j", "TI"], ",", 
             StyleBox["p", "TI"]}], ")"}], "\[Rule]", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["k", "TI"], ",", 
             StyleBox["l", "TI"], ",", 
             StyleBox["q", "TI"]}], ")"}]}], TraditionalForm], "errors" -> {},
      "input" -> "(i,j, p) \\to (k,l,q)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "aa7ba76c-d202-4347-af93-785c3febd9d3"],
 ".\n"
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQXVC//mKx5VvHRUt7L4HoBy/j2EqAtFUnDzuIXr/5
ggiIlng3VRVE2/57pguiD6Tn24BoC37NJBD9aFVoKog+EdCTDaKdjn7KB9Hr
jpWWguh7nuHlILp4V0A1iNZYJVcHotckKTSBaN4HD8C0ZUhGN4iuVaqcDLZf
7fBMED3BX2MxWF3+0pRqIM0wm68aREcd0+8G0TrWi2aAaL4FFgtA9NJI8e0g
+rrIp70ges/dF+dAtPW2tqsg2oD7BZjeE7H7Joju6Xh8C0Snrjz6GkTrpUS/
A9HzNjv9BtEFP6SZaoC0jLoQO4jueT2HA8y3uK4KoifO0lUD0WZLjLRBdE1S
swWIjoxJcAXRosXnPUD0Khb9ABC95w57EIjeJPBF4YbbW8c3D+PUQDQA75y+
1A==
  "],ExpressionUUID->"4efdc493-aa31-4a84-89db-4bd912501f7f"],

Cell[CellGroupData[{

Cell["Auxiliary Global Kronecker Delta Lists.", "Subchapter",
 CellChangeTimes->{{3.908707904209818*^9, 3.908707905685658*^9}, {
  3.90870805487191*^9, 3.908708067230097*^9}, {3.908791594981732*^9, 
  3.90879160458885*^9}, {3.920100214528163*^9, 3.920100217263908*^9}, {
  3.920100592130511*^9, 
  3.920100593537654*^9}},ExpressionUUID->"d6397ca6-fdf5-422a-a256-\
69020a92a015"],

Cell["\<\
This part is purely for auxiliary purpose. We will use the list of products \
of Kronecker Deltas constructed here to simplify calculations later.
The list of Kronecker Deltas plays the role as basis. \
\>", "Text",
 CellChangeTimes->{{3.920100597579784*^9, 3.920100625040884*^9}, {
   3.9201006847481737`*^9, 3.920100718466544*^9}, {3.920103725618042*^9, 
   3.920103844213878*^9}, 
   3.92010389521355*^9},ExpressionUUID->"760e5b17-16d7-4fbc-b7be-\
17ebf422751b"],

Cell[CellGroupData[{

Cell[TextData[{
 "Three product of Kronecker deltas associated with tensor products of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Phi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0916cd99-8de6-4192-9d58-617e1cdae5bc"],
 ". "
}], "Subsection",
 CellChangeTimes->{{3.908708084516242*^9, 3.908708106180097*^9}, {
  3.9087092890857267`*^9, 3.908709292859454*^9}, {3.908712961213717*^9, 
  3.9087129771206713`*^9}, {3.908988327178562*^9, 
  3.908988334798875*^9}},ExpressionUUID->"85731122-edc7-4971-b1fd-\
da89335585ea"],

Cell[TextData[{
 "The globalDeltaList is the delta list of all the possible products of three \
Kronecker deltas with six indices. This is based on the 15 different ways of \
partitioning {i,j,k,l,p,q} into three pairs, and are associated with the \
tensor products of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Phi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "801eb7ad-d480-4920-8f85-ee542d01d3b2"],
 " terms later."
}], "Text",
 CellChangeTimes->{{3.90870347868661*^9, 3.9087034797849407`*^9}, {
  3.908705714493933*^9, 3.908705777728277*^9}, {3.908708112759721*^9, 
  3.908708147996897*^9}, {3.908709447982579*^9, 
  3.908709483338983*^9}},ExpressionUUID->"f8e3fd00-e6c3-4b7f-9ee0-\
bc0e132fb770"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
   "output5", " ", "gives", " ", "a", " ", "list", " ", "of", " ", "all", " ",
     "the", " ", "possible", " ", "partitions", " ", "of", " ", "6", " ", 
    "indices", " ", "in", " ", "list", " ", 
    RowBox[{"form", "."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"output1", "=", 
     RowBox[{"Permutations", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output2", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"output1", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "==", "1"}], "&"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output3", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"output2", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "<", 
         RowBox[{"#", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "&"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output4", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"output3", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "<", 
         RowBox[{"#", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "&"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"output5", "=", 
    RowBox[{"Select", "[", 
     RowBox[{"output4", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "<", 
        RowBox[{"#", "[", 
         RowBox[{"[", "6", "]"}], "]"}]}], "&"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.908703562610524*^9, 3.90870360941304*^9}, {
   3.908703964442468*^9, 3.908704057639715*^9}, {3.908705276256415*^9, 
   3.9087052997150183`*^9}, {3.908705595577879*^9, 3.908705638655615*^9}, {
   3.908705676665131*^9, 3.908705690038178*^9}, {3.908705790911113*^9, 
   3.90870582759897*^9}, {3.908705895649687*^9, 3.908705895848032*^9}, 
   3.908709306350034*^9, {3.920100253707611*^9, 3.920100274693748*^9}, {
   3.920100310024431*^9, 3.920100449423049*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"1b2b06fb-2c74-4475-b181-a6b74b788970"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "5", ",", "4", ",", "6"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "6", ",", "4", ",", "5"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "2", ",", "4", ",", "5", ",", "6"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "2", ",", "5", ",", "4", ",", "6"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "2", ",", "6", ",", "4", ",", "5"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4", ",", "2", ",", "3", ",", "5", ",", "6"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4", ",", "2", ",", "5", ",", "3", ",", "6"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4", ",", "2", ",", "6", ",", "3", ",", "5"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5", ",", "2", ",", "3", ",", "4", ",", "6"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5", ",", "2", ",", "4", ",", "3", ",", "6"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5", ",", "2", ",", "6", ",", "3", ",", "4"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "6", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "6", ",", "2", ",", "4", ",", "3", ",", "5"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "6", ",", "2", ",", "5", ",", "3", ",", "4"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.920100380381125*^9, 3.920113269766231*^9, 
  3.921737019502346*^9, 3.922463390790481*^9, 3.923643600690129*^9, 
  3.9264695641229568`*^9, 3.929455337321599*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"7df90009-5eb1-4e9a-9ef1-89744f14d34a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
   "Turns", " ", "the", " ", "partitions", " ", "into", " ", "Kronecker", " ",
     "Delta", " ", "products", " ", "with", " ", "symbolic", " ", 
    RowBox[{"indices", "."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"indexList", "=", 
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "p", ",", "q"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"globalDeltaList", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{
         RowBox[{"indexList", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"output5", "[", 
             RowBox[{"[", "counter", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"indexList", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"output5", "[", 
             RowBox[{"[", "counter", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{
         RowBox[{"indexList", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"output5", "[", 
             RowBox[{"[", "counter", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"indexList", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"output5", "[", 
             RowBox[{"[", "counter", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{
         RowBox[{"indexList", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"output5", "[", 
             RowBox[{"[", "counter", "]"}], "]"}], "[", 
            RowBox[{"[", "5", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"indexList", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"output5", "[", 
             RowBox[{"[", "counter", "]"}], "]"}], "[", 
            RowBox[{"[", "6", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"counter", ",", 
        RowBox[{"Length", "[", "output5", "]"}]}], "}"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.908705929597547*^9, 3.908705938923533*^9}, {
   3.908705971567266*^9, 3.908706105611668*^9}, {3.9087073239308968`*^9, 
   3.908707452693089*^9}, 3.908709318469951*^9, {3.920100490326643*^9, 
   3.920100531414102*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"9571b2b4-e2af-498c-933b-e28bdd3b62c8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "j"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"k", ",", "l"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"p", ",", "q"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "j"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"k", ",", "p"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"l", ",", "q"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "j"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"k", ",", "q"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"l", ",", "p"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "k"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"j", ",", "l"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"p", ",", "q"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "k"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"j", ",", "p"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"l", ",", "q"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "k"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"j", ",", "q"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"l", ",", "p"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "l"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"j", ",", "k"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"p", ",", "q"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "l"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"j", ",", "p"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"k", ",", "q"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "l"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"j", ",", "q"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"k", ",", "p"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "p"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"j", ",", "k"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"l", ",", "q"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "p"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"j", ",", "l"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"k", ",", "q"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "p"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"j", ",", "q"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"k", ",", "l"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "q"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"j", ",", "k"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"l", ",", "p"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "q"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"j", ",", "l"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"k", ",", "p"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "q"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"j", ",", "p"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"k", ",", "l"}]},
     "KroneckerDeltaSeq"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.908706038697803*^9, 3.908706061081969*^9}, 
   3.908706108548488*^9, {3.908707349504917*^9, 3.908707380936063*^9}, {
   3.90870744623304*^9, 3.908707453459933*^9}, 3.908709328619627*^9, 
   3.908791558598245*^9, 3.908968272162042*^9, 3.90921389474166*^9, 
   3.909391043010017*^9, 3.909484779143944*^9, 3.910074540421321*^9, 
   3.910172840301684*^9, 3.910355558614099*^9, 3.910355981966593*^9, 
   3.910687613103333*^9, 3.910689251718481*^9, 3.910700146365058*^9, 
   3.9107008774888287`*^9, 3.910701330114697*^9, 3.911989184600762*^9, 
   3.913297770016101*^9, 3.915607133697819*^9, 3.916372372953761*^9, 
   3.917550631128131*^9, 3.9187231620411386`*^9, 3.920100778389304*^9, 
   3.920113272060277*^9, 3.921737019516979*^9, 3.922463390808271*^9, 
   3.923643600696273*^9, 3.926469564136549*^9, 3.929455337333165*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"2650e366-1f62-42a2-9851-c218289fcb00"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Two product of Kronecker deltas associated with ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[PartialD]", 
          StyleBox["p", "TI"]], 
         StyleBox["b", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\partial_p b", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "455471ae-e71f-429b-8707-77a00be15bd8"],
 "."
}], "Subsection",
 CellChangeTimes->{{3.908709263503736*^9, 3.9087092862106*^9}, {
  3.908712930532953*^9, 
  3.908712934638763*^9}},ExpressionUUID->"8425f8be-9a2e-41b2-a051-\
5346127a734e"],

Cell[TextData[{
 "The globalTwoDeltaList is the delta list for the terms with coefficient ",
 Cell[BoxData[
  TemplateBox[<|"boxes" -> FormBox[
      RowBox[{"\[PartialD]", 
        StyleBox["b", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
    "\\partial b", "state" -> "Boxes"|>,
   "TeXAssistantTemplate"]],ExpressionUUID->
  "a5ab463f-f26f-4056-aca1-1818efb50d7a"],
 ", which contains all the possible products of two Kronecker deltas with \
five indices {i,j,k,l,p}.\nThis is based on selecting four elements and then \
partitioning the selected indices into two pairs."
}], "Text",
 CellChangeTimes->{{3.908709350087935*^9, 3.908709352397249*^9}, {
  3.90870949825413*^9, 3.908709550361806*^9}, {3.908712999883945*^9, 
  3.908713027947803*^9}, {3.920100828022279*^9, 
  3.920100853992495*^9}},ExpressionUUID->"6ba185fe-ca14-473f-bd7d-\
1e2207d21a86"],

Cell["\<\
Notice the Subsets[{1,2,3,4},{2}] gives \
{{1,2},{1,3},{1,4},{2,3},{2,4},{3,4}}. Pick the first three, and combine with \
the last three in reverse order respectively,  we get the proper partitions.\
\>", "Text",
 CellChangeTimes->{{3.920101803594371*^9, 3.9201019052057858`*^9}, {
  3.9201020083751307`*^9, 
  3.920102032381481*^9}},ExpressionUUID->"53880351-eced-48e8-b02b-\
92c7855fe2a2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "indexList", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "counter", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"indexList", "=", 
    RowBox[{"{", 
     RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "p"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Get", " ", "all", " ", "possible", " ", "four"}], "-", 
    RowBox[{"element", " ", "subsets"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fourElementList", "=", 
    RowBox[{"Subsets", "[", 
     RowBox[{"indexList", ",", 
      RowBox[{"{", "4", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Get", " ", "all", " ", "the", " ", "partions", " ", "into", " ", "two", 
     " ", "two"}], "-", 
    RowBox[{"element", " ", "subsets"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"firstPair", "=", 
   RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Subsets", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"fourElementList", "[", 
           RowBox[{"[", "counter", "]"}], "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "3"}], "]"}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"counter", ",", 
         RowBox[{"Length", "[", "fourElementList", "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"secondPair", "=", 
   RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Reverse", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Subsets", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"fourElementList", "[", 
            RowBox[{"[", "counter", "]"}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"4", ";;", "6"}], "]"}], "]"}], "\[IndentingNewLine]", 
        "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"counter", ",", 
         RowBox[{"Length", "[", "fourElementList", "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"globalTwoDeltaList", "=", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"KroneckerDelta", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"firstPair", "[", 
         RowBox[{"[", "counter", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"firstPair", "[", 
         RowBox[{"[", "counter", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", "*", 
     RowBox[{"KroneckerDelta", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"secondPair", "[", 
         RowBox[{"[", "counter", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"secondPair", "[", 
         RowBox[{"[", "counter", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"counter", ",", 
      RowBox[{"Length", "[", "firstPair", "]"}]}], "}"}]}], "]"}]}]}], "Input",\

 CellChangeTimes->{{3.908709929300178*^9, 3.908710014823435*^9}, {
  3.9087103794068117`*^9, 3.908710456863297*^9}, {3.908711441478907*^9, 
  3.908711508156942*^9}, {3.908711540534625*^9, 3.908711599723485*^9}, {
  3.9087122767618732`*^9, 3.908712306823032*^9}, {3.908712408649629*^9, 
  3.908712719207202*^9}, {3.920100880387155*^9, 3.920100903716229*^9}, {
  3.920100977058849*^9, 3.920101040213072*^9}, {3.920101081449313*^9, 
  3.920101226792418*^9}, {3.920101258086993*^9, 3.92010127046749*^9}, {
  3.920101301907138*^9, 3.920101349360532*^9}, {3.920101392457614*^9, 
  3.920101518058341*^9}, {3.920101623137533*^9, 3.920101788893833*^9}, {
  3.92010201935727*^9, 3.920102100303832*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"44397d24-85a0-4d54-96a3-ff70190b4381"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "j"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"k", ",", "l"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "k"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"j", ",", "l"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "l"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"j", ",", "k"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "j"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"k", ",", "p"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "k"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"j", ",", "p"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "p"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"j", ",", "k"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "j"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"l", ",", "p"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "l"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"j", ",", "p"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "p"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"j", ",", "l"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "k"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"l", ",", "p"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "l"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"k", ",", "p"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "p"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"k", ",", "l"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"j", ",", "k"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"l", ",", "p"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"j", ",", "l"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"k", ",", "p"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"j", ",", "p"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"k", ",", "l"}]},
     "KroneckerDeltaSeq"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.908712478932159*^9, {3.9087125165915217`*^9, 3.908712539277483*^9}, {
   3.908712708723212*^9, 3.908712720626033*^9}, 3.908791558637841*^9, 
   3.908968272200755*^9, 3.9092138947621193`*^9, 3.90939104304799*^9, 
   3.909484779167449*^9, 3.910074540459984*^9, 3.910172840342385*^9, 
   3.910355558653658*^9, 3.910355982005768*^9, 3.910687613142488*^9, 
   3.91068925175471*^9, 3.910700146403915*^9, 3.91070087752862*^9, 
   3.91070133015696*^9, 3.911989184622553*^9, 3.913297770038387*^9, 
   3.915607133741091*^9, 3.916372372960106*^9, 3.9175506311385713`*^9, 
   3.918723162049619*^9, {3.920101575539241*^9, 3.920101586703809*^9}, 
   3.920101619403256*^9, {3.920101753334399*^9, 3.920101790673361*^9}, {
   3.920101999840002*^9, 3.920102112162553*^9}, 3.92011327481294*^9, 
   3.921737019525798*^9, 3.922463390815868*^9, 3.923643600712385*^9, 
   3.926469564142069*^9, 3.929455337341135*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"8bb8e08c-b9a4-4c1e-a9f8-95f010c7b031"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Two product of Kronecker deltas associated with ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{
            StyleBox["p", "TI"], 
            StyleBox["q", "TI"]}]], 
         StyleBox["a", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\partial_{pq}a", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "796d1549-9dd8-4c93-93f6-612f9de61748"],
 "."
}], "Subsection",
 CellChangeTimes->{{3.908712859088696*^9, 3.908712890097191*^9}, 
   3.908712921712283*^9, {3.908712953457839*^9, 
   3.908712956183666*^9}},ExpressionUUID->"b46f4227-2ede-4941-8ac2-\
1a0267f8e0c5"],

Cell[TextData[{
 "The globalDeltaList2 is the delta list for the terms with coefficient ",
 Cell[BoxData[
  TemplateBox[<|"boxes" -> FormBox[
      RowBox[{
        SubscriptBox["\[PartialD]", 
         RowBox[{
           StyleBox["p", "TI"], 
           StyleBox["q", "TI"]}]], 
        StyleBox["a", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
    "\\partial_{pq} a", "state" -> "Boxes"|>,
   "TeXAssistantTemplate"]],ExpressionUUID->
  "d565b929-4656-43f4-bef5-7364c684730f"],
 ". There will be six indices, which are {i,j,k,l,p,q}. But the Kronecker \
delta terms must contain the indices p and q, i.e. we must select indices p,q \
and need to select another two indices from {i,j,k,l}, and then find all the \
partitions of this four-element set."
}], "Text",
 CellChangeTimes->{{3.908713046906649*^9, 3.908713054396616*^9}, {
  3.920101926792479*^9, 3.920101996862721*^9}, {3.9201021351300907`*^9, 
  3.920102142870783*^9}},ExpressionUUID->"3d12afc7-62b8-41bd-9a33-\
a00e1478c1b4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "indexList", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "counter", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"indexList1", "=", 
   RowBox[{"{", 
    RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"indexListTwoSubsets", "=", 
   RowBox[{"Subsets", "[", 
    RowBox[{"indexList1", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"globalTwoDeltaList2", "=", "\[IndentingNewLine]", 
  RowBox[{"Join", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"indexListTwoSubsets", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "p"}], "]"}], 
           "\[IndentingNewLine]", "*", 
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"indexListTwoSubsets", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "q"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"indexListTwoSubsets", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "q"}], "]"}], 
           "\[IndentingNewLine]", "*", 
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"indexListTwoSubsets", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "p"}], "]"}]}]}], 
         "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"counter", ",", 
          RowBox[{"Length", "[", "indexListTwoSubsets", "]"}]}], "}"}]}], 
       "]"}], "\[IndentingNewLine]", ",", "1"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"indexListTwoSubsets", "[", 
           RowBox[{"[", "counter", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"indexListTwoSubsets", "[", 
           RowBox[{"[", "counter", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"p", ",", "q"}], "]"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"counter", ",", 
        RowBox[{"Length", "[", "indexListTwoSubsets", "]"}]}], "}"}]}], 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.908713281248966*^9, 3.908713357110601*^9}, {
  3.908713416374849*^9, 3.908713475926679*^9}, {3.908791714687681*^9, 
  3.90879177130751*^9}, {3.908791803369372*^9, 3.908791943999908*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"b4e4ea58-a506-443f-a794-74afa20f3dfc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "p"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"j", ",", "q"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "q"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"j", ",", "p"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "p"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"k", ",", "q"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "q"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"k", ",", "p"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "p"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"l", ",", "q"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "q"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"l", ",", "p"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"j", ",", "p"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"k", ",", "q"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"j", ",", "q"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"k", ",", "p"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"j", ",", "p"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"l", ",", "q"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"j", ",", "q"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"l", ",", "p"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"k", ",", "p"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"l", ",", "q"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"k", ",", "q"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"l", ",", "p"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "j"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"p", ",", "q"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "k"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"p", ",", "q"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"i", ",", "l"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"p", ",", "q"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"j", ",", "k"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"p", ",", "q"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"j", ",", "l"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"p", ",", "q"}]},
     "KroneckerDeltaSeq"]}], ",", 
   RowBox[{
    TemplateBox[{
      RowBox[{"k", ",", "l"}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{
      RowBox[{"p", ",", "q"}]},
     "KroneckerDeltaSeq"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.9201022828295946`*^9, 3.920113278742063*^9, 
  3.921737019543336*^9, 3.922463390833029*^9, 3.9236436007198*^9, 
  3.92646956415407*^9, 3.929455337345779*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"5894c31e-9df3-44ba-9c6a-66307933547d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two-Product Case", "Chapter",
 CellChangeTimes->{{3.9201172073516917`*^9, 3.920117212453125*^9}, {
  3.929457969150601*^9, 
  3.9294579701515017`*^9}},ExpressionUUID->"83e91c71-7610-41db-bc65-\
c921bbaf9637"],

Cell[CellGroupData[{

Cell["Two-Product Expectation Expression", "Subchapter",
 CellChangeTimes->{{3.920102881323242*^9, 3.920102887712186*^9}, {
  3.920114334463841*^9, 
  3.9201143373101397`*^9}},ExpressionUUID->"8b460f9f-6771-45fa-9b48-\
a9724ed0ece5"],

Cell[TextData[{
 "In general we want to find the formula of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"[", 
                RowBox[{"0", ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "1"]}], "]"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "1"]], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"[", 
                RowBox[{"0", ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "2"]}], "]"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]]}], "]"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\mathbb{E} [X^{i_1}_{[0,ta_1]} X^{i_2}_{[0,ta_2]}]", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "cf839920-4a5e-4900-91a2-9b3e63a8cee8"],
 "\nwhere"
}], "Text",
 CellChangeTimes->{{3.908634036560461*^9, 3.90863406241256*^9}, {
   3.908634155712413*^9, 3.908634190201085*^9}, {3.908634311862083*^9, 
   3.908634369950386*^9}, 3.90879202622515*^9, {3.920103340446205*^9, 
   3.920103343414105*^9}},ExpressionUUID->"8cf64fe7-5da1-4a09-b739-\
6b7d7e7b02d7"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["d", "TI"], 
         SubsuperscriptBox[
          StyleBox["X", "TI"], 
          StyleBox["u", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "1"]], "\[LongEqual]", 
         SubscriptBox["\[Mu]", "1"], 
         StyleBox["d", "TI"], 
         StyleBox["u", "TI"], "+", 
         SubscriptBox[
          StyleBox["C", "TI"], "1"], 
         RowBox[{"(", 
           RowBox[{
             SubscriptBox["\[Sigma]", 
              RowBox[{
                SubscriptBox[
                 StyleBox["i", "TI"], "1"], ",", "1"}]], 
             StyleBox["d", "TI"], 
             SubsuperscriptBox[
              StyleBox["B", "TI"], 
              StyleBox["u", "TI"], "1"], "+", 
             SubscriptBox["\[Sigma]", 
              RowBox[{
                SubscriptBox[
                 StyleBox["i", "TI"], "1"], ",", "2"}]], 
             StyleBox["d", "TI"], 
             SubsuperscriptBox[
              StyleBox["B", "TI"], 
              StyleBox["u", "TI"], "2"]}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "dX^{i_1}_u = \\mu_1du + C_1(\\sigma_{i_1,1} dB^1_u + \\sigma_{i_1,2} \
dB^2_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d9ab3686-46e3-49c3-962d-750257c5322b"],
 ", on ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"0", "\[LessEqual]", 
         StyleBox["u", "TI"], "\[LessEqual]", 
         SubscriptBox[
          StyleBox["a", "TI"], "1"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "0 \\leq u \\leq a_1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "08b285d9-5c86-42bd-b36c-67217e38543b"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["d", "TI"], 
         SubsuperscriptBox[
          StyleBox["X", "TI"], 
          StyleBox["u", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "2"]], "\[LongEqual]", 
         SubscriptBox["\[Mu]", "2"], 
         StyleBox["d", "TI"], 
         StyleBox["u", "TI"], "+", 
         SubscriptBox[
          StyleBox["C", "TI"], "2"], 
         RowBox[{"(", 
           RowBox[{
             SubscriptBox["\[Sigma]", 
              RowBox[{
                SubscriptBox[
                 StyleBox["i", "TI"], "2"], ",", "1"}]], 
             StyleBox["d", "TI"], 
             SubsuperscriptBox[
              StyleBox["B", "TI"], 
              StyleBox["u", "TI"], "1"], "+", 
             SubscriptBox["\[Sigma]", 
              RowBox[{
                SubscriptBox[
                 StyleBox["i", "TI"], "2"], ",", "2"}]], 
             StyleBox["d", "TI"], 
             SubsuperscriptBox[
              StyleBox["B", "TI"], 
              StyleBox["u", "TI"], "2"]}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "dX^{i_2}_u = \\mu_2 du+ C_2(\\sigma_{i_2,1} dB^1_u + \\sigma_{i_2,2} \
dB^2_u)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "afe94ff3-517b-4759-be9c-393032599bc6"],
 ", on ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"0", "\[LessEqual]", 
         StyleBox["u", "TI"], "\[LessEqual]", 
         SubscriptBox[
          StyleBox["a", "TI"], "2"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "0 \\leq u \\leq a_2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7876011f-c788-4c3c-a8a0-5595f6cf532e"],
 ","
}], "Text",
 CellChangeTimes->{{3.908634383646866*^9, 3.90863443615403*^9}, {
  3.920104004439411*^9, 
  3.92010400519907*^9}},ExpressionUUID->"e88c1f8a-b65e-4196-8917-\
435cc95205e7"],

Cell[TextData[{
 "for some deterministic ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "1"], ",", 
         SubscriptBox[
          StyleBox["C", "TI"], "2"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "C_1,C_2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "91ce569e-5723-4871-b94a-fe8af73e9931"],
 ".The following function \"twoProductF\" is used to find symbolically the \
expectation of product of two stochastic integrals on different time horizons \
",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"[", 
         RowBox[{"0", ",", 
           StyleBox["t", "TI"], 
           SubscriptBox[
            StyleBox["a", "TI"], "1"]}], "]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "[0,ta_1]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c9e9c971-ca11-4989-8239-0965fb13401d"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"[", 
         RowBox[{"0", ",", 
           StyleBox["t", "TI"], 
           SubscriptBox[
            StyleBox["a", "TI"], "2"]}], "]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "[0,ta_2]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "79fa62cb-a590-4be2-a709-8ed189f273b7"],
 " using the package \"ItoLemma.m\".\nNOTICE: since we are not considering \
the expansion in the diffusion term, thus  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox[
          StyleBox["a", "TI"], 
          RowBox[{
            StyleBox["i", "TI"], 
            StyleBox["j", "TI"]}]], ":", "\[LongEqual]", 
         SuperscriptBox[
          RowBox[{"(", 
            SuperscriptBox["\[Sigma]\[Sigma]", 
             StyleBox["T", "TI"]], ")"}], 
          RowBox[{
            StyleBox["i", "TI"], 
            StyleBox["j", "TI"]}]], "\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            StyleBox["i", "TI"], 
            StyleBox["j", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "a^{ij}:=(\\sigma \\sigma^{T})^{ij}=\\delta_{ij}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7939aa29-a40b-4582-bdad-d443f52a8141"],
 ". And in fact, in all our cases, we observe that the drifts are always the \
0 vector. We still keep it as an input in our codes."
}], "Text",
 CellChangeTimes->{{3.908634471937643*^9, 3.908634533696035*^9}, 
   3.908634619110079*^9, {3.908792057000381*^9, 3.908792145913506*^9}, {
   3.920102356611197*^9, 3.920102435923192*^9}, {3.920103071811172*^9, 
   3.920103211124525*^9}, {3.920103258041768*^9, 3.920103261659803*^9}, {
   3.9201033809546213`*^9, 3.920103548386412*^9}, {3.920104000300021*^9, 
   3.920104023863159*^9}},ExpressionUUID->"b1f1cfbf-0961-4c22-9470-\
d8fcc80f3cfb"],

Cell[CellGroupData[{

Cell["Inputs:", "Subsection",
 CellChangeTimes->{{3.920117125296403*^9, 
  3.920117129386271*^9}},ExpressionUUID->"c922f4db-06eb-4068-8621-\
017d6df18e23"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["i", "TI"], TraditionalForm], "errors" -> {}, "input" -> "i", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d9240e39-62e9-446d-a746-fd08262f1579"],
 ": list of indices,\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["a", "TI"], TraditionalForm], "errors" -> {}, "input" -> "a", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "56d362c8-bfa2-4cab-8236-e7dea7513b68"],
 ": list of the time horizon parameter of each process,\ndrift: the drift \
vector,\nC: the vector of the coefficients in front of the term ",
 Cell[BoxData[
  TemplateBox[<|"boxes" -> FormBox[
      SubscriptBox[
       RowBox[{"(", 
         RowBox[{"\[Sigma]", 
           StyleBox["d", "TI"], 
           StyleBox["B", "TI"]}], ")"}], 
       StyleBox["u", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
    "(\\sigma dB)_u", "state" -> "Boxes"|>,
   "TeXAssistantTemplate"]],ExpressionUUID->
  "26e20035-0aa5-4529-93a1-a37213a3dda9"],
 "."
}], "Text",
 CellChangeTimes->{{3.908792137647462*^9, 3.908792137960102*^9}, {
  3.920102489213688*^9, 3.9201025045308113`*^9}, {3.920103360963801*^9, 
  3.9201033714201813`*^9}},ExpressionUUID->"be6b7ec9-2382-4999-bee5-\
c708042b9069"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Outputs:", "Subsection",
 CellChangeTimes->{{3.920117134969919*^9, 
  3.920117139110487*^9}},ExpressionUUID->"ae582b85-da77-49a2-b5aa-\
f601185c2131"],

Cell["\<\
first position: the full expression of the resulting term;
second position: the associated Kronecker delta term.\
\>", "Text",
 CellChangeTimes->{{3.9087921694685287`*^9, 3.908792169793413*^9}, {
  3.908792213682287*^9, 
  3.90879225447867*^9}},ExpressionUUID->"4bd6cceb-bf3b-4842-a805-\
5d2ec99d251c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"twoProductF", "[", "\n", 
   RowBox[{"i_", ",", "\n", "a_", ",", "\n", "drift_", ",", "\n", "C_"}], 
   "\n", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\n", 
    RowBox[{"(*", 
     RowBox[{
     "Initislise", " ", "the", " ", "\[Sigma]", " ", "symbolic", " ", 
      RowBox[{"matrix", "."}]}], "*)"}], "\n", 
    RowBox[{
     RowBox[{"sigmaMatrix", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"\[Sigma]", ",", "m", ",", "n"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "i"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "i"}], "}"}]}], "]"}]}], " ", ";", "\n", 
     RowBox[{"(*", 
      RowBox[{
      "M", " ", "is", " ", "used", " ", "to", " ", "store", " ", 
       "symbolically", " ", 
       RowBox[{"\[Sigma]\[Sigma]", "^", "T"}]}], "*)"}], "\n", 
     RowBox[{"M", " ", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"sigmaMatrix", ".", 
         RowBox[{"Transpose", "[", "sigmaMatrix", "]"}]}], ",", "1"}], 
       "]"}]}], " ", ";", "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
        "A", " ", "is", " ", "used", " ", "to", " ", "assign", " ", "the", 
         " ", "result", " ", "of", " ", 
         RowBox[{"\[Sigma]\[Sigma]", "^", "T"}], " ", "component"}], "-", 
        "wisely"}], ",", " ", 
       RowBox[{"which", " ", "are", " ", 
        TemplateBox[<|"boxes" -> FormBox[
            SubscriptBox["\[Delta]", 
             RowBox[{
               StyleBox["i", "TI"], 
               StyleBox["j", "TI"]}]], TraditionalForm], "errors" -> {}, 
          "input" -> "\\delta_{ij}", "state" -> "Boxes"|>,
         "TeXAssistantTemplate"]}]}], "*)"}], "\n", 
     RowBox[{"A", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"KroneckerDelta", "[", 
           RowBox[{"m", ",", "n"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "i"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "i"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], ";", 
     "\n", 
     RowBox[{"(*", 
      RowBox[{
      "Build", " ", "a", " ", "symbolic", " ", "replacement", " ", "rule", 
       " ", "between", " ", "M", " ", "and", " ", "A"}], "*)"}], "\n", 
     RowBox[{"matrixRules", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"M", "[", 
          RowBox[{"[", "counter", "]"}], "]"}], "\[Rule]", 
         RowBox[{"A", "[", 
          RowBox[{"[", "counter", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"counter", ",", "4"}], "}"}]}], "]"}]}], " ", ";", "\n", 
     RowBox[{"(*", 
      RowBox[{"create", " ", "stochastic", " ", "processes", " ", 
       TemplateBox[<|"boxes" -> FormBox[
           RowBox[{
             StyleBox["d", "TI"], 
             SuperscriptBox[
              StyleBox["X", "TI"], 
              SubscriptBox[
               StyleBox["i", "TI"], "1"]]}], TraditionalForm], "errors" -> {},
          "input" -> "dX^{i_1}", "state" -> "Boxes"|>,
        "TeXAssistantTemplate"], " ", "and", " ", 
       TemplateBox[<|"boxes" -> FormBox[
           RowBox[{
             StyleBox["d", "TI"], 
             SuperscriptBox[
              StyleBox["X", "TI"], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]]}], TraditionalForm], "errors" -> {},
          "input" -> "dX^{i_2}", "state" -> "Boxes"|>,
        "TeXAssistantTemplate"]}], "*)"}], "\n", 
     RowBox[{"ItoMake", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"x", ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", "u", "]"}], ",", 
       RowBox[{"drift", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"C", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", 
        RowBox[{"sigmaMatrix", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", "\n", 
     RowBox[{"ItoMake", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"x", ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", "u", "]"}], ",", 
       RowBox[{"drift", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"C", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", 
        RowBox[{"sigmaMatrix", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ";", "\n", 
     RowBox[{"(*", 
      RowBox[{
      "get", " ", "the", " ", "drift", " ", "part", " ", "of", " ", "the", 
       " ", "result", " ", "produced", " ", "by", " ", 
       RowBox[{"Ito", "'"}], "s", " ", "lemma", " ", "and", " ", "use", " ", 
       "the", " ", "matrix", " ", "replacement", " ", "rule", " ", "to", " ", 
       "simplify"}], "*)"}], "\n", 
     RowBox[{"form", "=", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"Drift", "[", 
         RowBox[{"ItoD", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"x", ",", 
              RowBox[{"i", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", "u", "]"}], "*", 
           
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"x", ",", 
              RowBox[{"i", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", "u", "]"}]}], 
          "]"}], "]"}], "]"}], "/.", "matrixRules"}]}], ";", "\n", 
     RowBox[{"(*", 
      RowBox[{"integrate", " ", "the", " ", "dirft", " ", "term", " ", 
       RowBox[{"w", ".", "r", ".", "t"}], " ", "u", " ", "to", " ", "get", 
       " ", "the", " ", "expectation"}], "*)"}], "\n", 
     RowBox[{"result", "=", 
      RowBox[{"Integrate", "[", 
       RowBox[{"form", ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", 
          RowBox[{
           RowBox[{"Min", "[", "a", "]"}], "*", "t"}]}], "}"}], ",", 
        RowBox[{"Assumptions", "\[Rule]", 
         RowBox[{
          RowBox[{"t", ">", "0"}], "&&", 
          RowBox[{"Element", "[", 
           RowBox[{"a", ",", "Reals"}], "]"}], "&&", 
          RowBox[{"Element", "[", 
           RowBox[{"t", ",", "Reals"}], "]"}], "&&", 
          RowBox[{
           RowBox[{"Min", "[", "a", "]"}], "\[LessEqual]", "1"}]}]}]}], 
       "]"}]}], ";", "\n", 
     RowBox[{"{", 
      RowBox[{"result", ",", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{
         RowBox[{"i", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"i", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}]}], "\n", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.920102710306272*^9, 3.920102714508013*^9}, {
  3.92010297391667*^9, 3.9201029764197903`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"31c87814-7601-44d9-9596-016f99e18240"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example", "Section",
 CellChangeTimes->{{3.920102772475395*^9, 
  3.92010277366934*^9}},ExpressionUUID->"6ee757fb-375a-4949-a93e-\
ca8df22a9e40"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{"twoProductF", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", ",", "q"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Rho]", ",", "r"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"t", "-", "u"}], ")"}]}], ",", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"t", "-", "u"}], ")"}]}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.92010293589576*^9, 3.920102938302147*^9}, {
  3.920113300878097*^9, 3.920113302173716*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"e126293a-42ab-42e0-baf7-c152cc608aa7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     TemplateBox[{
       RowBox[{"p", ",", "q"}]},
      "KroneckerDeltaSeq"], " ", 
     RowBox[{"Min", "[", 
      RowBox[{"r", ",", "\[Rho]"}], "]"}]}], 
    RowBox[{"t", "-", 
     RowBox[{"t", " ", 
      RowBox[{"Min", "[", 
       RowBox[{"r", ",", "\[Rho]"}], "]"}]}]}]], ",", 
   TemplateBox[{
     RowBox[{"p", ",", "q"}]},
    "KroneckerDeltaSeq"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.920102941348952*^9, {3.920113287415038*^9, 3.920113303224772*^9}, 
   3.921737020688524*^9, 3.922463391232399*^9, 3.923643601389979*^9, 
   3.926469565375835*^9, 3.929455338487104*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"26a4fe4a-d676-475c-afdd-9e83fc6e9559"]
}, Open  ]],

Cell[TextData[{
 "The interpretation of the above example is: \n{p,q} are the two indices of \
the processes, i.e. ",
 Cell[BoxData[
  TemplateBox[<|"boxes" -> FormBox[
      RowBox[{
        StyleBox["d", "TI"], 
        SuperscriptBox[
         StyleBox["X", "TI"], 
         StyleBox["p", "TI"]], ",", 
        StyleBox["d", "TI"], 
        SuperscriptBox[
         StyleBox["X", "TI"], 
         StyleBox["q", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
    "dX^p,dX^q", "state" -> "Boxes"|>,
   "TeXAssistantTemplate"]],ExpressionUUID->
  "323aa35c-cd18-40ec-9097-d3b46af749db"],
 ". {a,b} are the two time horizon parameters. The drifts are both 0, the \
coefficients of \[Sigma]dB are both ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox["1", 
        RowBox[{
          StyleBox["t", "TI"], "-", 
          StyleBox["u", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\frac{1}{t-u}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1533f617-0856-40bd-9e1d-04463af92ea4"],
 ".\nThus, \n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{"\[Rho]", 
                    StyleBox["t", "TI"]}]], 
                 FractionBox[
                  SubsuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                   StyleBox["u", "TI"], 
                   StyleBox["p", "TI"]], 
                  RowBox[{
                    StyleBox["t", "TI"], "-", 
                    StyleBox["u", "TI"]}]]}], ")"}], "(", 
             RowBox[{
               SubsuperscriptBox["\[Integral]", "0", 
                RowBox[{
                  StyleBox["r", "TI"], 
                  StyleBox["t", "TI"]}]], 
               FractionBox[
                SubsuperscriptBox[
                 RowBox[{"(", 
                   RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                 StyleBox["u", "TI"], 
                 StyleBox["q", "TI"]], 
                RowBox[{
                  StyleBox["t", "TI"], "-", 
                  StyleBox["u", "TI"]}]]}], ")"}], "]"}], "\[LongEqual]", 
         FractionBox["1", 
          StyleBox["t", "TI"]], 
         RowBox[{"(", 
           FractionBox[
            RowBox[{"min", "(", 
              RowBox[{
                StyleBox["r", "TI"], ",", "\[Rho]"}], ")"}], 
            RowBox[{"1", "-", "min", 
              RowBox[{"(", 
                RowBox[{
                  StyleBox["r", "TI"], ",", "\[Rho]"}], ")"}]}]], ")"}], 
         SubscriptBox["\[Delta]", 
          RowBox[{
            StyleBox["p", "TI"], ",", 
            StyleBox["q", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\mathbb{E} [\\left(\\int_0^{\\rho t} \\frac{(\\sigma dB)^{p}_{u}}{t-u}\
\\right) \\left(\\int_0^{rt} \\frac{(\\sigma dB)^{q}_{u}}{t-u}\\right)] = \
\\frac{1}{t} \\left( \\frac{\\min(r,\\rho)}{1 - \\min(r,\\rho)} \\right) \
\\delta_{p,q}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7a8aa578-e414-428a-a0e7-efd6a7f10cfc"],
 "."
}], "Text",
 CellChangeTimes->{{3.908792302807341*^9, 3.908792351969808*^9}, {
  3.920102985528002*^9, 
  3.920103016260939*^9}},ExpressionUUID->"129a39b1-b6d0-43c3-8e44-\
8ce822890760"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two-Product Evaluation", "Subchapter",
 CellChangeTimes->{{3.9201143292564793`*^9, 
  3.920114329492181*^9}},ExpressionUUID->"2174cc1f-05cc-47e1-b11b-\
4b1055f9d751"],

Cell[TextData[{
 "The \[OpenCurlyDoubleQuote]twoProductFEval\[CloseCurlyDoubleQuote] function \
evaluates the associated symbolic two product expectation with definite \
integrals outside.\nAfter we find the symbolic expression of the expectation, \
we also need a function to do the evaluation of the form \n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox["\[Integral]", "0", 
          SubscriptBox[
           StyleBox["b", "TI"], "2"]], 
         SubsuperscriptBox["\[Integral]", "0", 
          SubscriptBox[
           StyleBox["b", "TI"], "1"]], 
         StyleBox["g", "TI"], 
         RowBox[{"(", 
           RowBox[{
             SubscriptBox["\[Theta]", "1"], ",", 
             SubscriptBox["\[Theta]", "2"]}], ")"}], "\[CenterDot]", 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"]}]], 
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["X", "TI"], 
                  StyleBox["u", "TI"], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "1"]]}], ")"}], "(", 
             RowBox[{
               SubsuperscriptBox["\[Integral]", "0", 
                RowBox[{
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "2"]}]], 
               StyleBox["d", "TI"], 
               SubsuperscriptBox[
                StyleBox["X", "TI"], 
                StyleBox["u", "TI"], 
                SubscriptBox[
                 StyleBox["i", "TI"], "2"]]}], ")"}], "]"}], 
         StyleBox["d", "TI"], 
         SubscriptBox["\[Theta]", "1"], 
         StyleBox["d", "TI"], 
         SubscriptBox["\[Theta]", "2"], "."}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\int_{0}^{b_{2}}\\int_{0}^{b_{1}}g(\\theta_{1},\\theta_{2})\\cdot\\\
mathbb{E}\\left[\\left(\\int_{0}^{ta_{1}}dX_{u}^{i_{1}}\\right)\\left(\\int_{\
0}^{ta_{2}}dX_{u}^{i_{2}}\\right)\\right]d\\theta_{1}d\\theta_{2}.", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "55014998-09e9-4329-ba65-7285722074a8"]
}], "Text",
 CellChangeTimes->{{3.908792489109664*^9, 3.9087925770708714`*^9}, {
  3.920104100707601*^9, 
  3.920104111769274*^9}},ExpressionUUID->"095c330e-b689-462e-82c6-\
90d2289ebeaa"],

Cell[CellGroupData[{

Cell["Inputs:", "Subsection",
 CellChangeTimes->{{3.908792597961729*^9, 
  3.908792606384485*^9}},ExpressionUUID->"60908d52-6695-41cc-8170-\
3a7f81b88db0"],

Cell[TextData[{
 "extraCoeff: the extra coefficient that may appear within the definite \
integral.\nexpression: the symbolic two product expectation expression.\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["b", "TI"], 
        StyleBox["i", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "b_i", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2c5f9472-181b-4d94-b25b-6dd59d00df65"],
 ": the integral range with respect to different integrators. They are in the \
form of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "low", ",", "up"}], "}"}], TraditionalForm],
      "errors" -> {}, "input" -> "\\{\\theta, \\text{low},\\text{up}\\}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b1302e82-a366-46ce-be22-66d5fa521f59"],
 ", meaning that ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox["\[Integral]", "low", "up"], 
         StyleBox["d", "TI"], "\[Theta]"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\int_{\\text{low}}^{\\text{up}} d\\theta", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c4823480-5a65-42a6-8a3d-044ebe326d2b"],
 "."
}], "Text",
 CellChangeTimes->{{3.908792614688281*^9, 3.908792730072709*^9}, {
  3.908792772395747*^9, 3.908792788563555*^9}, {3.908793268010736*^9, 
  3.908793282516283*^9}, {3.920103586125745*^9, 
  3.92010361874126*^9}},ExpressionUUID->"48bbcabc-f1da-4af3-80c3-\
0b0b539c2999"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Outputs:", "Subsection",
 CellChangeTimes->{{3.908792795963331*^9, 
  3.908792802290245*^9}},ExpressionUUID->"e65690b3-70f9-4cdd-8f31-\
b02302663cd4"],

Cell["Evaluation result in terms of Kronecker deltas.", "Text",
 CellChangeTimes->{{3.908792840213625*^9, 
  3.908792862464415*^9}},ExpressionUUID->"5a022667-9513-4f5e-86b3-\
eca66cb7ddfe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"twoProductFEval", "[", "\[IndentingNewLine]", 
   RowBox[{
   "extraCoeff_", ",", "\[IndentingNewLine]", "expression_", ",", 
    "\[IndentingNewLine]", "b1_", ",", "\[IndentingNewLine]", "b2_", ",", 
    "\[IndentingNewLine]", "b3_", ",", "\[IndentingNewLine]", "b4_"}], "]"}], 
  ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{"Integrate", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"extraCoeff", "*", 
          RowBox[{"Coefficient", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"expression", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"expression", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}],
          "\[IndentingNewLine]", ",", "b1", ",", "b2", ",", "b3", ",", "b4"}],
         "\[IndentingNewLine]", "]"}], "*", 
       RowBox[{"expression", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\n", "result"}]}], "\n", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.908792423564345*^9, 3.908792471520737*^9}, {
  3.9201054299346223`*^9, 3.920105436224573*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"5efc7cbd-c1b0-42ec-896a-48da319b850f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example", "Section",
 CellChangeTimes->{{3.920113295408712*^9, 
  3.920113296853511*^9}},ExpressionUUID->"b7f7cf0e-98f0-44f4-836c-\
47a729f75860"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"twoProductFEval", "[", "\[IndentingNewLine]", 
  RowBox[{"1", ",", "\[IndentingNewLine]", "test", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"\[Rho]", ",", "0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"r", ",", "0", ",", "\[Rho]"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "1"}], "}"}], 
   RowBox[{"(*", "dummy", "*)"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], 
  RowBox[{"(*", "dummy", "*)"}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.920113308674662*^9, 3.9201133951564817`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"90445e2f-35bb-4b62-b8f2-6b406624d08c"],

Cell[BoxData[
 FractionBox[
  TemplateBox[{
    RowBox[{"p", ",", "q"}]},
   "KroneckerDeltaSeq"], 
  RowBox[{"2", " ", "t"}]]], "Output",
 CellChangeTimes->{3.920113399328793*^9, 3.921737021663322*^9, 
  3.922463392321356*^9, 3.923643602311767*^9, 3.926469566317957*^9, 
  3.929455339442243*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"09b45ba4-c5fb-4d5f-bb09-6f5472d5ed2f"]
}, Open  ]],

Cell[TextData[{
 "The example means:\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox["\[Integral]", "0", "1"], 
         SubsuperscriptBox["\[Integral]", "0", "\[Rho]"], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{"\[Rho]", 
                    StyleBox["t", "TI"]}]], 
                 FractionBox[
                  SubsuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                   StyleBox["u", "TI"], 
                   StyleBox["p", "TI"]], 
                  RowBox[{
                    StyleBox["t", "TI"], "-", 
                    StyleBox["u", "TI"]}]]}], ")"}], "(", 
             RowBox[{
               SubsuperscriptBox["\[Integral]", "0", 
                RowBox[{
                  StyleBox["r", "TI"], 
                  StyleBox["t", "TI"]}]], 
               FractionBox[
                SubsuperscriptBox[
                 RowBox[{"(", 
                   RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                 StyleBox["u", "TI"], 
                 StyleBox["q", "TI"]], 
                RowBox[{
                  StyleBox["t", "TI"], "-", 
                  StyleBox["u", "TI"]}]]}], ")"}], "]"}], 
         StyleBox["d", "TI"], 
         StyleBox["r", "TI"], 
         StyleBox["d", "TI"], "\[Rho]", "\[LongEqual]", 
         FractionBox[
          SubscriptBox["\[Delta]", 
           RowBox[{
             StyleBox["p", "TI"], ",", 
             StyleBox["q", "TI"]}]], 
          RowBox[{"2", 
            StyleBox["t", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\int_0^1 \\int_0^{\\rho} \\mathbb{E} [\\left(\\int_0^{\\rho t} \
\\frac{(\\sigma dB)^{p}_{u}}{t-u}\\right) \\left(\\int_0^{rt} \\frac{(\\sigma \
dB)^{q}_{u}}{t-u}\\right)]  dr d\\rho = \\frac{\\delta_{p,q}}{2t}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ac01958c-4702-42e0-ac91-29cda256fb36"],
 "."
}], "Text",
 CellChangeTimes->{{3.920113428819482*^9, 3.92011343891098*^9}, 
   3.92011360440868*^9, 
   3.929457507617432*^9},ExpressionUUID->"93072ec0-7d6a-4670-857e-\
111c16b9bdcf"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Improved Three-Product Case", "Chapter",
 CellChangeTimes->{{3.92011722497959*^9, 3.920117230510028*^9}, {
  3.922432983990007*^9, 3.922432985595828*^9}, {3.929457963234812*^9, 
  3.929457964718083*^9}},ExpressionUUID->"a17ac781-a991-4a1e-a7ee-\
8bc635ef7515"],

Cell[CellGroupData[{

Cell["Three-Product Expectation Expression. ", "Subchapter",
 CellChangeTimes->{
  3.908792896815689*^9, 3.920103911046843*^9, {3.920114346634385*^9, 
   3.9201143513682413`*^9}},ExpressionUUID->"d52f0ffc-6ed8-4c1b-9032-\
bbec44b6fb00"],

Cell[TextData[{
 "The function \[OpenCurlyQuote]threeProductFImproved\[CloseCurlyQuote]  \
finds the symbolic expression of\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"]}]], 
                 SubscriptBox[
                  StyleBox["C", "TI"], "1"], 
                 SubsuperscriptBox[
                  RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                  StyleBox["u", "TI"], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "1"]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "2"]}]], 
                 SubscriptBox[
                  StyleBox["C", "TI"], "2"], 
                 SubsuperscriptBox[
                  RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                  StyleBox["u", "TI"], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "2"]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "3"]}]], "\[CapitalXi]", 
                 RowBox[{"(", 
                   RowBox[{
                    StyleBox["u", "TI"], ";", 
                    SubscriptBox[
                    StyleBox["i", "TI"], "4"]}], ")"}], 
                 SubsuperscriptBox[
                  RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                  StyleBox["u", "TI"], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "3"]]}], ")"}]}], "]"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\mathbb{E}\\left[\\left(\\int_{0}^{ta_{1}}C_{1}(\\sigma \
dB)_{u}^{i_{1}}\\right)\\left(\\int_{0}^{ta_{2}}C_{2}(\\sigma dB)_{u}^{i_{2}}\
\\right)\\left(\\int_{0}^{ta_{3}}\\Xi(u;i_{4})(\\sigma \
dB)_{u}^{i_{3}}\\right)\\right]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "27775488-3d18-40c5-b85b-3b513995b7a1"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalXi]", "(", 
         RowBox[{
           StyleBox["u", "TI"], ";", 
           SubscriptBox[
            StyleBox["i", "TI"], "4"]}], ")"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\Xi(u;i_4)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6495c0e4-9157-48fd-955b-c8454af9f65f"],
 " is another stochastic integral with an expandable integrand (or Lebesgue \
integral of stochastic integral with expandable integrands), and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], 
          StyleBox["i", "TI"]], "\[Element]", 
         RowBox[{"{", 
           RowBox[{"1", ",", 
             FractionBox["1", 
              RowBox[{
                StyleBox["t", "TI"], "-", 
                StyleBox["u", "TI"]}]]}], "}"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "C_i \\in \\{1,\\frac{1}{t-u}\\}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3233c031-fada-4e09-a9c7-965984aa1b7d"],
 ".\n\nDenote\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox[
          StyleBox["X", "TI"], 
          StyleBox["s", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "1"]], ":", "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["s", "TI"]], 
         SubscriptBox[
          StyleBox["C", "TI"], "1"], 
         SubsuperscriptBox[
          RowBox[{"(", 
            RowBox[{"\[Sigma]", 
              StyleBox["d", "TI"], 
              StyleBox["B", "TI"]}], ")"}], 
          StyleBox["u", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "1"]], ",  ", 
         SubsuperscriptBox[
          StyleBox["Y", "TI"], 
          StyleBox["s", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "2"]], ":", "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["s", "TI"]], 
         SubscriptBox[
          StyleBox["C", "TI"], "2"], 
         SubsuperscriptBox[
          RowBox[{"(", 
            RowBox[{"\[Sigma]", 
              StyleBox["d", "TI"], 
              StyleBox["B", "TI"]}], ")"}], 
          StyleBox["u", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "2"]], ",  ", 
         SubsuperscriptBox[
          StyleBox["Z", "TI"], 
          StyleBox["s", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "3"]], ":", "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["s", "TI"]], "\[CapitalXi]", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["u", "TI"], ";", 
             SubscriptBox[
              StyleBox["i", "TI"], "4"]}], ")"}], 
         SubsuperscriptBox[
          RowBox[{"(", 
            RowBox[{"\[Sigma]", 
              StyleBox["d", "TI"], 
              StyleBox["B", "TI"]}], ")"}], 
          StyleBox["u", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "3"]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "X_{s}^{i_{1}}:=\\int_{0}^{s}C_{1}(\\sigma dB)_{u}^{i_{1}},\\quad \
Y_{s}^{i_{2}}:=\\int_{0}^{s}C_{2}(\\sigma dB)_{u}^{i_{2}},\\quad \
Z_{s}^{i_{3}}:=\\int_{0}^{s}\\Xi(u;i_{4})(\\sigma dB)_{u}^{i_{3}}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "10d2031f-2520-4465-b728-a3abf6bfb2e1"],
 ".\nDenote ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Alpha]", ":", "\[LongEqual]", "max", 
         RowBox[{"(", 
           RowBox[{
             SubscriptBox[
              StyleBox["a", "TI"], "1"], ",", 
             SubscriptBox[
              StyleBox["a", "TI"], "2"], ",", 
             SubscriptBox[
              StyleBox["a", "TI"], "3"]}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\alpha:=\\max(a_{1},a_{2},a_{3})", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "46d96afa-118f-4400-90e8-f59484babc56"],
 ", and extend the three processes onto the interval ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"[", 
         RowBox[{"0", ",", 
           StyleBox["t", "TI"], "\[Alpha]"}], "]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "[0,t\\alpha]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4ecdf02d-7ef9-464b-8a1d-8570b7f81221"],
 ", such that for any ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["s", "TI"], "\[Element]", 
         RowBox[{"[", 
           RowBox[{"0", ",", 
             StyleBox["t", "TI"], "\[Alpha]"}], "]"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "s \\in [0,t\\alpha]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0e38ed1e-009f-4877-972c-8bfef0d6e5b8"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox[
          StyleBox["X", "TI"], 
          StyleBox["s", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "1"]], "\[LongEqual]", 
         RowBox[{"(", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              StyleBox["s", "TI"]], 
             SubscriptBox[
              StyleBox["C", "TI"], "1"], 
             SubsuperscriptBox[
              RowBox[{"(", 
                RowBox[{"\[Sigma]", 
                  StyleBox["d", "TI"], 
                  StyleBox["B", "TI"]}], ")"}], 
              StyleBox["u", "TI"], 
              SubscriptBox[
               StyleBox["i", "TI"], "1"]]}], ")"}], 
         SubscriptBox["1", 
          RowBox[{"{", 
            RowBox[{"0", "\[LessEqual]", 
              StyleBox["s", "TI"], "\[LessEqual]", 
              StyleBox["t", "TI"], 
              SubscriptBox[
               StyleBox["a", "TI"], "1"]}], "}"}]], "+", 
         RowBox[{"(", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{
                StyleBox["t", "TI"], 
                SubscriptBox[
                 StyleBox["a", "TI"], "1"]}]], 
             SubscriptBox[
              StyleBox["C", "TI"], "1"], 
             SubsuperscriptBox[
              RowBox[{"(", 
                RowBox[{"\[Sigma]", 
                  StyleBox["d", "TI"], 
                  StyleBox["B", "TI"]}], ")"}], 
              StyleBox["u", "TI"], 
              SubscriptBox[
               StyleBox["i", "TI"], "1"]]}], ")"}], 
         SubscriptBox["1", 
          RowBox[{"{", 
            RowBox[{
              StyleBox["t", "TI"], 
              SubscriptBox[
               StyleBox["a", "TI"], "1"], "\[LessEqual]", 
              StyleBox["s", "TI"], "\[LessEqual]", 
              StyleBox["t", "TI"], "\[Alpha]"}], "}"}]], "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              StyleBox["s", "TI"], ",", 
              StyleBox["t", "TI"], 
              SubscriptBox[
               StyleBox["a", "TI"], "1"]}], ")"}]], 
         SubscriptBox[
          StyleBox["C", "TI"], "1"], 
         SubsuperscriptBox[
          RowBox[{"(", 
            RowBox[{"\[Sigma]", 
              StyleBox["d", "TI"], 
              StyleBox["B", "TI"]}], ")"}], 
          StyleBox["u", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "1"]], "\[LongEqual]", 
         SubsuperscriptBox[
          StyleBox["X", "TI"], 
          RowBox[{"min", "(", 
            RowBox[{
              StyleBox["s", "TI"], ",", 
              StyleBox["t", "TI"], 
              SubscriptBox[
               StyleBox["a", "TI"], "1"]}], ")"}], 
          SubscriptBox[
           StyleBox["i", "TI"], "1"]], ","}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "X_{s}^{i_{1}}=(\\int_{0}^{s} C_1 (\\sigma dB)_{u}^{i_{1}})\\bm{1}_{\\{0\
\\leq s\\leq ta_{1}\\}}+(\\int_{0}^{ta_{1}} C_1 (\\sigma \
dB)_{u}^{i_{1}})\\bm{1}_{\\{ta_{1}\\leq s\\leq \
t\\alpha\\}}=\\int_{0}^{\\min(s,ta_{1})}C_1 (\\sigma \
dB)_{u}^{i_{1}}=X_{\\min(s,ta_{1})}^{i_{1}},", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "56fe9819-78e7-44de-a7b5-94d1e09b1c06"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["d", "TI"], 
         SubscriptBox[
          StyleBox["X", "TI"], 
          StyleBox["s", "TI"]], "\[LongEqual]", 
         RowBox[{"(", 
           RowBox[{
             SubscriptBox[
              StyleBox["C", "TI"], "1"], 
             SubsuperscriptBox[
              RowBox[{"(", 
                RowBox[{"\[Sigma]", 
                  StyleBox["d", "TI"], 
                  StyleBox["B", "TI"]}], ")"}], 
              StyleBox["s", "TI"], 
              SubscriptBox[
               StyleBox["i", "TI"], "1"]]}], ")"}], 
         SubscriptBox["1", 
          RowBox[{"0", "\[LessEqual]", 
            StyleBox["s", "TI"], "\[LessEqual]", 
            StyleBox["t", "TI"], 
            SubscriptBox[
             StyleBox["a", "TI"], "1"]}]]}], TraditionalForm], "errors" -> {},
      "input" -> 
     "dX_s = (C_1 (\\sigma dB)_s^{i_1}) \\bm{1}_{0 \\leq s \\leq t a_1}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6a4acdb4-3036-4a34-81d0-61ba46ee72d3"],
 ".\nSame for ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["Y", "TI"], TraditionalForm], "errors" -> {}, "input" -> "Y", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0229c7fe-6ed4-4775-b983-2fe3921c8eb6"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["Z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "Z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c24209a3-3f4c-4eb0-adef-69bdeb396533"],
 ". \n\nThen by Ito\[CloseCurlyQuote]s lemma, the term we want to evaluate \
can be rewritten as\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{
                StyleBox["t", "TI"], "\[Alpha]"}]], 
             StyleBox["d", "TI"], 
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox[
                  StyleBox["X", "TI"], 
                  StyleBox["s", "TI"], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "1"]], 
                 SubsuperscriptBox[
                  StyleBox["Y", "TI"], 
                  StyleBox["s", "TI"], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "2"]], 
                 SubsuperscriptBox[
                  StyleBox["Z", "TI"], 
                  StyleBox["s", "TI"], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "3"]]}], ")"}]}], "]"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\mathbb{E}\\left[\\int_{0}^{t\\alpha}d(X_{s}^{i_{1}}Y_{s}^{i_{2}}Z_{s}^\
{i_{3}})\\right]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5c5f08bb-a424-41c5-adf5-9a9ad36f191b"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{
                StyleBox["t", "TI"], "\[Alpha]"}]], 
             StyleBox["d", "TI"], 
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox[
                  StyleBox["X", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "1"]], 
                 SubsuperscriptBox[
                  StyleBox["Y", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "2"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "2"]], 
                 SubsuperscriptBox[
                  StyleBox["Z", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "3"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "3"]]}], ")"}]}], "]"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "=\\mathbb{E}\\left[\\int_{0}^{t\\alpha}d\\left(X_{\\min(s,ta_{1})}^{i_{\
1}}Y_{\\min(s,ta_{2})}^{i_{2}}Z_{\\min(s,ta_{3})}^{i_{3}}\\right)\\right]", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "99f58e43-70b2-4f81-be2d-59bc8ca0ccb9"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{
                StyleBox["t", "TI"], "\[Alpha]"}]], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["X", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "1"]]}], ")"}], 
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "2"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["Z", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "3"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "3"]]}], ")"}]}], "]"}], "+", 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{
                StyleBox["t", "TI"], "\[Alpha]"}]], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "1"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "1"]], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["Y", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "2"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "2"]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["Z", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "3"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "3"]]}], ")"}]}], "]"}], "+", 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{
                StyleBox["t", "TI"], "\[Alpha]"}]], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["X", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "1"]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["Y", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "2"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "2"]]}], ")"}], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]]}], "]"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "=\\mathbb{E}\\left[\\int_{0}^{t\\alpha}(dX_{\\min(s,ta_{1})}^{i_{1}})Y_{\
\\min(s,ta_{2})}^{i_{2}}(dZ_{\\min(s,ta_{3})}^{i_{3}})\\right]+\\mathbb{E}\\\
left[\\int_{0}^{t\\alpha}X_{\\min(s,ta_{1})}^{i_{1}}(dY_{\\min(s,ta_{2})}^{i_{\
2}})(dZ_{\\min(s,ta_{3})}^{i_{3}})\\right]+\\mathbb{E}\\left[\\int_{0}^{t\\\
alpha}(dX_{\\min(s,ta_{1})}^{i_{1}})(dY_{\\min(s,ta_{2})}^{i_{2}})Z_{\\min(s,\
ta_{3})}^{i_{3}}\\right]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7b171513-f752-4953-b7aa-e29ab9258202"],
 ".\nNotice the last term is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["0", TraditionalForm], "errors" -> {}, "input" -> "0", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "51268728-a861-4e5e-bf40-17711aae52d4"],
 ". Thus we have\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "3"]}]], "\[CenterDot]", 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "1"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}]], 
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "2"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], 
             RowBox[{"{", 
               SubscriptBox[
                StyleBox["C", "TI"], "1"], "}"}], "\[CapitalXi]", 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["s", "TI"], ";", 
                 SubscriptBox[
                  StyleBox["i", "TI"], "4"]}], ")"}], 
             StyleBox["d", "TI"], 
             StyleBox["s", "TI"]}], "]"}], "+", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "2"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "3"]}]], "\[CenterDot]", 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "2"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}]], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "1"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "1"]], 
             RowBox[{"{", 
               SubscriptBox[
                StyleBox["C", "TI"], "2"], "}"}], "\[CapitalXi]", 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["s", "TI"], ";", 
                 SubscriptBox[
                  StyleBox["i", "TI"], "4"]}], ")"}], 
             StyleBox["d", "TI"], 
             StyleBox["s", "TI"]}], "]"}]}], TraditionalForm], "errors" -> {},
      "input" -> 
     "=\\delta_{i_{1},i_{3}}\\cdot\\mathbb{E}\\left[\\int_{0}^{\\min(ta_{1},\
ta_{3})}Y_{\\min(s,ta_{2})}^{i_{2}}\\{C_{1}\\}\\Xi(s;i_{4})ds\\right]+\\delta_\
{i_{2},i_{3}}\\cdot\\mathbb{E}\\left[\\int_{0}^{\\min(ta_{2},ta_{3})}X_{\\min(\
s,ta_{1})}^{i_{1}}\\{C_{2}\\}\\Xi(s;i_{4})ds\\right]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5b368610-1d73-45cf-a667-862ef83786e4"],
 ".\n\nHere, since we now use ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["s", "TI"], TraditionalForm], "errors" -> {}, "input" -> "s", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6ead3155-8949-42ee-b0f2-6cac81593b5f"],
 " to denote the time, the parameter ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["u", "TI"], TraditionalForm], "errors" -> {}, "input" -> "u", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6d55faf7-fb55-4ac7-baff-d4a6728dde32"],
 " in ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["C", "TI"], 
        StyleBox["i", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "C_i", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "96e3f060-d119-4728-9b4c-b7cdffc9fbe1"],
 " will also be changed to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["s", "TI"], TraditionalForm], "errors" -> {}, "input" -> "s", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "95be71e5-4638-4a3c-91d8-29d19762718a"],
 ". However, we want to avoid keep changing notations to denote the same form \
with different time parameters. \n",
 StyleBox["So throughout the notebook, we will use the notation ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         SubscriptBox[
          StyleBox["C", "TI"], 
          StyleBox["i", "TI"]], "}"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\{C_i\\}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"ee51549b-83a2-427f-afd5-002f09aec230"],
 StyleBox[" to mean the form of ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["C", "TI"], 
        StyleBox["i", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "C_i", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"bd9fa53f-2795-4447-872d-1ea60c9ac837"],
 StyleBox[" but under some change of variable of ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["u", "TI"], TraditionalForm], "errors" -> {}, "input" -> "u", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"a40773de-71dc-40d6-983c-ecffdf06e897"],
 StyleBox[", depending on what the new parameter is.",
  FontWeight->"Bold"],
 " \nActually in all our cases, it will be in accordance with the time \
integrator. For instance, if we are integrating with respect to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Xi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1a9a0690-4fa9-48ab-bafa-aba87599b966"],
 ", then ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         SubscriptBox[
          StyleBox["C", "TI"], 
          StyleBox["i", "TI"]], "}"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\{C_i\\}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b0fae2c5-b1c2-4cc3-989e-31d50f0ef88c"],
 " means either ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["1", TraditionalForm], "errors" -> {}, "input" -> "1", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "db20bc97-2d2e-4442-9529-0b199ac7b42b"],
 " or ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox["1", 
        RowBox[{
          StyleBox["t", "TI"], "-", "\[Xi]"}]], TraditionalForm], 
     "errors" -> {}, "input" -> "\\frac{1}{t-\\xi}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "21b2a514-01d6-47ed-a09d-d090964b6ba4"],
 ".\n\nLet\[CloseCurlyQuote]s call the first term in the summation \
\[OpenCurlyQuote]",
 StyleBox["term 1",
  FontVariations->{"Underline"->True}],
 "\[CloseCurlyQuote], and the latter term \[OpenCurlyQuote]",
 StyleBox["term2",
  FontVariations->{"Underline"->True}],
 "\[CloseCurlyQuote].\nFor term 1,\nCondition 1: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "1"], "\[LongEqual]", "1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "C_1=1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6d0cdd42-0286-4033-b39b-2bec3ac969ef"],
 ". We apply change of variable, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["s", "TI"], "\[LongEqual]", 
         StyleBox["t", "TI"], 
         StyleBox["z", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "s=tz", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2380842b-d556-46cf-8b13-d2933bd65e52"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "3"]}]], "\[CenterDot]", 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "1"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}]], 
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "2"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], 
             RowBox[{"{", 
               SubscriptBox[
                StyleBox["C", "TI"], "1"], "}"}], "\[CapitalXi]", 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["s", "TI"], ";", 
                 SubscriptBox[
                  StyleBox["i", "TI"], "4"]}], ")"}], 
             StyleBox["d", "TI"], 
             StyleBox["s", "TI"]}], "]"}], "\[LongEqual]", 
         StyleBox["t", "TI"], "\[CenterDot]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "3"]}]], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "1"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "3"]}], ")"}]], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["z", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "2"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], "\[CapitalXi]", 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["t", "TI"], 
                 StyleBox["z", "TI"], ";", 
                 SubscriptBox[
                  StyleBox["i", "TI"], "4"]}], ")"}]}], "]"}], 
         StyleBox["d", "TI"], 
         StyleBox["z", "TI"], "."}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\delta_{i_{1},i_{3}}\\cdot\\mathbb{E}\\left[\\int_{0}^{\\min(ta_{1},ta_\
{3})}Y_{\\min(s,ta_{2})}^{i_{2}} \
\\{C_{1}\\}\\Xi(s;i_{4})ds\\right]=t\\cdot\\delta_{i_{1},i_{3}}\\cdot\\int_{0}\
^{\\min(a_{1},a_{3})}\\mathbb{E}\\left[Y_{t\\min(z,a_{2})}^{i_{2}}\\Xi(tz;i_{\
4})\\right]dz.", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e3b08eed-cdf7-47e4-bfcc-ec47f3dd96d9"],
 "\nCondition 2: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "1"], "\[LongEqual]", 
         FractionBox["1", 
          RowBox[{
            StyleBox["t", "TI"], "-", 
            StyleBox["u", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "C_1=\\frac{1}{t-u}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2d214e28-f184-4b36-bf87-075f13cefad5"],
 ". We apply change of variable, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["s", "TI"], "\[LongEqual]", 
         StyleBox["t", "TI"], 
         StyleBox["z", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "s=tz", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "94938f3f-3614-4169-a6ac-6726d725a4ee"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "3"]}]], "\[CenterDot]", 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "1"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}]], 
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "2"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], 
             RowBox[{"{", 
               SubscriptBox[
                StyleBox["C", "TI"], "1"], "}"}], "\[CapitalXi]", 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["s", "TI"], ";", 
                 SubscriptBox[
                  StyleBox["i", "TI"], "4"]}], ")"}], 
             StyleBox["d", "TI"], 
             StyleBox["s", "TI"]}], "]"}], "\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "3"]}]], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "1"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "3"]}], ")"}]], 
         FractionBox["1", 
          RowBox[{"1", "-", 
            StyleBox["z", "TI"]}]], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["z", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "2"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], "\[CapitalXi]", 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["t", "TI"], 
                 StyleBox["z", "TI"], ";", 
                 SubscriptBox[
                  StyleBox["i", "TI"], "4"]}], ")"}]}], "]"}], 
         StyleBox["d", "TI"], 
         StyleBox["z", "TI"], "."}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\delta_{i_{1},i_{3}}\\cdot\\mathbb{E}\\left[\\int_{0}^{\\min(ta_{1},ta_\
{3})}Y_{\\min(s,ta_{2})}^{i_{2}} \\{C_{1}\\} \
\\Xi(s;i_{4})ds\\right]=\\delta_{i_{1},i_{3}}\\cdot\\int_{0}^{\\min(a_{1},a_{\
3})}\\frac{1}{1-z}\\mathbb{E}\\left[Y_{t\\min(z,a_{2})}^{i_{2}}\\Xi(tz;i_{4})\
\\right]dz.", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "33e21db1-9349-41cf-b017-f714d62d0782"],
 "\n\nFor term 2,\nCondition 1: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "2"], "\[LongEqual]", "1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "C_2=1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9fcbc96b-91cf-4d9d-b21a-d0b8cf8625ae"],
 ". We apply change of variable, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["s", "TI"], "\[LongEqual]", 
         StyleBox["t", "TI"], 
         StyleBox["z", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "s=tz", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "95ca932c-f340-45e1-b431-a5f58812061e"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "2"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "3"]}]], "\[CenterDot]", 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "2"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}]], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "1"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "1"]], 
             RowBox[{"{", 
               SubscriptBox[
                StyleBox["C", "TI"], "2"], "}"}], "\[CapitalXi]", 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["s", "TI"], ";", 
                 SubscriptBox[
                  StyleBox["i", "TI"], "4"]}], ")"}], 
             StyleBox["d", "TI"], 
             StyleBox["s", "TI"]}], "]"}], "\[LongEqual]", 
         StyleBox["t", "TI"], "\[CenterDot]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "2"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "3"]}]], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "2"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "3"]}], ")"}]], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["z", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "1"]], "\[CapitalXi]", 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["t", "TI"], 
                 StyleBox["z", "TI"], ";", 
                 SubscriptBox[
                  StyleBox["i", "TI"], "4"]}], ")"}]}], "]"}], 
         StyleBox["d", "TI"], 
         StyleBox["z", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\delta_{i_{2},i_{3}}\\cdot\\mathbb{E}\\left[\\int_{0}^{\\min(ta_{2},ta_\
{3})}X_{\\min(s,ta_{1})}^{i_{1}} \\{C_{2}\\} \
\\Xi(s;i_{4})ds\\right]=t\\cdot\\delta_{i_{2},i_{3}}\\cdot\\int_{0}^{\\min(a_{\
2},a_{3})}\\mathbb{E}\\left[X_{t\\min(z,a_{1})}^{i_{1}}\\Xi(tz;i_{4})\\right]\
dz", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a093a460-51e9-4334-9253-c60aaf489891"],
 ".\nCondition 2: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "2"], "\[LongEqual]", 
         FractionBox["1", 
          RowBox[{
            StyleBox["t", "TI"], "-", 
            StyleBox["u", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "C_2=\\frac{1}{t-u}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "919b4824-eee5-4efa-bf46-4a19379f6b40"],
 ". We apply change of variable, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["s", "TI"], "\[LongEqual]", 
         StyleBox["t", "TI"], 
         StyleBox["z", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "s=tz", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "184337c8-80f7-4c42-930a-ce8a7806320f"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "2"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "3"]}]], "\[CenterDot]", 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "2"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}]], 
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "1"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "1"]], 
             RowBox[{"{", 
               SubscriptBox[
                StyleBox["C", "TI"], "2"], "}"}], "\[CapitalXi]", 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["s", "TI"], ";", 
                 SubscriptBox[
                  StyleBox["i", "TI"], "4"]}], ")"}], 
             StyleBox["d", "TI"], 
             StyleBox["s", "TI"]}], "]"}], "\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "2"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "3"]}]], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "2"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "3"]}], ")"}]], 
         FractionBox["1", 
          RowBox[{"1", "-", 
            StyleBox["z", "TI"]}]], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["X", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["z", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "1"]], "\[CapitalXi]", 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["t", "TI"], 
                 StyleBox["z", "TI"], ";", 
                 SubscriptBox[
                  StyleBox["i", "TI"], "4"]}], ")"}]}], "]"}], 
         StyleBox["d", "TI"], 
         StyleBox["z", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\delta_{i_{2},i_{3}}\\cdot\\mathbb{E}\\left[\\int_{0}^{\\min(ta_{2},ta_\
{3})}X_{\\min(s,ta_{1})}^{i_{1}} \\{C_{2}\\} \
\\Xi(s;i_{4})ds\\right]=\\delta_{i_{2},i_{3}}\\cdot\\int_{0}^{\\min(a_{2},a_{\
3})}\\frac{1}{1-z}\\mathbb{E}\\left[X_{t\\min(z,a_{1})}^{i_{1}}\\Xi(tz;i_{4})\
\\right]dz", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "dbad2387-2373-4b48-bf86-3a2925fbaf14"],
 ".\n\nThere are also the situation where the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "14a79ca0-3bbb-4906-9daa-1907c7af0202"],
 " is a Lebesgue integral of an expandable expression. The general idea will \
be the same, except that we need  a further change of variable. \n\nFor \
example, if we have\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalXi]", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["t", "TI"], 
             StyleBox["z", "TI"], ";", 
             SubscriptBox[
              StyleBox["i", "TI"], "4"]}], ")"}], "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{
            StyleBox["t", "TI"], 
            StyleBox["z", "TI"]}]], 
         FractionBox[
          SubsuperscriptBox[
           StyleBox["W", "TI"], 
           StyleBox["u", "TI"], 
           SubscriptBox[
            StyleBox["i", "TI"], "4"]], 
          RowBox[{
            StyleBox["t", "TI"], "-", 
            StyleBox["u", "TI"]}]], 
         StyleBox["d", "TI"], 
         StyleBox["u", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\Xi(tz;i_4) = \\int_0^{tz} \\frac{W_{u}^{i_{4}}}{t-u}du", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d7288c43-540f-4897-b012-64f4b3972d0c"],
 ", and we know the expansion ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          SubsuperscriptBox[
           StyleBox["W", "TI"], 
           RowBox[{
             StyleBox["t", "TI"], 
             StyleBox["r", "TI"]}], 
           SubscriptBox[
            StyleBox["i", "TI"], "4"]], 
          RowBox[{"1", "-", 
            StyleBox["r", "TI"]}]], 
         OverscriptBox["\[LongEqual]", "."], 
         StyleBox["t", "TI"], 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{
            StyleBox["t", "TI"], 
            StyleBox["r", "TI"]}]], 
         FractionBox[
          SubsuperscriptBox[
           RowBox[{"(", 
             RowBox[{"\[Sigma]", 
               StyleBox["d", "TI"], 
               StyleBox["B", "TI"]}], ")"}], 
           StyleBox["u", "TI"], 
           SubscriptBox[
            StyleBox["i", "TI"], "4"]], 
          RowBox[{
            StyleBox["t", "TI"], "-", 
            StyleBox["u", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\frac{W_{tr}^{i_{4}}}{1-r}\\dot{=} t \\int_0^{tr} \\frac{(\\sigma \
dB)^{i_4}_u}{t-u}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b4a44db0-b3d0-45f7-95f7-e3bb95ab1917"],
 ",\nthus we can apply the change of variable ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["u", "TI"], "\[LongEqual]", 
         StyleBox["t", "TI"], "\[Xi]"}], TraditionalForm], "errors" -> {}, 
     "input" -> "u=t\\xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2cd4549a-7862-433e-bed3-6acd555042ce"],
 " to get,\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["z", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "2"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], "\[CapitalXi]", 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["t", "TI"], 
                 StyleBox["z", "TI"], ";", 
                 SubscriptBox[
                  StyleBox["i", "TI"], "4"]}], ")"}]}], "]"}], "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["z", "TI"]], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["z", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "2"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], "(", 
             RowBox[{
               StyleBox["t", "TI"], "\[CenterDot]", 
               SubsuperscriptBox["\[Integral]", "0", 
                RowBox[{
                  StyleBox["t", "TI"], "\[Xi]"}]], 
               FractionBox[
                SubsuperscriptBox[
                 RowBox[{"(", 
                   RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                 StyleBox["u", "TI"], 
                 SubscriptBox[
                  StyleBox["i", "TI"], "4"]], 
                RowBox[{
                  StyleBox["t", "TI"], "-", 
                  StyleBox["u", "TI"]}]]}], ")"}], "]"}], 
         StyleBox["d", "TI"], "\[Xi]"}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\mathbb{E}\\left[Y_{t\\min(z,a_{2})}^{i_{2}}\\Xi(tz;i_{4})\\right]=\\\
int_{0}^{z}\\mathbb{E}\\left[Y_{t\\min(z,a_{2})}^{i_{2}}\\left(t\\cdot\\int_{\
0}^{t\\xi}\\frac{(\\sigma dB)_{u}^{i_{4}}}{t-u}\\right)\\right]d\\xi", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9a04c0e7-845c-422b-92be-f82401edff7e"],
 ".\nWe would capture this feature as well in the program.\n\nNotice that in \
all the conditions, we finally reduce to the case of finding the expectation \
of two-product. Hence, we can apply the \[OpenCurlyQuote]twoProductF\
\[CloseCurlyQuote] function.\n\n",
 StyleBox["The most important part of the code is that, the letter ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"956ae7ef-d212-4214-9de9-f78f2d6accf1"],
 StyleBox[" is reserved for calculating the improved three product case. \nSo \
when calculating expectation of this kind, we\[CloseCurlyQuote]d better NOT \
occupy ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"dbd2f14d-a315-4bea-aa71-02f1272b8b82"],
 StyleBox[" for other purposes. \n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Also, if ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"a754688b-cb83-45ee-b5f0-8a15a588e8c8"],
 StyleBox[" has Lebesgue integral, then we reserve the greek letter ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Xi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"f8e16246-3dd6-4854-a55d-70fa9a1121d0"],
 StyleBox[" to make the further change of variable. \nThis means we\
\[CloseCurlyQuote]d better NOT occupy ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Xi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"b71eea7b-ee7f-4b14-b529-2f5bb6d73f80"],
 StyleBox[" for other purposes,",
  FontWeight->"Bold"],
 " and it MIGHT BE the case that the term C[[4]] contains ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Xi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "64630410-db2e-4b27-b9cd-f65d543acd44"],
 ", depending on whether the expansion contains ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Xi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5acba266-1f70-4574-b22c-da63357a6526"],
 " or not.\n\n We will clarify what should be the inputs in every case."
}], "Text",
 CellChangeTimes->{{3.908792905722393*^9, 3.908793081693388*^9}, {
   3.920104390973352*^9, 3.920104683374362*^9}, {3.920105014278719*^9, 
   3.920105015416443*^9}, {3.92010509232134*^9, 3.9201051144363413`*^9}, {
   3.920105159213551*^9, 3.920105160182004*^9}, {3.920105205040223*^9, 
   3.920105281314348*^9}, {3.920105332222679*^9, 3.920105370128395*^9}, {
   3.920105530055176*^9, 3.920105798937458*^9}, {3.920105884847866*^9, 
   3.920105934549655*^9}, {3.920105981964267*^9, 3.920106078220288*^9}, {
   3.920106135543714*^9, 3.920106222188196*^9}, {3.920106588515644*^9, 
   3.920106644715933*^9}, {3.92010669346618*^9, 3.920106697063197*^9}, {
   3.9201067667806892`*^9, 3.920106773951953*^9}, {3.92010687716241*^9, 
   3.920106885277199*^9}, {3.920106971448875*^9, 3.920107036478231*^9}, {
   3.920107204671729*^9, 3.920107221074318*^9}, {3.920107267445703*^9, 
   3.920107322973054*^9}, 3.92010746339722*^9, {3.920107514014539*^9, 
   3.92010751654674*^9}, {3.920107577492477*^9, 3.920107588795897*^9}, {
   3.920114119189557*^9, 3.920114145327618*^9}, {3.920114456650453*^9, 
   3.920114460363257*^9}, {3.92011546956673*^9, 3.9201157037268257`*^9}, {
   3.920116771283618*^9, 3.920116788546542*^9}, {3.920116926206842*^9, 
   3.920116976980115*^9}, {3.920571228173759*^9, 3.920571282720131*^9}, {
   3.920616882346113*^9, 3.920616975014722*^9}, {3.920617235292411*^9, 
   3.920617239139578*^9}, {3.920618407704278*^9, 3.920618512015802*^9}, {
   3.9206188507271013`*^9, 3.9206188897394247`*^9}, {3.920618956786683*^9, 
   3.9206193657672253`*^9}, {3.920619434320518*^9, 3.920619477594899*^9}, {
   3.9294574562251863`*^9, 3.929457469310011*^9}, {3.929457584063857*^9, 
   3.929457606377397*^9}},ExpressionUUID->"0a98f787-b6db-48f3-9944-\
0ca70e126739"],

Cell[CellGroupData[{

Cell["Inputs:", "Subsection",
 CellChangeTimes->{{3.908793093705957*^9, 
  3.908793095991942*^9}},ExpressionUUID->"6bfe10c5-a46b-40be-8bd6-\
c1b78a13fcc3"],

Cell[TextData[{
 "XiLebesgue: boolean valued, whether ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e6df2263-5732-4cfe-8a0d-3039b27614bc"],
 " contains Lebesgue integral, .\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["i", "TI"], TraditionalForm], "errors" -> {}, "input" -> "i", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a8ff9d54-b36b-4734-99dc-0a0b203ab603"],
 ": list valued, length 4, stands for the index list ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{
           SubscriptBox[
            StyleBox["i", "TI"], "1"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "2"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "3"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "4"]}], "}"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\{i_{1},i_{2},i_{3},i_{4}\\}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "21198554-3d98-4b84-916d-ac303fe870de"],
 ". ",
 StyleBox["In particular, ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["i", "TI"], "3"], TraditionalForm], "errors" -> {}, "input" -> 
     "i_{3}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "86ce3c2d-2916-4116-b81b-27c137d43e95"],
 StyleBox[" must be the index of ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["Z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "Z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ce031c3f-76da-4b28-b08d-b097e5198d79"],
 StyleBox[", and the ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["i", "TI"], "4"], TraditionalForm], "errors" -> {}, "input" -> 
     "i_{4}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6e8c48ae-9bcf-44d9-a808-fb08bb3a8bc0"],
 StyleBox[" must be the index of ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "bfafa1db-f930-407a-88f2-48fcbdc48755"],
 StyleBox[".",
  FontWeight->"Bold"],
 "\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["a", "TI"], TraditionalForm], "errors" -> {}, "input" -> "a", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7d07875b-d826-44e8-b802-62953241e019"],
 ": list valued, length 3, stands for the time horizon parameters ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{
           SubscriptBox[
            StyleBox["a", "TI"], "1"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "2"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "3"]}], "}"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\{a_{1},a_{2},a_{3}\\}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "80f6828a-632c-4363-9f85-4f7f2d471f61"],
 " of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["X", "TI"], ",", 
         StyleBox["Y", "TI"], ",", 
         StyleBox["Z", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "X,Y,Z", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6a426da6-c733-443c-a937-1d58d585f210"],
 ". \n\ndrift: list valued, length 4, stands for the drift terms of the \
stochastic integrals. They are actually all {0,0,0,0} throughout the \
document.\n\nC: list valued, length 4, stands for the coefficient term in \
front of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubsuperscriptBox[
        RowBox[{"(", 
          RowBox[{"\[Sigma]", 
            StyleBox["d", "TI"], 
            StyleBox["B", "TI"]}], ")"}], 
        StyleBox["u", "TI"], 
        StyleBox["i", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "(\\sigma dB)_{u}^{i}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "37c40443-acb5-47c4-ba74-d547ab860f67"],
 ". ",
 "In particular, ",
 StyleBox["C[[3]] should always be 1 ",
  FontWeight->"Bold"],
 "since we treat ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Plain",ExpressionUUID->
  "3a5f2044-21e2-4c3b-b3d6-6bf8acabdf2e"],
 " as a special coefficient itself. ",
 StyleBox["And C[[4]] should be the coefficient including the whole \
expression of the expansion ",
  FontWeight->"Bold"],
 "(e.g. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox[
        StyleBox["t", "TI"], 
        RowBox[{
          StyleBox["t", "TI"], "-", 
          StyleBox["u", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\frac{t}{t-u}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c81999aa-ff91-4613-be7e-ae2afbb0d908"],
 " for the example we raised above). \nThere are two situations according to \
our calculation above.\n(a) If ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[<|
     "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
      "input" -> "\\Xi", "state" -> "Boxes"|>,
     "TeXAssistantTemplate"], " "}], TraditionalForm]],ExpressionUUID->
  "48c082cd-1180-41be-b4c3-620c4aa995e3"],
 " does not contain Lebesgue integral, then C[[4]] would be parameterized by \
z.\n(b) If ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4296dc0b-4f9a-47f6-85c3-34d4b2ff29a4"],
 " has Lebesgue integral, then C[[4]] would be parametrized by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Xi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2b4266a3-f70b-4be1-b009-83210e6c24da"],
 "."
}], "Text",
 CellChangeTimes->{{3.908793108333156*^9, 3.908793115147652*^9}, {
  3.908793177404052*^9, 3.908793254476025*^9}, {3.908793294352064*^9, 
  3.908793465934662*^9}, {3.920107652070717*^9, 3.920107676568076*^9}, {
  3.920107711994501*^9, 3.920107768161249*^9}, {3.920116754498739*^9, 
  3.920116754950733*^9}, {3.9206169797478523`*^9, 3.920617120635228*^9}, {
  3.920617151280139*^9, 3.920617153014461*^9}, {3.920617209525255*^9, 
  3.92061722486852*^9}, {3.920617275694996*^9, 3.920617311504023*^9}, {
  3.920620197532376*^9, 
  3.92062020026984*^9}},ExpressionUUID->"0248316e-4572-41bd-9dc1-\
2f82dc63be4c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Outputs:", "Subsection",
 CellChangeTimes->{{3.908793485333561*^9, 
  3.9087934938036957`*^9}},ExpressionUUID->"4a284143-1269-4524-9df3-\
57938f9dcc79"],

Cell[TextData[{
 "1. If ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "78ed13ba-a948-4905-8e5c-d90ab0af29fa"],
 " does not contain Lebesgue integral, then it is of the form of a length 2 \
list, where each term is also a list as: \n{\n\tterm1 = {term1 integrand \
expression, integral range w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c3d4e40d-e960-4df4-98c3-bc0a0fe56264"],
 ", Kronecker delta term in term1},\n\tterm2 = {term2 integrand expression, \
integral range w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8a7445b3-b98e-4809-a693-68934f61c327"],
 ", Kronecker delta term in term2}\n}\n\n2. If ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a104b2f8-27a6-4e4d-b360-954393e41285"],
 " has Lebesgue integral, then it is of the form of a length 2 list, where \
each term is also a list as:\n{\n\tterm1 = {term1 integrand  expression, \
integral range w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a2108101-f395-45fe-9d0c-8502c51bbb4f"],
 ", integral range w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Xi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "101dad5f-dc69-4c41-a09b-1d8727541cfa"],
 ", Kronecker delta term in term1},\n\tterm2 = {term2 integrand expression, \
integral range w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "825dd44f-ccc2-454e-b73a-458afdceeb13"],
 ", integral range w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Xi]", ","}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\xi,", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "63477389-3629-45a7-a773-3fa242c95ec7"],
 " Kronecker delta term in term2}\n}.\n\nWe include the Kronecker delta term \
in the output purely for the purpose of convenience. As we have mentioned at \
the beginning of the notebook, we can regard them as basis for all \
expressions, and including them in the output helps us extracting the \
coefficients easily."
}], "Text",
 CellChangeTimes->{{3.908793496560704*^9, 3.908793577059038*^9}, {
  3.920107891131576*^9, 3.920107908867217*^9}, {3.920117096327059*^9, 
  3.92011709874692*^9}, {3.920617318788237*^9, 3.920617432311311*^9}, {
  3.920617490822301*^9, 
  3.920617747138186*^9}},ExpressionUUID->"9c7264c6-d6d0-4590-984e-\
235e67436ebc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"threeProductFImproved", "[", "\n", 
   RowBox[{
   "XiLebesgue_", ",", "\n", "i_", ",", "\n", "a_", ",", "\n", "drift_", ",", 
    "\n", "C_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"If", " ", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"XiLebesgue", "==", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"C", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "===", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"form1", "=", 
            RowBox[{
             RowBox[{"KroneckerDelta", "[", 
              RowBox[{
               RowBox[{"i", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"i", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
             RowBox[{"twoProductF", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Min", "[", 
                  RowBox[{"z", ",", 
                   RowBox[{"a", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "z"}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"drift", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"drift", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"C", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"C", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], 
              "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"term1", "=", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"t", "*", 
               RowBox[{"form1", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
              
              RowBox[{"{", 
               RowBox[{"z", ",", "0", ",", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"a", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"KroneckerDelta", "[", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
               RowBox[{"KroneckerDelta", "[", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Else", " ", "if", " ", 
             RowBox[{"C", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "==", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"t", "-", "u"}], ")"}]}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"form1", "=", 
            RowBox[{
             RowBox[{"KroneckerDelta", "[", 
              RowBox[{
               RowBox[{"i", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"i", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
             RowBox[{"twoProductF", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Min", "[", 
                  RowBox[{"z", ",", 
                   RowBox[{"a", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "z"}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"drift", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"drift", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"C", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"C", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], 
              "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"term1", "=", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "z"}], ")"}]}], "*", 
               RowBox[{"form1", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
              
              RowBox[{"{", 
               RowBox[{"z", ",", "0", ",", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"a", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"KroneckerDelta", "[", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
               RowBox[{"KroneckerDelta", "[", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"C", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "===", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"form2", "=", 
            RowBox[{
             RowBox[{"KroneckerDelta", "[", 
              RowBox[{
               RowBox[{"i", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"i", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
             RowBox[{"twoProductF", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Min", "[", 
                  RowBox[{"z", ",", 
                   RowBox[{"a", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "z"}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"drift", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"drift", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"C", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"C", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], 
              "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"term2", "=", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"t", "*", 
               RowBox[{"form2", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
              
              RowBox[{"{", 
               RowBox[{"z", ",", "0", ",", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"a", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"KroneckerDelta", "[", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
               RowBox[{"KroneckerDelta", "[", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Else", " ", "if", " ", 
             RowBox[{"C", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "==", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"t", "-", "u"}], ")"}]}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"form2", "=", 
            RowBox[{
             RowBox[{"KroneckerDelta", "[", 
              RowBox[{
               RowBox[{"i", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"i", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
             RowBox[{"twoProductF", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Min", "[", 
                  RowBox[{"z", ",", 
                   RowBox[{"a", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "z"}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"drift", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"drift", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"C", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"C", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], 
              "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"term2", "=", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "z"}], ")"}]}], "*", 
               RowBox[{"form2", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
              
              RowBox[{"{", 
               RowBox[{"z", ",", "0", ",", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"a", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"KroneckerDelta", "[", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
               RowBox[{"KroneckerDelta", "[", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Else", " ", "if", " ", "XiLebesgue"}], "==", "True"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"C", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "===", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"form1", "=", 
            RowBox[{
             RowBox[{"KroneckerDelta", "[", 
              RowBox[{
               RowBox[{"i", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"i", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
             RowBox[{"twoProductF", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Min", "[", 
                  RowBox[{"z", ",", 
                   RowBox[{"a", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "\[Xi]"}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"drift", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"drift", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"C", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"C", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], 
              "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"term1", "=", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"t", "*", 
               RowBox[{"form1", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
              
              RowBox[{"{", 
               RowBox[{"z", ",", "0", ",", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"a", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\[Xi]", ",", "0", ",", "z"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"KroneckerDelta", "[", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
               RowBox[{"KroneckerDelta", "[", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Else", " ", "if", " ", 
             RowBox[{"C", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "==", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"t", "-", "u"}], ")"}]}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"form1", "=", 
            RowBox[{
             RowBox[{"KroneckerDelta", "[", 
              RowBox[{
               RowBox[{"i", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"i", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
             RowBox[{"twoProductF", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Min", "[", 
                  RowBox[{"z", ",", 
                   RowBox[{"a", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "\[Xi]"}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"drift", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"drift", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"C", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"C", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"term1", "=", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "z"}], ")"}]}], "*", 
               RowBox[{"form1", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
              
              RowBox[{"{", 
               RowBox[{"z", ",", "0", ",", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"a", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\[Xi]", ",", "0", ",", "z"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"KroneckerDelta", "[", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
               RowBox[{"KroneckerDelta", "[", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"C", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "===", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"form2", "=", 
            RowBox[{
             RowBox[{"KroneckerDelta", "[", 
              RowBox[{
               RowBox[{"i", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"i", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
             RowBox[{"twoProductF", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Min", "[", 
                  RowBox[{"z", ",", 
                   RowBox[{"a", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "\[Xi]"}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"drift", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"drift", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"C", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"C", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"term2", "=", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"t", "*", 
               RowBox[{"form2", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
              
              RowBox[{"{", 
               RowBox[{"z", ",", "0", ",", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"a", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\[Xi]", ",", "0", ",", "z"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"KroneckerDelta", "[", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
               RowBox[{"KroneckerDelta", "[", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Else", " ", "if", " ", 
             RowBox[{"C", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "==", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"t", "-", "u"}], ")"}]}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"form2", "=", 
            RowBox[{
             RowBox[{"KroneckerDelta", "[", 
              RowBox[{
               RowBox[{"i", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"i", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
             RowBox[{"twoProductF", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Min", "[", 
                  RowBox[{"z", ",", 
                   RowBox[{"a", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "\[Xi]"}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"drift", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"drift", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"C", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"C", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"term2", "=", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "z"}], ")"}]}], "*", 
               RowBox[{"form2", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
              
              RowBox[{"{", 
               RowBox[{"z", ",", "0", ",", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"a", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\[Xi]", ",", "0", ",", "z"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"KroneckerDelta", "[", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
               RowBox[{"KroneckerDelta", "[", 
                RowBox[{
                 RowBox[{"i", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\n", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"{", 
       RowBox[{"term1", ",", "term2"}], "}"}]}], ";", "\[IndentingNewLine]", 
     "result"}]}], "\n", "]"}]}]], "Input",
 CellChangeTimes->{{3.9087936034251423`*^9, 3.908794058198784*^9}},
 CellLabel->"In[32]:=",
 CloudRendering -> 
 "InteractiveBoxes",ExpressionUUID->"d856de01-7aac-4f2d-b25c-92d6176c8c6a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example", "Section",
 CellChangeTimes->{{3.908794129022295*^9, 3.9087941295273952`*^9}, {
  3.9201079345490007`*^9, 
  3.920107936045307*^9}},ExpressionUUID->"d675b39d-6c12-4427-ae0e-\
cd34cb2aa084"],

Cell[TextData[{
 "Say we want to find the symbolic expression of\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], "\[Delta]"}]], 
                 FractionBox[
                  SubsuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                   StyleBox["u", "TI"], 
                   StyleBox["p", "TI"]], 
                  RowBox[{
                    StyleBox["t", "TI"], "-", 
                    StyleBox["u", "TI"]}]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], "\[Rho]"}]], 
                 FractionBox[
                  SubsuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                   StyleBox["u", "TI"], 
                   StyleBox["j", "TI"]], 
                  RowBox[{
                    StyleBox["t", "TI"], "-", 
                    StyleBox["u", "TI"]}]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], "\[Rho]"}]], 
                 RowBox[{"(", 
                   RowBox[{
                    SubsuperscriptBox["\[Integral]", "0", 
                    StyleBox["u", "TI"]], 
                    FractionBox[
                    SubsuperscriptBox[
                    StyleBox["W", "TI"], 
                    StyleBox["v", "TI"], 
                    StyleBox["k", "TI"]], 
                    RowBox[{
                    StyleBox["t", "TI"], "-", 
                    StyleBox["v", "TI"]}]], 
                    StyleBox["d", "TI"], 
                    StyleBox["v", "TI"]}], ")"}], 
                 SubsuperscriptBox[
                  RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                  StyleBox["u", "TI"], 
                  StyleBox["l", "TI"]]}], ")"}]}], "]"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\mathbb{E}[\\left(\\int_{0}^{t \\delta} \\frac{(\\sigma \
dB)_{u}^{p}}{t-u}\\right)\\left(\\int_{0}^{t \\rho}\\frac{(\\sigma \
dB)_{u}^{j}}{t-u}\\right)\\left(\\int_{0}^{t \
\\rho}(\\int_{0}^{u}\\frac{W_{v}^{k}}{t-v}dv)(\\sigma dB)_{u}^{l}\\right)]", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5d063a49-c3c7-49a6-9eb2-8005454b8c65"],
 "."
}], "Text",
 CellChangeTimes->{{3.929457724370072*^9, 
  3.929457734226239*^9}},ExpressionUUID->"ea5a8cb5-96cc-4654-b431-\
4a2c74543def"],

Cell["Then we need the following code.", "Text",
 CellChangeTimes->{{3.929457757989935*^9, 
  3.929457771370461*^9}},ExpressionUUID->"b7f49a90-ec5c-42a0-acee-\
9f07617d4901"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{"threeProductFImproved", "[", "\[IndentingNewLine]", 
   RowBox[{"True", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"p", ",", "j", ",", "l", ",", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"\[Delta]", ",", "\[Rho]", ",", "\[Rho]"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"t", "-", "u"}], ")"}]}], ",", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"t", "-", "u"}], ")"}]}], ",", "1", ",", 
      RowBox[{"t", "/", 
       RowBox[{"(", 
        RowBox[{"t", "-", "u"}], ")"}]}]}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.908794112467678*^9, 3.908794113206943*^9}, {
  3.920107942922111*^9, 3.920107951354908*^9}, {3.920108412737798*^9, 
  3.920108412862226*^9}, {3.929457738788992*^9, 3.929457743626749*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"919dcf02-4f34-4be9-a8af-6a515b79ff6d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       TemplateBox[{
         RowBox[{"j", ",", "k"}]},
        "KroneckerDeltaSeq"], " ", 
       TemplateBox[{
         RowBox[{"l", ",", "p"}]},
        "KroneckerDeltaSeq"], " ", 
       RowBox[{"Min", "[", 
        RowBox[{"z", ",", "\[Xi]", ",", "\[Rho]"}], "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "z"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Min", "[", 
          RowBox[{"z", ",", "\[Xi]", ",", "\[Rho]"}], "]"}]}], ")"}]}]], ",", 
     
     RowBox[{"{", 
      RowBox[{"z", ",", "0", ",", 
       RowBox[{"Min", "[", 
        RowBox[{"\[Delta]", ",", "\[Rho]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Xi]", ",", "0", ",", "z"}], "}"}], ",", 
     RowBox[{
      TemplateBox[{
        RowBox[{"j", ",", "k"}]},
       "KroneckerDeltaSeq"], " ", 
      TemplateBox[{
        RowBox[{"l", ",", "p"}]},
       "KroneckerDeltaSeq"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       TemplateBox[{
         RowBox[{"j", ",", "l"}]},
        "KroneckerDeltaSeq"], " ", 
       TemplateBox[{
         RowBox[{"k", ",", "p"}]},
        "KroneckerDeltaSeq"], " ", 
       RowBox[{"Min", "[", 
        RowBox[{"z", ",", "\[Delta]", ",", "\[Xi]"}], "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "z"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Min", "[", 
          RowBox[{"z", ",", "\[Delta]", ",", "\[Xi]"}], "]"}]}], ")"}]}]], 
     ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "0", ",", "\[Rho]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Xi]", ",", "0", ",", "z"}], "}"}], ",", 
     RowBox[{
      TemplateBox[{
        RowBox[{"j", ",", "l"}]},
       "KroneckerDeltaSeq"], " ", 
      TemplateBox[{
        RowBox[{"k", ",", "p"}]},
       "KroneckerDeltaSeq"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.920107955595877*^9, 3.92010813307213*^9, 
  3.920108414582361*^9, 3.920113624393417*^9, 3.921737023475884*^9, 
  3.922463394770941*^9, 3.923643603649465*^9, 3.926469568114127*^9, 
  3.929455341233069*^9, 3.92945774711786*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"5ee32e5e-4117-4a71-ad27-86dab402131f"]
}, Open  ]],

Cell[TextData[{
 "The ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "07cec1ce-fe2b-4773-b163-a467c6c6fb2e"],
 " here contains the Lebesgue integral, so XiLebesgue==True.\nWe know that ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          SubsuperscriptBox[
           StyleBox["W", "TI"], 
           RowBox[{
             StyleBox["t", "TI"], 
             StyleBox["r", "TI"]}], 
           SubscriptBox[
            StyleBox["i", "TI"], "4"]], 
          RowBox[{"1", "-", 
            StyleBox["r", "TI"]}]], 
         OverscriptBox["\[LongEqual]", "."], 
         StyleBox["t", "TI"], 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{
            StyleBox["t", "TI"], 
            StyleBox["r", "TI"]}]], 
         FractionBox[
          SubsuperscriptBox[
           RowBox[{"(", 
             RowBox[{"\[Sigma]", 
               StyleBox["d", "TI"], 
               StyleBox["B", "TI"]}], ")"}], 
           StyleBox["u", "TI"], 
           SubscriptBox[
            StyleBox["i", "TI"], "4"]], 
          RowBox[{
            StyleBox["t", "TI"], "-", 
            StyleBox["u", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\frac{W_{tr}^{i_{4}}}{1-r}\\dot{=} t \\int_0^{tr} \\frac{(\\sigma \
dB)^{i_4}_u}{t-u}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "308e0d87-6483-49b3-a9d8-461710c3c1e7"],
 ", therefore ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "4"], "\[LongEqual]", 
         FractionBox[
          StyleBox["t", "TI"], 
          RowBox[{
            StyleBox["t", "TI"], "-", 
            StyleBox["u", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "C_4=\\frac{t}{t-u}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "092dec42-eedb-4d2b-a8f8-1af996776d1a"],
 ".\nThe code gives the result which can be interpreted as\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], "\[Delta]"}]], 
                 FractionBox[
                  SubsuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                   StyleBox["u", "TI"], 
                   StyleBox["p", "TI"]], 
                  RowBox[{
                    StyleBox["t", "TI"], "-", 
                    StyleBox["u", "TI"]}]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], "\[Rho]"}]], 
                 FractionBox[
                  SubsuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                   StyleBox["u", "TI"], 
                   StyleBox["j", "TI"]], 
                  RowBox[{
                    StyleBox["t", "TI"], "-", 
                    StyleBox["u", "TI"]}]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], "\[Rho]"}]], 
                 RowBox[{"(", 
                   RowBox[{
                    SubsuperscriptBox["\[Integral]", "0", 
                    StyleBox["u", "TI"]], 
                    FractionBox[
                    SubsuperscriptBox[
                    StyleBox["W", "TI"], 
                    StyleBox["v", "TI"], 
                    StyleBox["k", "TI"]], 
                    RowBox[{
                    StyleBox["t", "TI"], "-", 
                    StyleBox["v", "TI"]}]], 
                    StyleBox["d", "TI"], 
                    StyleBox["v", "TI"]}], ")"}], 
                 SubsuperscriptBox[
                  RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                  StyleBox["u", "TI"], 
                  StyleBox["l", "TI"]]}], ")"}]}], "]"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\mathbb{E}[\\left(\\int_{0}^{t \\delta} \\frac{(\\sigma \
dB)_{u}^{p}}{t-u}\\right)\\left(\\int_{0}^{t \\rho}\\frac{(\\sigma \
dB)_{u}^{j}}{t-u}\\right)\\left(\\int_{0}^{t \
\\rho}(\\int_{0}^{u}\\frac{W_{v}^{k}}{t-v}dv)(\\sigma dB)_{u}^{l}\\right)]", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "399f4e0c-b162-416b-837d-878c0f378bb4"],
 "=",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Delta]", 
          RowBox[{
            StyleBox["j", "TI"], ",", 
            StyleBox["k", "TI"]}]], 
         SubscriptBox["\[Delta]", 
          RowBox[{
            StyleBox["l", "TI"], ",", 
            StyleBox["p", "TI"]}]], 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{"\[Delta]", ",", "\[Rho]"}], ")"}]], 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["z", "TI"]], 
         FractionBox[
          RowBox[{"min", "(", 
            RowBox[{
              StyleBox["z", "TI"], ",", "\[Xi]", ",", "\[Rho]"}], ")"}], 
          RowBox[{
            RowBox[{"(", 
              RowBox[{"1", "-", 
                StyleBox["z", "TI"]}], ")"}], "(", 
            RowBox[{"1", "-", "min", 
              RowBox[{"(", 
                RowBox[{
                  StyleBox["z", "TI"], ",", "\[Xi]", ",", "\[Rho]"}], ")"}]}],
             ")"}]], 
         StyleBox["d", "TI"], "\[Xi]", 
         StyleBox["d", "TI"], 
         StyleBox["z", "TI"], "+", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            StyleBox["j", "TI"], ",", 
            StyleBox["l", "TI"]}]], 
         SubscriptBox["\[Delta]", 
          RowBox[{
            StyleBox["k", "TI"], ",", 
            StyleBox["p", "TI"]}]], 
         SubsuperscriptBox["\[Integral]", "0", "\[Rho]"], 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["z", "TI"]], 
         FractionBox[
          RowBox[{"min", "(", 
            RowBox[{
              StyleBox["z", "TI"], ",", "\[Delta]", ",", "\[Xi]"}], ")"}], 
          RowBox[{
            RowBox[{"(", 
              RowBox[{"1", "-", 
                StyleBox["z", "TI"]}], ")"}], "(", 
            RowBox[{"1", "-", "min", 
              RowBox[{"(", 
                RowBox[{
                  StyleBox["z", "TI"], ",", "\[Delta]", ",", "\[Xi]"}], 
                ")"}]}], ")"}]], 
         StyleBox["d", "TI"], "\[Xi]", 
         StyleBox["d", "TI"], 
         StyleBox["z", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\delta_{j,k}\\delta_{l,p} \\int_0^{\\min(\\delta,\\rho)} \\int_0^{z} \
\\frac{\\min(z,\\xi,\\rho)}{(1-z)(1-\\min(z,\\xi,\\rho))} d\\xi dz + \
\\delta_{j,l}\\delta_{k,p} \\int_0^{\\rho} \\int_0^{z} \
\\frac{\\min(z,\\delta,\\xi)}{(1-z)(1-\\min(z,\\delta,\\xi))} d\\xi dz", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7d145821-9b93-4455-8fb3-b8c31998c96d"],
 "."
}], "Text",
 CellChangeTimes->{{3.920107969922015*^9, 3.920108001397234*^9}, 
   3.920108370232723*^9, {3.920108544607098*^9, 3.920108660755835*^9}, 
   3.9201089192622557`*^9, {3.920619525640646*^9, 3.920619540757162*^9}, {
   3.929457685602684*^9, 3.9294577196431627`*^9}, 
   3.929457781946114*^9},ExpressionUUID->"2b32bfa5-1f1e-4940-965a-\
39017ede9d03"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Three-Product Evaluation", "Subchapter",
 CellChangeTimes->{{3.920114358346078*^9, 
  3.92011436207229*^9}},ExpressionUUID->"5207fd74-ae97-4fa1-837a-\
e32dfa006f9b"],

Cell["\<\
The logic follows exactly as the two product evaluation. The only difference \
is that depending on the XiLebesgue is True or not, the output from \
\[OpenCurlyQuote]threeProdutFImproved\[CloseCurlyQuote] takes different form. \
\>", "Text",
 CellChangeTimes->{{3.908794172444685*^9, 3.908794189376658*^9}, {
   3.920108940632691*^9, 3.9201091038757277`*^9}, 
   3.920619562760482*^9},ExpressionUUID->"f587a9c2-ec5b-49fa-a027-\
bb6a256dce2e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"threeProductFImprovedEval", "[", "\[IndentingNewLine]", 
   RowBox[{
   "XiLebesgue_", ",", "\[IndentingNewLine]", "extraCoeff_", ",", 
    "\[IndentingNewLine]", "expression_", ",", "\[IndentingNewLine]", "b1_", 
    ",", "\[IndentingNewLine]", "b2_", ",", "\[IndentingNewLine]", "b3_", ",",
     "\[IndentingNewLine]", "b4_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"result", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"XiLebesgue", "==", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Total", "[", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Integrate", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"extraCoeff", "*", 
               RowBox[{"Coefficient", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"expression", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"expression", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "\[IndentingNewLine]", 
                "]"}]}], "\[IndentingNewLine]", ",", "b1", ",", "b2", ",", 
              "b3", ",", "b4", ",", 
              RowBox[{
               RowBox[{"expression", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"expression", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}],
             "*", 
            RowBox[{
             RowBox[{"expression", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "2"}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Else", " ", "if", " ", "Xilebesgue"}], "==", "False"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Total", "[", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Integrate", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"extraCoeff", "*", 
               RowBox[{"Coefficient", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"expression", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"expression", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "\[IndentingNewLine]", 
                "]"}]}], "\[IndentingNewLine]", ",", "b1", ",", "b2", ",", 
              "b3", ",", "b4", ",", 
              RowBox[{
               RowBox[{"expression", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}],
             "*", 
            RowBox[{
             RowBox[{"expression", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "2"}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.908794197675648*^9, 3.908794260666281*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"1d730cd9-aae4-4aaa-a961-28964d39286d"],

Cell[CellGroupData[{

Cell["Example", "Section",
 CellChangeTimes->{{3.9201136315697603`*^9, 
  3.920113632624114*^9}},ExpressionUUID->"15154530-0edb-442e-a06b-\
494f90db3d66"],

Cell["\<\
Say we want to evaluate the expression we obtained in the previous example. \
Then we need the following code.\
\>", "Text",
 CellChangeTimes->{{3.929457847041313*^9, 
  3.929457896548193*^9}},ExpressionUUID->"95cec26c-b572-4731-a335-\
f0bfe04c1486"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"threeProductFImprovedEval", "[", "\[IndentingNewLine]", 
  RowBox[{
  "True", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", "test",
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"\[Rho]", ",", "0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"\[Delta]", ",", "0", ",", "\[Rho]"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"(*", "dummy", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], 
  RowBox[{"(*", "dummy", "*)"}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.920113674827094*^9, 3.920113730368941*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"6df981a9-81ef-4cac-a6a7-349c49cd5e4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["5", "24"], " ", 
   TemplateBox[{
     RowBox[{"j", ",", "l"}]},
    "KroneckerDeltaSeq"], " ", 
   TemplateBox[{
     RowBox[{"k", ",", "p"}]},
    "KroneckerDeltaSeq"]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", 
   TemplateBox[{
     RowBox[{"j", ",", "k"}]},
    "KroneckerDeltaSeq"], " ", 
   TemplateBox[{
     RowBox[{"l", ",", "p"}]},
    "KroneckerDeltaSeq"]}]}]], "Output",
 CellChangeTimes->{3.920113748934194*^9, 3.921737039333949*^9, 
  3.922463412888786*^9, 3.923643617875332*^9, 3.926469583649102*^9, 
  3.9294553569664097`*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"94828532-418c-4acf-9e55-8f46ad001d7b"]
}, Open  ]],

Cell[TextData[{
 "The example means\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox["\[Integral]", "0", "1"], 
         SubsuperscriptBox["\[Integral]", "0", "\[Rho]"], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], "\[Delta]"}]], 
                 FractionBox[
                  SubsuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                   StyleBox["u", "TI"], 
                   StyleBox["p", "TI"]], 
                  RowBox[{
                    StyleBox["t", "TI"], "-", 
                    StyleBox["u", "TI"]}]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], "\[Rho]"}]], 
                 FractionBox[
                  SubsuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                   StyleBox["u", "TI"], 
                   StyleBox["j", "TI"]], 
                  RowBox[{
                    StyleBox["t", "TI"], "-", 
                    StyleBox["u", "TI"]}]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], "\[Rho]"}]], 
                 RowBox[{"(", 
                   RowBox[{
                    SubsuperscriptBox["\[Integral]", "0", 
                    StyleBox["u", "TI"]], 
                    FractionBox[
                    SubsuperscriptBox[
                    StyleBox["W", "TI"], 
                    StyleBox["v", "TI"], 
                    StyleBox["k", "TI"]], 
                    RowBox[{
                    StyleBox["t", "TI"], "-", 
                    StyleBox["v", "TI"]}]], 
                    StyleBox["d", "TI"], 
                    StyleBox["v", "TI"]}], ")"}], 
                 SubsuperscriptBox[
                  RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                  StyleBox["u", "TI"], 
                  StyleBox["l", "TI"]]}], ")"}]}], "]"}], 
         StyleBox["d", "TI"], "\[Delta]", 
         StyleBox["d", "TI"], "\[Rho]", "\[LongEqual]", 
         FractionBox["5", "24"], 
         SubscriptBox["\[Delta]", 
          RowBox[{
            StyleBox["j", "TI"], ",", 
            StyleBox["l", "TI"]}]], 
         SubscriptBox["\[Delta]", 
          RowBox[{
            StyleBox["k", "TI"], ",", 
            StyleBox["p", "TI"]}]], "+", 
         FractionBox["1", "24"], 
         SubscriptBox["\[Delta]", 
          RowBox[{
            StyleBox["j", "TI"], ",", 
            StyleBox["k", "TI"]}]], 
         SubscriptBox["\[Delta]", 
          RowBox[{
            StyleBox["l", "TI"], ",", 
            StyleBox["p", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\int_0^1 \\int_0^{\\rho} \\mathbb{E}[\\left(\\int_{0}^{t \\delta} \
\\frac{(\\sigma dB)_{u}^{p}}{t-u}\\right)\\left(\\int_{0}^{t \
\\rho}\\frac{(\\sigma dB)_{u}^{j}}{t-u}\\right)\\left(\\int_{0}^{t \
\\rho}(\\int_{0}^{u}\\frac{W_{v}^{k}}{t-v}dv)(\\sigma dB)_{u}^{l}\\right)]  d\
\\delta d\\rho = \\frac{5}{24} \\delta_{j,l} \\delta_{k,p} + \\frac{1}{24} \
\\delta_{j,k} \\delta_{l,p}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4291e8c9-2ae3-42a5-8e38-95dd2d3a9cb0"],
 "."
}], "Text",
 CellChangeTimes->{{3.92011381571423*^9, 3.920113822452367*^9}, 
   3.920113979382336*^9},ExpressionUUID->"3cd8052b-2141-435d-8308-\
29167449dda7"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Four-Product Case", "Chapter",
 CellChangeTimes->{{3.9201172413525257`*^9, 3.920117243266871*^9}, {
  3.9294579557985897`*^9, 
  3.929457958793127*^9}},ExpressionUUID->"d82f19be-d0ff-44b1-9202-\
4a96e5e5021e"],

Cell[CellGroupData[{

Cell["Four-Product Expectation Expression", "Subchapter",
 CellChangeTimes->{{3.920112523098427*^9, 3.920112525018935*^9}, 
   3.920114283903673*^9, {3.920114367942831*^9, 
   3.920114368510496*^9}},ExpressionUUID->"c4e424ff-b5c8-4bb2-808b-\
7fdebf20ea9f"],

Cell[TextData[{
 "We use the Isserlis\[CloseCurlyQuote]s theorem to express the expectation \
of product of mean-zero multivariate Gaussians.\n\n",
 StyleBox["Theorem (Isserlis)",
  FontWeight->Bold],
 ": if ",
 Cell[BoxData[
  TemplateBox[<|"boxes" -> FormBox[
      RowBox[{"(", 
        RowBox[{
          SubscriptBox[
           StyleBox["X", "TI"], "1"], ",", 
          SubscriptBox[
           StyleBox["X", "TI"], "2"], ",", "\[CenterEllipsis]", ",", 
          SubscriptBox[
           StyleBox["X", "TI"], 
           StyleBox["n", "TI"]]}], ")"}], TraditionalForm], "errors" -> {}, 
    "input" -> "(X_1,X_2,\\cdots,X_n)", "state" -> "Boxes"|>,
   "TeXAssistantTemplate"]],ExpressionUUID->
  "8a0c45aa-2f2e-4d9d-905f-4c9a816fbaa6"],
 " is a mean-zero multivariate normal random vector, then ",
 Cell[BoxData[
  TemplateBox[<|"boxes" -> FormBox[
      RowBox[{
        StyleBox["E", FontSlant -> "Plain"], 
        RowBox[{"[", 
          RowBox[{
            SubscriptBox[
             StyleBox["X", "TI"], "1"], "\[CenterEllipsis]", 
            SubscriptBox[
             StyleBox["X", "TI"], 
             StyleBox["n", "TI"]]}], "]"}], "\[LongEqual]", 
        UnderscriptBox["\[Sum]", 
         RowBox[{
           StyleBox["p", "TI"], "\[Element]", 
           SubsuperscriptBox[
            StyleBox["P", "TI"], 
            StyleBox["n", "TI"], "2"]}], LimitsPositioning -> True], 
        UnderscriptBox["\[Product]", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               StyleBox["i", "TI"], ",", 
               StyleBox["j", "TI"]}], "}"}], "\[Element]", 
           StyleBox["p", "TI"]}], LimitsPositioning -> True], 
        StyleBox["C", "TI"], 
        StyleBox["o", "TI"], 
        StyleBox["v", "TI"], 
        RowBox[{"(", 
          RowBox[{
            SubscriptBox[
             StyleBox["X", "TI"], 
             StyleBox["i", "TI"]], ",", 
            SubscriptBox[
             StyleBox["X", "TI"], 
             StyleBox["j", "TI"]]}], ")"}]}], TraditionalForm], 
    "errors" -> {}, "input" -> 
    "\\mathbb{E} \\left[X_1\\cdots X_n\\right] = \\sum_{p \\in P^2_n}\\prod_{\
\\{i,j\\} \\in p} Cov(X_i,X_j)", "state" -> "Boxes"|>,
   "TeXAssistantTemplate"]],ExpressionUUID->
  "ab34cca6-259b-4d34-8ecb-1d1b87c50098"],
 ",where the summation is over all the distinct partition ",
 Cell[BoxData[
  TemplateBox[<|"boxes" -> FormBox[
      StyleBox["p", "TI"], TraditionalForm], "errors" -> {}, "input" -> "p", 
    "state" -> "Boxes"|>,
   "TeXAssistantTemplate"]],ExpressionUUID->
  "adf73f86-2a8e-4ed1-aecb-494ec62e61f9"],
 " of ",
 Cell[BoxData[
  TemplateBox[<|"boxes" -> FormBox[
      RowBox[{"{", 
        RowBox[{"1", ",", "\[CenterEllipsis]", ",", 
          StyleBox["n", "TI"]}], "}"}], TraditionalForm], "errors" -> {}, 
    "input" -> "\\{1,\\cdots,n\\}", "state" -> "Boxes"|>,
   "TeXAssistantTemplate"]],ExpressionUUID->
  "1775591b-0dc6-4a5d-8ebe-d5ae89c2050e"],
 " into pairs and the product is over ",
 Cell[BoxData[
  TemplateBox[<|"boxes" -> FormBox[
      RowBox[{
        RowBox[{"{", 
          RowBox[{
            StyleBox["i", "TI"], ",", 
            StyleBox["j", "TI"]}], "}"}], "\[Element]", 
        StyleBox["p", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
    "\\{i,j\\} \\in p", "state" -> "Boxes"|>,
   "TeXAssistantTemplate"]],ExpressionUUID->
  "b65c2433-12c2-4fe2-b8c0-5eeefe5d5d62"],
 ".\n\nFor example, for the four product case, we have the partition ",
 Cell[BoxData[
  TemplateBox[<|"boxes" -> FormBox[
      RowBox[{
        SubsuperscriptBox[
         StyleBox["P", "TI"], "4", "2"], "\[LongEqual]", 
        RowBox[{"{", 
          RowBox[{
            RowBox[{"{", 
              RowBox[{
                RowBox[{"(", 
                  RowBox[{"1", ",", "2"}], ")"}], ",", 
                RowBox[{"(", 
                  RowBox[{"3", ",", "4"}], ")"}]}], "}"}], ",", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"(", 
                  RowBox[{"1", ",", "3"}], ")"}], ",", 
                RowBox[{"(", 
                  RowBox[{"2", ",", "4"}], ")"}]}], "}"}], ",", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"(", 
                  RowBox[{"1", ",", "4"}], ")"}], ",", 
                RowBox[{"(", 
                  RowBox[{"2", ",", "3"}], ")"}]}], "}"}]}], "}"}]}], 
      TraditionalForm], "errors" -> {}, "input" -> 
    "P^2_4=\\{\\{(1,2),(3,4)\\}, \\{(1,3),(2,4)\\}, \\{(1,4),(2,3)\\}\\}", 
    "state" -> "Boxes"|>,
   "TeXAssistantTemplate"]],ExpressionUUID->
  "a70fbd3b-d99e-4c5f-aa97-a92bff60455f"],
 ". \nTherefore we have \n",
 Cell[BoxData[
  TemplateBox[<|"boxes" -> FormBox[
      RowBox[{
        StyleBox["E", FontSlant -> "Plain"], 
        RowBox[{"[", 
          RowBox[{
            SubscriptBox[
             StyleBox["X", "TI"], "1"], 
            SubscriptBox[
             StyleBox["X", "TI"], "2"], 
            SubscriptBox[
             StyleBox["X", "TI"], "3"], 
            SubscriptBox[
             StyleBox["X", "TI"], "4"]}], "]"}], "\[LongEqual]", 
        StyleBox["C", "TI"], 
        StyleBox["o", "TI"], 
        StyleBox["v", "TI"], 
        RowBox[{"(", 
          RowBox[{
            SubscriptBox[
             StyleBox["X", "TI"], "1"], 
            SubscriptBox[
             StyleBox["X", "TI"], "2"]}], ")"}], 
        StyleBox["C", "TI"], 
        StyleBox["o", "TI"], 
        StyleBox["v", "TI"], 
        RowBox[{"(", 
          RowBox[{
            SubscriptBox[
             StyleBox["X", "TI"], "3"], ",", 
            SubscriptBox[
             StyleBox["X", "TI"], "4"]}], ")"}], "+", 
        StyleBox["C", "TI"], 
        StyleBox["o", "TI"], 
        StyleBox["v", "TI"], 
        RowBox[{"(", 
          RowBox[{
            SubscriptBox[
             StyleBox["X", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["X", "TI"], "3"]}], ")"}], 
        StyleBox["C", "TI"], 
        StyleBox["o", "TI"], 
        StyleBox["v", "TI"], 
        RowBox[{"(", 
          RowBox[{
            SubscriptBox[
             StyleBox["X", "TI"], "2"], ",", 
            SubscriptBox[
             StyleBox["X", "TI"], "4"]}], ")"}], "+", 
        StyleBox["C", "TI"], 
        StyleBox["o", "TI"], 
        StyleBox["v", "TI"], 
        RowBox[{"(", 
          RowBox[{
            SubscriptBox[
             StyleBox["X", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["X", "TI"], "4"]}], ")"}], 
        StyleBox["C", "TI"], 
        StyleBox["o", "TI"], 
        StyleBox["v", "TI"], 
        RowBox[{"(", 
          RowBox[{
            SubscriptBox[
             StyleBox["X", "TI"], "2"], ",", 
            SubscriptBox[
             StyleBox["X", "TI"], "3"]}], ")"}]}], TraditionalForm], 
    "errors" -> {}, "input" -> 
    "\\mathbb{E}\\left[X_1X_2X_3X_4\\right] = Cov(X_1X_2)Cov(X_3,X_4) + \
Cov(X_1,X_3)Cov(X_2,X_4) + Cov(X_1,X_4)Cov(X_2,X_3)", "state" -> "Boxes"|>,
   "TeXAssistantTemplate"]],ExpressionUUID->
  "4ea80116-cadb-4315-9ed0-53d40b13d223"],
 ".\nNotice that for every element of the covariance matrix, this will just \
be the rule for the two product, since\n",
 Cell[BoxData[
  TemplateBox[<|"boxes" -> FormBox[
      RowBox[{
        StyleBox["C", "TI"], 
        StyleBox["o", "TI"], 
        StyleBox["v", "TI"], 
        RowBox[{"(", 
          RowBox[{
            SubscriptBox[
             StyleBox["X", "TI"], 
             StyleBox["i", "TI"]], ",", 
            SubscriptBox[
             StyleBox["X", "TI"], 
             StyleBox["j", "TI"]]}], ")"}], "\[LongEqual]", 
        StyleBox["E", FontSlant -> "Plain"], 
        RowBox[{"[", 
          RowBox[{
            SubsuperscriptBox["\[Integral]", "0", 
             RowBox[{
               SubscriptBox[
                StyleBox["a", "TI"], 
                StyleBox["i", "TI"]], 
               StyleBox["t", "TI"]}]], 
            FractionBox[
             RowBox[{"\[Sigma]", 
               StyleBox["d", "TI"], 
               SuperscriptBox[
                StyleBox["B", "TI"], 
                StyleBox["i", "TI"]]}], 
             RowBox[{
               StyleBox["t", "TI"], "-", 
               StyleBox["u", "TI"]}]], 
            SubsuperscriptBox["\[Integral]", "0", 
             RowBox[{
               SubscriptBox[
                StyleBox["a", "TI"], 
                StyleBox["j", "TI"]], 
               StyleBox["t", "TI"]}]], 
            FractionBox[
             RowBox[{"\[Sigma]", 
               StyleBox["d", "TI"], 
               SuperscriptBox[
                StyleBox["B", "TI"], 
                StyleBox["j", "TI"]]}], 
             RowBox[{
               StyleBox["t", "TI"], "-", 
               StyleBox["u", "TI"]}]]}], "]"}], "."}], TraditionalForm], 
    "errors" -> {}, "input" -> 
    "Cov(X_i,X_j) = \\mathbb{E} \\left[\\int_0^{a_it}\\frac{\\sigma \
dB^i}{t-u} \\int_0^{a_jt} \\frac{\\sigma dB^j}{t-u}\\right].", "state" -> 
    "Boxes"|>,
   "TeXAssistantTemplate"]],ExpressionUUID->
  "e45f88be-3a24-489e-8d47-4dd51a7d542e"]
}], "Text",
 CellChangeTimes->{{3.920112527713618*^9, 3.920112655873006*^9}, {
   3.920112763732735*^9, 3.920112769212419*^9}, 3.920112819691579*^9, {
   3.922455575477191*^9, 
   3.922455590808754*^9}},ExpressionUUID->"5244e795-3771-497b-8b1a-\
27039f7ee06b"],

Cell[CellGroupData[{

Cell["Inputs:", "Subsection",
 CellChangeTimes->{{3.920117037759885*^9, 
  3.920117046782954*^9}},ExpressionUUID->"d8f29fbd-096a-4222-b464-\
7281c8f4709c"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["i", "TI"], TraditionalForm], "errors" -> {}, "input" -> "i", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "fb854aed-d4a1-4918-971a-e0bba1fe4090"],
 ": list valued, length 4, stands for the index list ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{
           SubscriptBox[
            StyleBox["i", "TI"], "1"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "2"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "3"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "4"]}], "}"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\{i_{1},i_{2},i_{3},i_{4}\\}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ff7f7059-adb5-475c-a652-6c2a60c19e3d"],
 ". \n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["a", "TI"], TraditionalForm], "errors" -> {}, "input" -> "a", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "68c775d7-7aa3-4b82-98ed-09f080cbad3c"],
 ": list valued, length 4, stands for the time horizon parameters ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{
           SubscriptBox[
            StyleBox["a", "TI"], "1"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "2"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "3"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "4"]}], "}"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\{a_{1},a_{2},a_{3}, a_4\\}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3c168b4b-4b05-4df6-8998-1959351bdc49"],
 " of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["X", "TI"], "1"], ",", 
         SubscriptBox[
          StyleBox["X", "TI"], "2"], ",", 
         SubscriptBox[
          StyleBox["X", "TI"], "3"], ",", 
         SubscriptBox[
          StyleBox["X", "TI"], "4"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "X_1,X_2,X_3,X_4", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "948cde15-9f8f-453a-9045-0294a6cc9571"],
 ". \n\ndrift: list valued, length 4, stands for the drift terms of the \
stochastic integrals. They are actually all {0,0,0,0} throughout the \
document.\n\nC: list valued, length 4, stands for the coefficient term in \
front of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubsuperscriptBox[
        RowBox[{"(", 
          RowBox[{"\[Sigma]", 
            StyleBox["d", "TI"], 
            StyleBox["B", "TI"]}], ")"}], 
        StyleBox["u", "TI"], 
        StyleBox["i", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "(\\sigma dB)_{u}^{i}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d458f85e-df4d-4445-a547-e17db2603b50"],
 ". "
}], "Text",
 CellChangeTimes->{{3.92011704885433*^9, 3.920117082657866*^9}, {
  3.92061960388367*^9, 
  3.920619612027011*^9}},ExpressionUUID->"77a04de1-6ccd-4080-abb1-\
51e0cf2a2821"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Outputs:", "Subsection",
 CellChangeTimes->{{3.920117157802692*^9, 
  3.920117160301156*^9}},ExpressionUUID->"4541c047-42d5-4b8f-b978-\
2027faef9eec"],

Cell["\<\
length 2 list, 

first position: the full expression of the resulting term;

second position: the associated Kronecker delta term.\
\>", "Text",
 CellChangeTimes->{
  3.920117186680956*^9, {3.920619649801896*^9, 
   3.9206196820456953`*^9}},ExpressionUUID->"cee4db3f-6db6-409e-9081-\
e443bf0634d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fourProductF", "[", "\[IndentingNewLine]", 
   RowBox[{
   "i_", ",", "\[IndentingNewLine]", "a_", ",", "\[IndentingNewLine]", 
    "drift_", ",", "\[IndentingNewLine]", "C_"}], "\n", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\n", 
    RowBox[{"(*", 
     RowBox[{
     "There", " ", "are", " ", "only", " ", "three", " ", "ways", " ", "of", 
      " ", 
      RowBox[{"pairing", ".", " ", "It"}], " ", "is", " ", "straightforward", 
      " ", "to", " ", "do", " ", "this", " ", 
      RowBox[{"manually", "."}]}], "*)"}], "\n", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"The", " ", "structure", " ", "below", " ", 
       RowBox[{"is", ":", " ", 
        RowBox[{
        "the", " ", "first", " ", "two", " ", "forms", " ", "a", " ", 
         "pair"}]}]}], ",", " ", 
      RowBox[{
      "and", " ", "the", " ", "latter", " ", "two", " ", "forms", " ", "the", 
       " ", "other", " ", 
       RowBox[{"pair", "."}]}]}], "*)"}], "\n", 
    RowBox[{
     RowBox[{"pairing", " ", "=", " ", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"deltaList", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{
           RowBox[{"i", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"i", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{
           RowBox[{"i", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{"i", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{
           RowBox[{"i", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"i", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{
           RowBox[{"i", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"i", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{
           RowBox[{"i", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"i", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "*", 
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{
           RowBox[{"i", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"i", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Initialise", " ", "the", " ", "covariance", " ", "list", " ", "with", 
       " ", "empty", " ", 
       RowBox[{"rules", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"covSetup", "=", 
      RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"\[CapitalSigma]", ",", 
            RowBox[{"i", "[", 
             RowBox[{"[", "m", "]"}], "]"}], ",", 
            RowBox[{"i", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
          ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "4"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "4"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
        ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "This", " ", "step", " ", "incorporates", " ", "with", " ", "the", " ",
         "two"}], "-", 
       RowBox[{"product", " ", 
        RowBox[{"expression", ".", "\[IndentingNewLine]", "Get"}], " ", "the",
         " ", "expression", " ", "for", " ", "each", " ", "covariance", " ", 
        RowBox[{"element", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"covTerm", "=", "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Refine", "[", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"twoProductF", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], ",", 
                RowBox[{"i", "[", 
                 RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], ",", 
                RowBox[{"a", "[", 
                 RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"drift", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], ",", 
                RowBox[{"drift", "[", 
                 RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"C", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], ",", 
                RowBox[{"C", "[", 
                 RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], 
             "\[IndentingNewLine]", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "4"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
         "]"}], "\[IndentingNewLine]", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Assign", " ", "the", " ", "rules", " ", "in", " ", "the", " ", 
       "covariance", " ", 
       RowBox[{"list", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"covMatrixRule", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"covSetup", "[", 
          RowBox[{"[", "counter", "]"}], "]"}], "\[Rule]", 
         RowBox[{"covTerm", "[", 
          RowBox[{"[", "counter", "]"}], "]"}]}], "\[IndentingNewLine]", ",", 
        
        RowBox[{"{", 
         RowBox[{"counter", ",", "16"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Total", "[", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"\[CapitalSigma]", ",", 
             RowBox[{
              RowBox[{"pairing", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"pairing", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
           "*", 
           RowBox[{"Subscript", "[", 
            RowBox[{"\[CapitalSigma]", ",", 
             RowBox[{
              RowBox[{"pairing", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"pairing", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"counter", ",", "3"}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "]"}], "/.", "covMatrixRule"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"result", ",", "deltaList"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.908794686552914*^9, 3.908794753489871*^9}, {
  3.908794795824115*^9, 3.908795017648439*^9}, {3.920112136449029*^9, 
  3.920112138515019*^9}, {3.920112875472023*^9, 3.920112973665889*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"968698a3-912c-4935-b5d8-48baad63daaf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example", "Section",
 CellChangeTimes->{{3.920114050714767*^9, 
  3.920114051689671*^9}},ExpressionUUID->"2673d6e3-047f-4b94-94b9-\
f5256737fe5b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fourProductF", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"j", ",", "k", ",", "p", ",", "q"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Min", "[", 
      RowBox[{"v", ",", "\[Rho]"}], "]"}], ",", "\[Eta]", ",", "v", ",", 
     "v"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"t", "-", "u"}], ")"}]}], ",", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"t", "-", "u"}], ")"}]}], ",", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"t", "-", "u"}], ")"}]}], ",", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"t", "-", "u"}], ")"}]}]}], "}"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellLabel->"In[37]:=",ExpressionUUID->"43751d8c-343e-4674-a11c-5725402b4519"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      TemplateBox[{
        RowBox[{"j", ",", "q"}]},
       "KroneckerDeltaSeq"], " ", 
      TemplateBox[{
        RowBox[{"k", ",", "p"}]},
       "KroneckerDeltaSeq"], " ", 
      RowBox[{"Min", "[", 
       RowBox[{"v", ",", "\[Eta]"}], "]"}], " ", 
      RowBox[{"Min", "[", 
       RowBox[{"v", ",", "\[Rho]"}], "]"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t", "-", 
        RowBox[{"t", " ", 
         RowBox[{"Min", "[", 
          RowBox[{"v", ",", "\[Eta]"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"t", "-", 
        RowBox[{"t", " ", 
         RowBox[{"Min", "[", 
          RowBox[{"v", ",", "\[Rho]"}], "]"}]}]}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{
      TemplateBox[{
        RowBox[{"j", ",", "p"}]},
       "KroneckerDeltaSeq"], " ", 
      TemplateBox[{
        RowBox[{"k", ",", "q"}]},
       "KroneckerDeltaSeq"], " ", 
      RowBox[{"Min", "[", 
       RowBox[{"v", ",", "\[Eta]"}], "]"}], " ", 
      RowBox[{"Min", "[", 
       RowBox[{"v", ",", "\[Rho]"}], "]"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t", "-", 
        RowBox[{"t", " ", 
         RowBox[{"Min", "[", 
          RowBox[{"v", ",", "\[Eta]"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"t", "-", 
        RowBox[{"t", " ", 
         RowBox[{"Min", "[", 
          RowBox[{"v", ",", "\[Rho]"}], "]"}]}]}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"v", " ", 
      TemplateBox[{
        RowBox[{"j", ",", "k"}]},
       "KroneckerDeltaSeq"], " ", 
      TemplateBox[{
        RowBox[{"p", ",", "q"}]},
       "KroneckerDeltaSeq"], " ", 
      RowBox[{"Min", "[", 
       RowBox[{"v", ",", "\[Eta]", ",", "\[Rho]"}], "]"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t", "-", 
        RowBox[{"t", " ", "v"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"t", "-", 
        RowBox[{"t", " ", 
         RowBox[{"Min", "[", 
          RowBox[{"v", ",", "\[Eta]", ",", "\[Rho]"}], "]"}]}]}], ")"}]}]]}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      TemplateBox[{
        RowBox[{"j", ",", "k"}]},
       "KroneckerDeltaSeq"], " ", 
      TemplateBox[{
        RowBox[{"p", ",", "q"}]},
       "KroneckerDeltaSeq"]}], ",", 
     RowBox[{
      TemplateBox[{
        RowBox[{"j", ",", "p"}]},
       "KroneckerDeltaSeq"], " ", 
      TemplateBox[{
        RowBox[{"k", ",", "q"}]},
       "KroneckerDeltaSeq"]}], ",", 
     RowBox[{
      TemplateBox[{
        RowBox[{"j", ",", "q"}]},
       "KroneckerDeltaSeq"], " ", 
      TemplateBox[{
        RowBox[{"k", ",", "p"}]},
       "KroneckerDeltaSeq"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.920114061552189*^9, 3.921737047112142*^9, 
  3.9224634207723007`*^9, 3.923643622779353*^9, 3.926469591554624*^9, 
  3.929455364719762*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"a89802cd-aee2-4d22-8005-5714c62bb226"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Four-Product Evaluation", "Subchapter",
 CellChangeTimes->{{3.920114289816474*^9, 
  3.920114290073851*^9}},ExpressionUUID->"5022d66a-1ebd-4f68-9e0a-\
de482d3660ec"],

Cell["\<\
Follows exactly the same idea as the evaluation function before.\
\>", "Text",
 CellChangeTimes->{{3.920114007455204*^9, 3.920114033125904*^9}, {
  3.920619701954979*^9, 
  3.920619712557415*^9}},ExpressionUUID->"cbb4aaff-1a41-4ad6-9532-\
2fe986145814"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fourProductFEval", "[", "\[IndentingNewLine]", 
   RowBox[{
   "extraCoeff_", ",", "\[IndentingNewLine]", "expression_", ",", 
    "\[IndentingNewLine]", "b1_", ",", "\[IndentingNewLine]", "b2_", ",", 
    "\[IndentingNewLine]", "b3_", ",", "\[IndentingNewLine]", "b4_"}], "]"}], 
  ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"result", "=", 
      RowBox[{"Total", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Integrate", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"extraCoeff", "*", 
           RowBox[{"Coefficient", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"expression", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             RowBox[{"expression", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
            "]"}]}], "\[IndentingNewLine]", ",", "b1", ",", "b2", ",", "b3", 
          ",", "b4"}], "]"}], "*", 
        RowBox[{"expression", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     ";", "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.908795025345353*^9, 3.908795052660679*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"c9b60cc4-5fdd-41d0-830c-986e54fb2d67"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Improved Five-Product Case", "Chapter",
 CellChangeTimes->{{3.920114257048356*^9, 3.92011430621188*^9}, {
  3.9201172665408397`*^9, 3.9201172829394217`*^9}, {3.922432993814294*^9, 
  3.922432995074295*^9}, {3.929457985313395*^9, 
  3.929457986505515*^9}},ExpressionUUID->"ff7936bd-7846-4c8e-a752-\
80e3ffcdb983"],

Cell[TextData[{
 "We consider\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"]}]], 
                 SubscriptBox[
                  StyleBox["C", "TI"], "1"], 
                 SubsuperscriptBox[
                  RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                  StyleBox["u", "TI"], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "1"]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "2"]}]], 
                 SubscriptBox[
                  StyleBox["C", "TI"], "2"], 
                 SubsuperscriptBox[
                  RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                  StyleBox["u", "TI"], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "2"]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "3"]}]], 
                 SubscriptBox[
                  StyleBox["C", "TI"], "3"], 
                 SubsuperscriptBox[
                  RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                  StyleBox["u", "TI"], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "3"]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "4"]}]], 
                 SubscriptBox[
                  StyleBox["C", "TI"], "4"], 
                 SubsuperscriptBox[
                  RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                  StyleBox["u", "TI"], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "4"]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "5"]}]], "\[CapitalXi]", 
                 RowBox[{"(", 
                   RowBox[{
                    StyleBox["u", "TI"], ";", 
                    SubscriptBox[
                    StyleBox["i", "TI"], "6"]}], ")"}], 
                 SubsuperscriptBox[
                  RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                  StyleBox["u", "TI"], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "5"]]}], ")"}]}], "]"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\mathbb{E}\\left[\\left(\\int_{0}^{ta_{1}}C_{1}(\\sigma \
dB)_{u}^{i_{1}}\\right)\\left(\\int_{0}^{ta_{2}}C_{2}(\\sigma dB)_{u}^{i_{2}}\
\\right)\\left(\\int_{0}^{ta_{3}}C_{3}(\\sigma dB)_{u}^{i_{3}}\\right)\\left(\
\\int_{0}^{ta_{4}}C_{4}(\\sigma \
dB)_{u}^{i_{4}}\\right)\\left(\\int_{0}^{ta_{5}}\\Xi(u;i_{6})(\\sigma \
dB)_{u}^{i_{5}}\\right)\\right]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "97fa2f82-fdf2-4985-bcf6-c0eb60857a41"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalXi]", "(", 
         RowBox[{
           StyleBox["u", "TI"], ";", 
           SubscriptBox[
            StyleBox["i", "TI"], "6"]}], ")"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\Xi(u;i_6)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3100485a-c226-4146-ab3e-453cc68eb719"],
 " is another stochastic integral (or Lebesgue of an expandable expression), \
and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], 
          StyleBox["i", "TI"]], "\[Element]", 
         RowBox[{"{", 
           RowBox[{"1", ",", 
             FractionBox["1", 
              RowBox[{
                StyleBox["t", "TI"], "-", 
                StyleBox["u", "TI"]}]]}], "}"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "C_i \\in \\{1,\\frac{1}{t-u}\\}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "73405787-5eb4-4704-be55-fc4790fca43b"],
 ".\n\nDenote\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox[
          StyleBox["X", "TI"], 
          StyleBox["s", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "1"]], ":", "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["s", "TI"]], 
         SubscriptBox[
          StyleBox["C", "TI"], "1"], 
         SubsuperscriptBox[
          RowBox[{"(", 
            RowBox[{"\[Sigma]", 
              StyleBox["d", "TI"], 
              StyleBox["B", "TI"]}], ")"}], 
          StyleBox["u", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "1"]], ",  ", 
         SubsuperscriptBox[
          StyleBox["Y", "TI"], 
          StyleBox["s", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "2"]], ":", "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["s", "TI"]], 
         SubscriptBox[
          StyleBox["C", "TI"], "2"], 
         SubsuperscriptBox[
          RowBox[{"(", 
            RowBox[{"\[Sigma]", 
              StyleBox["d", "TI"], 
              StyleBox["B", "TI"]}], ")"}], 
          StyleBox["u", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "2"]], ",  ", 
         SubsuperscriptBox[
          StyleBox["Z", "TI"], 
          StyleBox["s", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "3"]], ":", "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["s", "TI"]], 
         SubscriptBox[
          StyleBox["C", "TI"], "3"], 
         SubsuperscriptBox[
          RowBox[{"(", 
            RowBox[{"\[Sigma]", 
              StyleBox["d", "TI"], 
              StyleBox["B", "TI"]}], ")"}], 
          StyleBox["u", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "3"]], ",  ", 
         SubsuperscriptBox[
          StyleBox["P", "TI"], 
          StyleBox["s", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "4"]], ":", "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["s", "TI"]], 
         SubscriptBox[
          StyleBox["C", "TI"], "4"], 
         SubsuperscriptBox[
          RowBox[{"(", 
            RowBox[{"\[Sigma]", 
              StyleBox["d", "TI"], 
              StyleBox["B", "TI"]}], ")"}], 
          StyleBox["u", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "4"]], ",  ", 
         SubsuperscriptBox[
          StyleBox["Q", "TI"], 
          StyleBox["s", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "5"]], ":", "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["s", "TI"]], "\[CapitalXi]", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["u", "TI"], ";", 
             SubscriptBox[
              StyleBox["i", "TI"], "6"]}], ")"}], 
         SubsuperscriptBox[
          RowBox[{"(", 
            RowBox[{"\[Sigma]", 
              StyleBox["d", "TI"], 
              StyleBox["B", "TI"]}], ")"}], 
          StyleBox["u", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "5"]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "X_{s}^{i_{1}}:=\\int_{0}^{s}C_{1}(\\sigma dB)_{u}^{i_{1}},\\quad \
Y_{s}^{i_{2}}:=\\int_{0}^{s}C_{2}(\\sigma dB)_{u}^{i_{2}},\\quad \
Z_{s}^{i_{3}}:=\\int_{0}^{s}C_3(\\sigma dB)_{u}^{i_{3}}, \\quad \
P_{s}^{i_{4}}:=\\int_{0}^{s}C_4(\\sigma dB)_{u}^{i_{4}}, \\quad \
Q_{s}^{i_{5}}:=\\int_{0}^{s}\\Xi(u;i_6)(\\sigma dB)_{u}^{i_{5}}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3b9d1874-f295-42f9-a438-0ecf7f65938f"],
 ".\nBy Ito\[CloseCurlyQuote]s lemma and following the same idea as \
three-product, we have that the expression should be\n=four terms of the form \
",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{
                StyleBox["t", "TI"], "\[Alpha]"}]], 
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "2"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["P", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "4"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "4"]], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["X", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "1"]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["Q", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "5"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "5"]]}], ")"}]}], "]"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\mathbb{E}\\left[\\int_{0}^{t\\alpha}Y_{\\min(s,ta_{2})}^{i_{2}}Z_{\\\
min(s,ta_{3})}^{i_{3}}P_{\\min(s,ta_{4})}^{i_{4}}(dX_{\\min(s,ta_{1})}^{i_{1}}\
)(dQ_{\\min(s,ta_{5})}^{i_{5}})\\right]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "71f8d45c-5c64-411b-89ad-20fd570e8395"],
 "\n+ six terms of the form ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{
                StyleBox["t", "TI"], "\[Alpha]"}]], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["P", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "4"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "4"]], 
             SubsuperscriptBox[
              StyleBox["Q", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "5"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "5"]], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["X", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "1"]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["Y", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "2"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "2"]]}], ")"}]}], "]"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\mathbb{E}\\left[\\int_{0}^{t\\alpha}Z_{\\min(s,ta_{3})}^{i_{3}}P_{\\\
min(s,ta_{4})}^{i_{4}}Q_{\\min(s,ta_{5})}^{i_{5}}(dX_{\\min(s,ta_{1})}^{i_{1}}\
)(dY_{\\min(s,ta_{2})}^{i_{2}})\\right]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "bda6a959-22db-4ef7-8746-550825d8519b"],
 ",\nwhere different combinations of differential terms are considered.\nLet\
\[CloseCurlyQuote]s call the first kind of form \[OpenCurlyQuote]",
 StyleBox["form 1",
  FontVariations->{"Underline"->True}],
 "\[CloseCurlyQuote], and the other \[OpenCurlyQuote]",
 StyleBox["form 2",
  FontVariations->{"Underline"->True}],
 "\[CloseCurlyQuote]. \n\n",
 StyleBox["The most important part of the program is that the letter ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["v", "TI"], TraditionalForm], "errors" -> {}, "input" -> "v", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"15ecf83c-4336-49d9-a1bd-4fd7568b4572"],
 StyleBox[" is reserved for calculating the five product case. \nSo when \
calculating expectation of this kind, we\[CloseCurlyQuote]d better NOT occupy \
",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["v", "TI"], TraditionalForm], "errors" -> {}, "input" -> "v", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"ecfdb5b3-e09a-4bd1-9fb5-8bcfecec9b01"],
 StyleBox[" for other purposes. \n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Also, if ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"2c054fdd-8ab7-4850-a938-3f116e3b6446"],
 StyleBox[" has Lebesgue integral, then reserve the greek letter ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Eta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"0f457beb-945a-4287-b6cd-89591c8de970"],
 StyleBox[" to make the further change of variable. \nThis means when we \
calculating the expectation of this kind, we\[CloseCurlyQuote]d better NOT \
occupy ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Eta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"299d4f64-ef4f-4c61-b64d-447448325d78"],
 StyleBox[" for other purposes",
  FontWeight->"Bold"],
 ", and it MIGHT BE the case that the term C[[6]] contains ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Eta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a9e23f97-23b9-404c-95d0-dc335f1d19f7"],
 ", depending on whether the expansion contains ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Eta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "49944de3-14eb-4b33-a4aa-86fd432e3751"],
 " or not.\n\nMoreover, we will see in the calculation below that form 2 will \
be reduced to three-product. This means ",
 StyleBox["we also need to reserve ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"125d5e30-655c-4567-8902-7b2bcfb9dea4"],
 StyleBox[" and ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Xi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"61067db2-2870-42e2-a935-c24f97f24882"],
 StyleBox[" ",
  FontWeight->"Bold"],
 "according to the three-product documentation, since the output will be \
parameterised by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1d72108e-b681-4d49-bd2b-dfd0c9b30c2a"],
 " or ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Xi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "bc8cff53-a91e-4f1e-895d-2aeddfa362ab"],
 ".\n\n We will clarify what should be the inputs in every case."
}], "Text",
 CellChangeTimes->{{3.920114387996243*^9, 3.920114448366406*^9}, {
   3.920114492234528*^9, 3.920114646980935*^9}, {3.920114766164877*^9, 
   3.920114950802268*^9}, {3.9201150211998997`*^9, 3.920115069837957*^9}, {
   3.920115755074142*^9, 3.9201158875332108`*^9}, {3.920116848528469*^9, 
   3.920116905052783*^9}, {3.9205710756886806`*^9, 3.920571210553357*^9}, 
   3.920571602967585*^9, {3.920620845649418*^9, 3.92062086844463*^9}, {
   3.920620935303856*^9, 3.920620986652306*^9}, {3.920621316001293*^9, 
   3.920621335016062*^9}, {3.920623292831547*^9, 
   3.920623298936629*^9}},ExpressionUUID->"fc0ac06d-efb9-402f-b210-\
99f3286302ad"],

Cell[CellGroupData[{

Cell[" Form1 Expectation Expression.", "Subchapter",
 CellChangeTimes->{{3.908798888198339*^9, 3.908798902181222*^9}, 
   3.920109167569105*^9, 3.920114275785612*^9, {3.9201172793575172`*^9, 
   3.920117286125993*^9}},ExpressionUUID->"a9eb2cc4-a4a7-4d03-88f0-\
77715be500a8"],

Cell[TextData[{
 "For form 1, let\[CloseCurlyQuote]s investigate the specific term ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{
                StyleBox["t", "TI"], "\[Alpha]"}]], 
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "2"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["P", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "4"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "4"]], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["X", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "1"]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["Q", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "5"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "5"]]}], ")"}]}], "]"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\mathbb{E}\\left[\\int_{0}^{t\\alpha}Y_{\\min(s,ta_{2})}^{i_{2}}Z_{\\\
min(s,ta_{3})}^{i_{3}}P_{\\min(s,ta_{4})}^{i_{4}}(dX_{\\min(s,ta_{1})}^{i_{1}}\
)(dQ_{\\min(s,ta_{5})}^{i_{5}})\\right]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e287bc92-4a32-4cce-bde1-a8adec19fa3f"],
 ", and for the rest of terms it will just be a permutation of indices and \
parameters. We have\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{
                StyleBox["t", "TI"], "\[Alpha]"}]], 
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "2"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["P", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "4"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "4"]], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["X", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "1"]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["Q", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "5"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "5"]]}], ")"}]}], "]"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\mathbb{E}\\left[\\int_{0}^{t\\alpha}Y_{\\min(s,ta_{2})}^{i_{2}}Z_{\\\
min(s,ta_{3})}^{i_{3}}P_{\\min(s,ta_{4})}^{i_{4}}(dX_{\\min(s,ta_{1})}^{i_{1}}\
)(dQ_{\\min(s,ta_{5})}^{i_{5}})\\right]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "04971af3-122f-4a47-a523-35df0cbed915"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{
                StyleBox["t", "TI"], "\[Alpha]"}]], 
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "2"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["P", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "4"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "4"]], 
             RowBox[{"{", 
               SubscriptBox[
                StyleBox["C", "TI"], "1"], "}"}], "\[CapitalXi]", 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["s", "TI"], ";", 
                 SubscriptBox[
                  StyleBox["i", "TI"], "6"]}], ")"}], 
             SubscriptBox["1", 
              RowBox[{"{", 
                RowBox[{"0", "\[LessEqual]", 
                  StyleBox["s", "TI"], "\[LessEqual]", "min", 
                  RowBox[{"(", 
                    RowBox[{
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "5"]}], ")"}]}], "}"}]], 
             StyleBox["d", "TI"], 
             StyleBox["s", "TI"]}], "]"}]}], TraditionalForm], "errors" -> {},
      "input" -> 
     "=\\mathbb{E}\\left[\\int_{0}^{t\\alpha}Y_{\\min(s,ta_{2})}^{i_{2}}Z_{\\\
min(s,ta_{3})}^{i_{3}}P_{\\min(s,ta_{4})}^{i_{4}} \\{C_{1}\\} \
\\Xi(s;i_{6})\\bm{1}_{\\{0\\leq s\\leq\\min(ta_{1},ta_{5})\\}}ds\\right]", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7496b65d-8fec-4eab-aca0-3c909b6a3259"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "5"]}]], "\[CenterDot]", 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "5"]}], ")"}]}]], 
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "2"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["P", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "4"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "4"]], 
             RowBox[{"{", 
               SubscriptBox[
                StyleBox["C", "TI"], "1"], "}"}], "\[CapitalXi]", 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["s", "TI"], ";", 
                 SubscriptBox[
                  StyleBox["i", "TI"], "6"]}], ")"}], 
             StyleBox["d", "TI"], 
             StyleBox["s", "TI"]}], "]"}]}], TraditionalForm], "errors" -> {},
      "input" -> 
     "=\\delta_{i_{1},i_{5}}\\cdot\\mathbb{E}\\left[\\int_{0}^{t\\min(a_{1},a_\
{5})}Y_{\\min(s,ta_{2})}^{i_{2}}Z_{\\min(s,ta_{3})}^{i_{3}}P_{\\min(s,ta_{4})}\
^{i_{4}}\\left\\{ C_{1}\\right\\} \\Xi(s;i_{6})ds\\right]", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "28d8429f-c7e9-4757-a736-ea00baeddd3d"],
 ".\nNow we need to change of variable. This will depend on the value of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["C", "TI"], "1"], TraditionalForm], "errors" -> {}, "input" -> 
     "C_1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b35064a5-8342-474f-836a-6da8d439fa38"],
 ", which has two possible outcomes.\nCondition 1: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "1"], "\[LongEqual]", "1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "C_1=1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "06e33eb1-e909-4b5b-b286-68403e3488cf"],
 ". Apply change of variable ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["s", "TI"], "\[LongEqual]", 
         StyleBox["t", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "s=tv", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "028d6791-667a-4c8a-9c1c-59b761f5659b"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         StyleBox["t", "TI"], "\[CenterDot]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "5"]}]], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "1"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "5"]}], ")"}]], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["t", "TI"], 
                  StyleBox["v", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "2"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["t", "TI"], 
                  StyleBox["v", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["P", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["t", "TI"], 
                  StyleBox["v", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "4"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "4"]], "\[CapitalXi]", 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["t", "TI"], 
                 StyleBox["v", "TI"], ";", 
                 SubscriptBox[
                  StyleBox["i", "TI"], "6"]}], ")"}]}], "]"}], 
         StyleBox["d", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "=t\\cdot\\delta_{i_{1},i_{5}}\\cdot\\int_{0}^{\\min(a_{1},a_{5})}\\\
mathbb{E}\\left[Y_{\\min(tv,ta_{2})}^{i_{2}}Z_{\\min(tv,ta_{3})}^{i_{3}}P_{\\\
min(tv,ta_{4})}^{i_{4}}\\Xi(tv;i_{6})\\right]dv", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d812adb7-28d6-4c2a-8c05-da9633eaba14"],
 ".\nCondition 2: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "1"], "\[LongEqual]", 
         FractionBox["1", 
          RowBox[{
            StyleBox["t", "TI"], "-", 
            StyleBox["u", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "C_1=\\frac{1}{t-u}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "95cd75a8-f410-4949-9544-e3e38f5e8ee2"],
 ". Apply change of variable ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["s", "TI"], "\[LongEqual]", 
         StyleBox["t", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "s=tv", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e136c195-c765-4d10-baf3-0372d9dd8f05"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "5"]}]], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "1"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "5"]}], ")"}]], 
         FractionBox["1", 
          RowBox[{"1", "-", 
            StyleBox["v", "TI"]}]], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["t", "TI"], 
                  StyleBox["v", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "2"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["t", "TI"], 
                  StyleBox["v", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["P", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["t", "TI"], 
                  StyleBox["v", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "4"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "4"]], "\[CapitalXi]", 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["t", "TI"], 
                 StyleBox["v", "TI"], ";", 
                 SubscriptBox[
                  StyleBox["i", "TI"], "6"]}], ")"}]}], "]"}], 
         StyleBox["d", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "=\\delta_{i_{1},i_{5}}\\cdot\\int_{0}^{\\min(a_{1},a_{5})}\\frac{1}{1-v}\
\\mathbb{E}\\left[Y_{\\min(tv,ta_{2})}^{i_{2}}Z_{\\min(tv,ta_{3})}^{i_{3}}P_{\
\\min(tv,ta_{4})}^{i_{4}}\\Xi(tv;i_{6})\\right]dv", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a9e51be5-edf5-46bb-9463-c412b627ce86"],
 "\n\nIt can be seen that eventually we are reduced to finding the expression \
of four-product.\n\nSimilarly, we will have the situation that the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c0e9d31d-e80f-4a52-bb81-29c4911ca4f1"],
 " has another Lebesgue integral. We just need another change of variable on \
it. We will use the parameter ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Eta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0c8dff47-00f7-4d92-9161-712d4db5bca3"],
 "."
}], "Text",
 CellChangeTimes->{{3.908795106500455*^9, 3.908795115974946*^9}, {
  3.9201158903797197`*^9, 3.920115957083713*^9}, {3.920116263245363*^9, 
  3.920116289928851*^9}, {3.920116675315047*^9, 3.920116681252533*^9}, {
  3.9201168076442213`*^9, 3.920116845153923*^9}, {3.9206197791428823`*^9, 
  3.920619806629345*^9}},ExpressionUUID->"e48edd50-8a5b-43df-9ed4-\
714055556481"],

Cell[CellGroupData[{

Cell["Inputs:", "Subsection",
 CellChangeTimes->{{3.920116691464554*^9, 
  3.920116694366783*^9}},ExpressionUUID->"d37e1ed8-b2db-4303-98ff-\
08959e6d74e1"],

Cell[TextData[{
 "XiLebesgue: boolean valued, whether ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1ab53624-331b-4db2-b4fc-1d496cabc44b"],
 " contains Lebesgue integral.\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["i", "TI"], TraditionalForm], "errors" -> {}, "input" -> "i", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "372e3b3c-1f5e-4e1b-9a0f-656076546ea3"],
 ": list valued, length 6, stands for the index list ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{
           SubscriptBox[
            StyleBox["i", "TI"], "1"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "2"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "3"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "4"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "5"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "6"]}], "}"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\{i_{1},i_{2},i_{3},i_{4},i_{5},i_{6}\\}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "11eb9098-756e-4696-8b55-b5b0d80e9935"],
 ". ",
 StyleBox["In particular, ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["i", "TI"], "5"], TraditionalForm], "errors" -> {}, "input" -> 
     "i_{5}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2f163d38-38af-4874-a84a-24affdbb37d2"],
 StyleBox[" must be the index of ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["Z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "Z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e11f3719-7dd4-4fb1-8af0-cbbdd3535780"],
 StyleBox[", and the ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["i", "TI"], "6"], TraditionalForm], "errors" -> {}, "input" -> 
     "i_{6}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "72aa45f2-f84d-4d94-bb91-0f033efe6fe7"],
 StyleBox[" must be the index of ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e01e5295-6440-4dbf-a087-3086b9e6edc3"],
 StyleBox[".\n",
  FontWeight->"Bold"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["a", "TI"], TraditionalForm], "errors" -> {}, "input" -> "a", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8b661ab1-f514-4a6e-8df5-96df51f1424f"],
 ": list valued, length 5, stands for the time horizon parameters ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{
           SubscriptBox[
            StyleBox["a", "TI"], "1"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "2"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "3"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "4"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "5"]}], "}"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\{a_{1},a_{2},a_{3},a_{4},a_{5}\\}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6cfea1fa-6b88-4520-9cb6-c012606ca1d6"],
 " of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["X", "TI"], ",", 
         StyleBox["Y", "TI"], ",", 
         StyleBox["Z", "TI"], ",", 
         StyleBox["P", "TI"], ",", 
         StyleBox["Q", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "X,Y,Z,P,Q", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "10ed0d94-fed0-4e8c-9aaa-a5fe390df951"],
 ". \n\ndrift: list valued, length 6, stands for the drift terms of the \
stochastic integrals. They are actually all {0,0,0,0,0,0}.\n\nC: list valued, \
length 6, stands for the coefficient term in front of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubsuperscriptBox[
        RowBox[{"(", 
          RowBox[{"\[Sigma]", 
            StyleBox["d", "TI"], 
            StyleBox["B", "TI"]}], ")"}], 
        StyleBox["u", "TI"], 
        StyleBox["i", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "(\\sigma dB)_{u}^{i}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1df78e33-2218-4969-91bf-c9d8adfa8623"],
 ". ",
 StyleBox["In particular, C[[5]] should always be 1 since we treat ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"6bf20304-3caf-4069-8cfa-98564ccb0696"],
 StyleBox[" as a special coefficient itself. And C[[6]] should be the \
coefficient including all the expansion terms. ",
  FontWeight->"Bold"],
 "\nThere are two situations.\n(a) If ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[<|
     "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
      "input" -> "\\Xi", "state" -> "Boxes"|>,
     "TeXAssistantTemplate"], " "}], TraditionalForm]],ExpressionUUID->
  "1daec22a-43d7-44d0-aa3f-3f1756a67ba5"],
 " does not contain Lebesgue integral, then ",
 StyleBox["C[[6]] should be parameterized by v",
  FontWeight->"Bold"],
 ". \n(b) If ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0dcb9529-a0ff-4fee-9188-c3069dd366b9"],
 " has Lebesgue integral, then ",
 StyleBox["C[[6]] should be parametrized by ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Eta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"c6743c9c-3bed-42d6-a045-f141b923427a"],
 "."
}], "Text",
 CellChangeTimes->{{3.920116684786614*^9, 3.920116735850295*^9}, {
  3.920619897534876*^9, 3.920619970696262*^9}, {3.920620012802234*^9, 
  3.920620181972849*^9}, {3.920620224483349*^9, 
  3.920620230085038*^9}},ExpressionUUID->"181ddba6-1f35-42b2-a5f7-\
5b10ef9dd69b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Outputs:", "Subsection",
 CellChangeTimes->{{3.92011733717412*^9, 
  3.920117343540664*^9}},ExpressionUUID->"576b6152-68e4-4d8c-8ed7-\
8714c34746dd"],

Cell[TextData[{
 "Length 4 list. There are two cases.\n\n1. If ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "cc13e218-0e5b-4427-8303-254896addf5c"],
 " does not contain Lebesgue integral, it is of the form \n{\n\t{term1 \
expression, integral range w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["v", "TI"], TraditionalForm], "errors" -> {}, "input" -> "v", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "be26c710-28e0-4ac4-b8b2-2e6b6fa6eafb"],
 ", Kronecker delta terms in term1},\n\t{term2 expression, integral range \
w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["v", "TI"], TraditionalForm], "errors" -> {}, "input" -> "v", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "dcaf46f5-eccc-4168-b47e-8fb4b1fb8712"],
 ", Kronecker delta terms in term2},\n\t{term3 expression, integral range \
w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["v", "TI"], TraditionalForm], "errors" -> {}, "input" -> "v", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "848d7a6e-6ceb-4ed8-af51-19fd3c05fb52"],
 ", Kronecker delta terms in term3},\n\t{term4 expression, integral range \
w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["v", "TI"], TraditionalForm], "errors" -> {}, "input" -> "v", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "dccc63aa-a3a7-43cd-8ae0-f30ebcd49e9f"],
 ", Kronecker delta terms in term4}\t\n}\n\n2. If ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "02e19f87-9242-4de7-a4d9-112da161536e"],
 " has Lebesgue integral, it is of the form \n{\n\t{term1 expression, \
integral range w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["v", "TI"], TraditionalForm], "errors" -> {}, "input" -> "v", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "08a09dd6-eca3-43d3-b74a-3507dcbe5aff"],
 ", integral range w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Eta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3335a9f3-59a6-47dc-ace7-1ff686f806a5"],
 ", Kronecker delta terms in term1},\n\t{term2 expression, integral range \
w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["v", "TI"], TraditionalForm], "errors" -> {}, "input" -> "v", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "bf762dda-67fe-40e5-82c6-6b2613100534"],
 ", integral range w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Eta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "46216fb4-e431-44b8-b787-8788307017cb"],
 ", Kronecker delta terms in term2},\n\t{term3 expression, integral range \
w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["v", "TI"], TraditionalForm], "errors" -> {}, "input" -> "v", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f9aaee81-aa8d-40b7-851b-22857c6bd868"],
 ", integral range w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Eta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "92de9ba0-794c-4825-8539-66640bcb8971"],
 ", Kronecker delta terms in term3},\n\t{term4 expression, integral range \
w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["v", "TI"], TraditionalForm], "errors" -> {}, "input" -> "v", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6c04ff93-b693-46df-9d4f-7eb5d2b464e5"],
 ", integral range w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Eta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a8f10286-ebb9-414a-b2a9-2248c41a04be"],
 ", Kronecker delta terms in term4}\n}"
}], "Text",
 CellChangeTimes->{{3.920117345283429*^9, 3.920117397104648*^9}, {
  3.920620249758999*^9, 3.92062035388251*^9}, {3.920620396245198*^9, 
  3.920620448916526*^9}, {3.920620482474124*^9, 
  3.920620484192678*^9}},ExpressionUUID->"ed3df861-e7cf-484b-a827-\
5524892913b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fiveProductFImprovedForm1", "[", "\[IndentingNewLine]", 
   RowBox[{
   "XiLebesgue_", ",", "\[IndentingNewLine]", "i_", ",", 
    "\[IndentingNewLine]", "a_", ",", "\[IndentingNewLine]", "drift_", ",", 
    "\[IndentingNewLine]", "C_"}], "\[IndentingNewLine]", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"The", " ", "four", " ", "possible", " ", "pairings"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "The", " ", "last", " ", "index", " ", "is", " ", "paired", " ", "with",
        " ", "Q"}], ",", " ", 
      RowBox[{
      "and", " ", "will", " ", "be", " ", "in", " ", "the", " ", 
       "differential", " ", "form"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "The", " ", "first", " ", "three", " ", "indices", " ", "will", " ", 
      "be", " ", "the", " ", 
      RowBox[{"integrands", "."}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pairing", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "The", " ", "last", " ", "index", " ", "is", " ", "paired", " ", 
        "with", " ", "the", " ", "index", " ", "of", " ", "Q"}], ",", " ", 
       RowBox[{"which", " ", "is", " ", "5."}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"outerPair", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"pairing", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], "}"}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", 
         RowBox[{"counter", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "The", " ", "first", " ", "three", " ", "indices", " ", "are", " ", 
       "those", " ", "of", " ", "the", " ", 
       RowBox[{"integrand", ".", " ", "\[IndentingNewLine]", "We"}], " ", 
       "also", " ", "need", " ", "to", " ", "include", " ", "the", " ", 
       "index", " ", "of", " ", "the", " ", "\[CapitalXi]", " ", "term", " ", 
       "according", " ", "to", " ", "the", " ", "calculation", " ", 
       RowBox[{"above", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"innerIndexPair", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"i", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"pairing", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"i", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"pairing", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"i", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"pairing", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"i", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"counter", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Drift", " ", "terms", " ", "of", " ", "the", " ", 
       RowBox[{"integrand", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"innerDriftList", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"drift", ",", 
            RowBox[{
             RowBox[{"pairing", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Part", "[", 
           RowBox[{"drift", ",", 
            RowBox[{
             RowBox[{"pairing", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Part", "[", 
           RowBox[{"drift", ",", 
            RowBox[{
             RowBox[{"pairing", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Part", "[", 
           RowBox[{"drift", ",", "6"}], "]"}]}], "\[IndentingNewLine]", "}"}],
         "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"counter", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Coefficient", " ", "term", " ", "of", " ", "the", " ", 
       RowBox[{"integrand", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"innerCList", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"C", ",", 
            RowBox[{
             RowBox[{"pairing", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Part", "[", 
           RowBox[{"C", ",", 
            RowBox[{
             RowBox[{"pairing", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Part", "[", 
           RowBox[{"C", ",", 
            RowBox[{
             RowBox[{"pairing", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Part", "[", 
           RowBox[{"C", ",", "6"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"counter", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"XiLebesgue", "==", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "The", " ", "time", " ", "horizons", " ", "of", " ", "the", " ", 
          RowBox[{"integrand", ".", "\[IndentingNewLine]", "Notice"}], " ", 
          "that", " ", "as", " ", "we", " ", "have", " ", "mentioned"}], ",", 
         " ", 
         RowBox[{
         "we", " ", "use", " ", "the", " ", "letter", " ", "v", " ", "to", 
          " ", "be", " ", "the", " ", "internal", " ", 
          RowBox[{"parameter", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"innerIntervalList", "=", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"pairing", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"pairing", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"pairing", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", "v"}], "\[IndentingNewLine]", "}"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "4"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
           "The", " ", "form", " ", "is", " ", "the", " ", "symbolic", " ", 
            "expectation", " ", "expression", " ", "given", " ", "by", " ", 
            "four"}], "-", 
           RowBox[{"product", " ", "function"}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"as", " ", "we", " ", "have", " ", "calculated", " ", 
           RowBox[{"above", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"form", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"outerPair", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"outerPair", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
            RowBox[{"fourProductF", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"innerIndexPair", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"innerIntervalList", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"innerDriftList", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"innerCList", "[", 
               RowBox[{"[", "counter", "]"}], "]"}]}], "\[IndentingNewLine]", 
             "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "4"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "The", " ", "term", " ", "is", " ", "the", " ", "final", " ", 
          "expression", " ", "depending", " ", "on", " ", "different", " ", 
          "conditions", " ", "of", " ", "the", " ", "coefficients", " ", 
          RowBox[{"C_i", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"term", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"C", "[", 
                 RowBox[{"[", "counter", "]"}], "]"}], "===", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"t", "*", 
                RowBox[{
                 RowBox[{"form", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"Else", " ", "if", " ", "C"}], "==", 
                 RowBox[{"1", "/", 
                  RowBox[{"(", 
                   RowBox[{"t", "-", "u"}], ")"}]}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", "v"}], ")"}]}], "*", 
                RowBox[{
                 RowBox[{"form", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"v", ",", "0", ",", 
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"a", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], ",", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"form", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "4"}], "}"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Else", " ", "if", " ", "XiLebesgue"}], "==", "True"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "code", " ", "follows", " ", "the", " ", "same", " ", 
         RowBox[{"logic", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"innerIntervalList", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"pairing", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"pairing", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"pairing", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", "\[Eta]"}], "\[IndentingNewLine]", "}"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "4"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"form", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"outerPair", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"outerPair", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
            RowBox[{"fourProductF", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"innerIndexPair", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"innerIntervalList", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"innerDriftList", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"innerCList", "[", 
               RowBox[{"[", "counter", "]"}], "]"}]}], "\[IndentingNewLine]", 
             "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "4"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"term", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"C", "[", 
                 RowBox[{"[", "counter", "]"}], "]"}], "===", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"t", "*", 
                RowBox[{
                 RowBox[{"form", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"Else", " ", "if", " ", "C"}], "==", 
                 RowBox[{"1", "/", 
                  RowBox[{"(", 
                   RowBox[{"t", "-", "u"}], ")"}]}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", "v"}], ")"}]}], "*", 
                RowBox[{
                 RowBox[{"form", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"v", ",", "0", ",", 
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"a", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], ",", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\[Eta]", ",", "0", ",", "v"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"form", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "4"}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "term"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.908795120958877*^9, 3.908795367149418*^9}, {
  3.9087960031395283`*^9, 3.908796079801654*^9}, {3.909487627568553*^9, 
  3.90948763142659*^9}, {3.920115998167999*^9, 3.920116022212367*^9}, {
  3.920116062495277*^9, 3.920116175333872*^9}, {3.920116543279548*^9, 
  3.920116591047102*^9}, {3.9205706757292423`*^9, 3.920570954725076*^9}, {
  3.920570992800603*^9, 3.920571008362962*^9}, {3.920571336922673*^9, 
  3.920571339582778*^9}, {3.9205713890215883`*^9, 3.920571516913846*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"0053fbec-cc28-4366-92a7-5699f099dd6e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Five-Product Form 1 Evaluation", "Subchapter",
 CellChangeTimes->{
  3.920114218055436*^9, {3.920117430927256*^9, 3.920117431341096*^9}, {
   3.920622819443137*^9, 
   3.920622819658576*^9}},ExpressionUUID->"6a0a86ff-9c18-4ec9-b93c-\
1a1482de963f"],

Cell["The idea follows the evaluation functions before.", "Text",
 CellChangeTimes->{{3.920571537566821*^9, 3.920571565240209*^9}, {
  3.92062050930007*^9, 
  3.920620514091313*^9}},ExpressionUUID->"df797d7f-5320-42d8-8b92-\
6108e140c4a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fiveProductFImprovedForm1Eval", "[", "\[IndentingNewLine]", 
   RowBox[{
   "XiLebesgue_", ",", "\[IndentingNewLine]", "extraCoeff_", ",", 
    "\[IndentingNewLine]", "expression_", ",", "\[IndentingNewLine]", "b1_", 
    ",", "\[IndentingNewLine]", "b2_", ",", "\[IndentingNewLine]", "b3_", ",",
     "\[IndentingNewLine]", "b4_", ",", "\[IndentingNewLine]", "b5_"}], "]"}],
   ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"XiLebesgue", "==", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"Total", "[", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Total", "[", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Integrate", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"extraCoeff", "*", 
                  RowBox[{"Coefficient", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"expression", "[", 
                    RowBox[{"[", "counter2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"expression", "[", 
                    RowBox[{"[", "counter2", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", "counter1"}], 
                    "]"}]}], "\[IndentingNewLine]", "]"}]}], 
                 "\[IndentingNewLine]", ",", "b1", ",", "b2", ",", "b3", ",", 
                 "b4", ",", "b5", ",", 
                 RowBox[{
                  RowBox[{"expression", "[", 
                   RowBox[{"[", "counter2", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"expression", "[", 
                   RowBox[{"[", "counter2", "]"}], "]"}], "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "\[IndentingNewLine]", 
                "]"}], "*", 
               RowBox[{"Part", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"expression", "[", 
                   RowBox[{"[", "counter2", "]"}], "]"}], "[", 
                  RowBox[{"[", "4", "]"}], "]"}], ",", "counter1"}], "]"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"counter1", ",", "3"}], "}"}]}], "]"}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter2", ",", "4"}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Else", " ", "if", " ", "XiLebesgue"}], "==", "False"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"Total", "[", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Total", "[", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Integrate", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"extraCoeff", "*", 
                  RowBox[{"Coefficient", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"expression", "[", 
                    RowBox[{"[", "counter2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"expression", "[", 
                    RowBox[{"[", "counter2", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "counter1"}], 
                    "]"}]}], "\[IndentingNewLine]", "]"}]}], 
                 "\[IndentingNewLine]", ",", "b1", ",", "b2", ",", "b3", ",", 
                 "b4", ",", "b5", ",", 
                 RowBox[{
                  RowBox[{"expression", "[", 
                   RowBox[{"[", "counter2", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
                "]"}], "*", 
               RowBox[{"Part", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"expression", "[", 
                   RowBox[{"[", "counter2", "]"}], "]"}], "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", "counter1"}], "]"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"counter1", ",", "3"}], "}"}]}], "]"}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter2", ",", "4"}], "}"}]}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "result"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.908795374273574*^9, 3.908795438026833*^9}, 
   3.909485752131937*^9, {3.909485785890148*^9, 3.909485801817971*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"597c431c-2b39-4e17-a00c-78cf03e19af9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Form 2 Expression.", "Subchapter",
 CellChangeTimes->{{3.90879545042418*^9, 3.9087954915150223`*^9}, {
  3.92011745471836*^9, 
  3.920117471554167*^9}},ExpressionUUID->"407291c8-1c19-4ea0-8b8c-\
4b484abbe882"],

Cell[TextData[{
 "For form 2, let\[CloseCurlyQuote]s investigate the specific term ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{
                StyleBox["t", "TI"], "\[Alpha]"}]], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["P", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "4"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "4"]], 
             SubsuperscriptBox[
              StyleBox["Q", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "5"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "5"]], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["X", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "1"]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["Y", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "2"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "2"]]}], ")"}]}], "]"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\mathbb{E}\\left[\\int_{0}^{t\\alpha}Z_{\\min(s,ta_{3})}^{i_{3}}P_{\\\
min(s,ta_{4})}^{i_{4}}Q_{\\min(s,ta_{5})}^{i_{5}}(dX_{\\min(s,ta_{1})}^{i_{1}}\
)(dY_{\\min(s,ta_{2})}^{i_{2}})\\right]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "47f6acfb-9536-44b7-97a5-ce3f17fd9bc5"],
 ", and for the rest of the terms it will just be permutation of indices and \
parameters. We have\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], 
             RowBox[{"1", ","}]], 
            SubscriptBox[
             StyleBox["i", "TI"], "2"]}]], "\[CenterDot]", 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{
                StyleBox["t", "TI"], "\[Alpha]"}]], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["P", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "4"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "4"]], 
             SubsuperscriptBox[
              StyleBox["Q", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "5"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "5"]], 
             RowBox[{"{", 
               RowBox[{
                 SubscriptBox[
                  StyleBox["C", "TI"], "1"], 
                 SubscriptBox[
                  StyleBox["C", "TI"], "2"]}], "}"}], 
             SubscriptBox["1", 
              RowBox[{"{", 
                RowBox[{"0", "\[LessEqual]", 
                  StyleBox["s", "TI"], "\[LessEqual]", "min", 
                  RowBox[{"(", 
                    RowBox[{
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "2"]}], ")"}]}], "}"}]], 
             StyleBox["d", "TI"], 
             StyleBox["s", "TI"]}], "]"}]}], TraditionalForm], "errors" -> {},
      "input" -> 
     "=\\delta_{i_{1,}i_{2}}\\cdot\\mathbb{E}\\left[\\int_{0}^{t\\alpha}Z_{\\\
min(s,ta_{3})}^{i_{3}}P_{\\min(s,ta_{4})}^{i_{4}}Q_{\\min(s,ta_{5})}^{i_{5}}\\\
left\\{ C_{1}C_{2}\\right\\} \\bm{1}_{\\{0\\leq \
s\\leq\\min(ta_{1},ta_{2})\\}}ds\\right]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1ed05bcf-0816-4a91-abda-8a9b1af0bada"],
 "\n\nCondition 1: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "1"], 
         SubscriptBox[
          StyleBox["C", "TI"], "2"], "\[LongEqual]", "1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "C_1 C_2 = 1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "940ab7d5-56e0-4c94-8100-c710fc08e907"],
 ".\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         StyleBox["t", "TI"], "\[CenterDot]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "2"]}]], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "1"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "2"]}], ")"}]], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["v", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "3"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["P", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["v", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "4"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "4"]], 
             SubsuperscriptBox[
              StyleBox["Q", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["v", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "5"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "5"]]}], "]"}], 
         StyleBox["d", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "=t\\cdot\\delta_{i_{1},i_{2}}\\cdot\\int_{0}^{\\min(a_{1},a_{2})}\\\
mathbb{E}\\left[Z_{t\\min(v,a_{3})}^{i_{3}}P_{t\\min(v,a_{4})}^{i_{4}}Q_{t\\\
min(v,a_{5})}^{i_{5}}\\right]dv", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a723720e-ad1a-44de-a981-b168a82715f6"],
 ".\n\nCondition 1: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "1"], 
         SubscriptBox[
          StyleBox["C", "TI"], "2"], "\[LongEqual]", 
         FractionBox["1", 
          RowBox[{
            StyleBox["t", "TI"], "-", 
            StyleBox["u", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "C_1 C_2 = \\frac{1}{t-u}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "078595f8-ec22-468d-8a94-56780560d76b"],
 ".\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "2"]}]], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "1"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "2"]}], ")"}]], 
         FractionBox["1", 
          RowBox[{"1", "-", 
            StyleBox["v", "TI"]}]], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["v", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "3"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["P", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["v", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "4"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "4"]], 
             SubsuperscriptBox[
              StyleBox["Q", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["v", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "5"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "5"]]}], "]"}], 
         StyleBox["d", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "=\\delta_{i_{1},i_{2}}\\cdot\\int_{0}^{\\min(a_{1},a_{2})}\\frac{1}{1-v}\
\\mathbb{E}\\left[Z_{t\\min(v,a_{3})}^{i_{3}}P_{t\\min(v,a_{4})}^{i_{4}}Q_{t\\\
min(v,a_{5})}^{i_{5}}\\right]dv", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "73fecbf3-f35a-4c86-805e-10bc5525b0ea"],
 ".\n\nCondition 1: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "1"], 
         SubscriptBox[
          StyleBox["C", "TI"], "2"], "\[LongEqual]", 
         FractionBox["1", 
          SuperscriptBox[
           RowBox[{"(", 
             RowBox[{
               StyleBox["t", "TI"], "-", 
               StyleBox["u", "TI"]}], ")"}], "2"]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "C_1 C_2 = \\frac{1}{(t-u)^2}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "33d206db-0b44-448a-8ce9-54a19093e944"],
 ".\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         FractionBox["1", 
          StyleBox["t", "TI"]], "\[CenterDot]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "2"]}]], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "1"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "2"]}], ")"}]], 
         FractionBox["1", 
          SuperscriptBox[
           RowBox[{"(", 
             RowBox[{"1", "-", 
               StyleBox["v", "TI"]}], ")"}], "2"]], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["v", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "3"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["P", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["v", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "4"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "4"]], 
             SubsuperscriptBox[
              StyleBox["Q", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["v", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "5"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "5"]]}], "]"}], 
         StyleBox["d", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "=\\frac{1}{t}\\cdot\\delta_{i_{1},i_{2}}\\cdot\\int_{0}^{\\min(a_{1},a_{\
2})}\\frac{1}{(1-v)^{2}}\\mathbb{E}\\left[Z_{t\\min(v,a_{3})}^{i_{3}}P_{t\\\
min(v,a_{4})}^{i_{4}}Q_{t\\min(v,a_{5})}^{i_{5}}\\right]dv", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "26027fe9-38b3-4015-9113-6296c9b1bce3"],
 ".\n\nNotice that we are reduced to three-product expression. Therefore, the \
\[CapitalXi] in ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["Q", "TI"], TraditionalForm], "errors" -> {}, "input" -> "Q", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "82ac773e-e63d-4ad6-bef8-e6faf2482a67"],
 " will be parameterised by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "548f0d33-7d4f-4fb1-bec2-f1fd95e1ab5c"],
 " or ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Xi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "55b579f2-9e0e-4bf8-88d9-2d4eee4c8976"],
 " according to the documentation of three-product."
}], "Text",
 CellChangeTimes->{{3.920117488892827*^9, 3.920117490344961*^9}, {
   3.92057063267881*^9, 3.920570632868557*^9}, {3.9206155095100603`*^9, 
   3.920615573423526*^9}, {3.920615608675696*^9, 3.9206156241717167`*^9}, {
   3.920615683848*^9, 3.920615763541806*^9}, 3.920615837598412*^9, {
   3.920615942227143*^9, 3.920616091737477*^9}, {3.920616142989697*^9, 
   3.920616184001245*^9}, {3.920616240726454*^9, 3.920616253741319*^9}, {
   3.9206162844978933`*^9, 3.920616319585859*^9}, {3.920616355709223*^9, 
   3.920616358353731*^9}, 3.920616457958406*^9, {3.920616491258093*^9, 
   3.920616582471429*^9}, {3.9206166215180397`*^9, 3.920616689112995*^9}, {
   3.920616728278976*^9, 3.9206167307336283`*^9}, {3.920620520340049*^9, 
   3.920620521283663*^9}, {3.92062063745122*^9, 3.920620695233269*^9}, {
   3.920620741175826*^9, 3.920620741372832*^9}, {3.920621394570225*^9, 
   3.920621396470317*^9}, {3.920621587436981*^9, 3.920621589985108*^9}, {
   3.921038094779237*^9, 
   3.92103810133853*^9}},ExpressionUUID->"3a056efe-b1b7-4774-bf9a-\
97efe153747f"],

Cell[CellGroupData[{

Cell["Inputs:", "Subsection",
 CellChangeTimes->{{3.92061673421517*^9, 
  3.920616748511127*^9}},ExpressionUUID->"b09a3f0e-c888-42fe-af90-\
c1a20c16958d"],

Cell[TextData[{
 "XiLebesgue: boolean valued, whether ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "75e571a8-7ac0-4ef7-8ae9-239b2759e86c"],
 " contains Lebesgue integral.\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["i", "TI"], TraditionalForm], "errors" -> {}, "input" -> "i", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4abdb7b2-5cb9-4e40-a934-19ad70319e70"],
 ": list valued, length 6, stands for the index list ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{
           SubscriptBox[
            StyleBox["i", "TI"], "1"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "2"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "3"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "4"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "5"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "6"]}], "}"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\{i_{1},i_{2},i_{3},i_{4},i_{5},i_{6}\\}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6f38ade2-d3a5-43ff-b3ae-77148d064c38"],
 ". ",
 StyleBox["In particular, ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["i", "TI"], "5"], TraditionalForm], "errors" -> {}, "input" -> 
     "i_{5}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ac2b6bb3-814b-465e-ba4f-4c3c3746bcbb"],
 StyleBox[" must be the index of ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["Z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "Z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "80e7f6fe-ff21-48a7-bfe0-8ffecf46fa49"],
 StyleBox[", and the ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["i", "TI"], "6"], TraditionalForm], "errors" -> {}, "input" -> 
     "i_{6}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6e1c5746-0793-400e-b552-71ee9e1a8b97"],
 StyleBox[" must be the index of ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9b64b088-556e-47d4-823a-654c4e6b3ec6"],
 StyleBox[".\n",
  FontWeight->"Bold"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["a", "TI"], TraditionalForm], "errors" -> {}, "input" -> "a", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "64b3a83a-5b2f-4f97-8dc4-b71dc0ba4940"],
 ": list valued, length 5, stands for the time horizon parameters ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{
           SubscriptBox[
            StyleBox["a", "TI"], "1"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "2"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "3"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "4"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "5"]}], "}"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\{a_{1},a_{2},a_{3},a_{4},a_{5}\\}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f2ae047b-5098-4273-8a4f-f1351baf4501"],
 " of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["X", "TI"], ",", 
         StyleBox["Y", "TI"], ",", 
         StyleBox["Z", "TI"], ",", 
         StyleBox["P", "TI"], ",", 
         StyleBox["Q", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "X,Y,Z,P,Q", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "53c0df5e-f0f4-4ded-9212-f3c68e3e8a76"],
 ". \n\ndrift: list valued, length 6, stands for the drift terms of the \
stochastic integrals. They are actually all {0,0,0,0,0,0}.\n\nC: list valued, \
length 6, stands for the coefficient term in front of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubsuperscriptBox[
        RowBox[{"(", 
          RowBox[{"\[Sigma]", 
            StyleBox["d", "TI"], 
            StyleBox["B", "TI"]}], ")"}], 
        StyleBox["u", "TI"], 
        StyleBox["i", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "(\\sigma dB)_{u}^{i}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "951cd72e-face-4e6f-bb18-3f4108cb9a36"],
 ". ",
 StyleBox["In particular, C[[5]] should always be 1 since we treat ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"e2605895-389f-4a03-b73a-c4357b2afd3a"],
 StyleBox[" as a special coefficient itself. And C[[6]] should be the \
coefficient including all the expansion terms. ",
  FontWeight->"Bold"],
 "\nThere are two cases.\n(a) If ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1dabd119-2ea6-4406-9bea-e0ff4e5aae5d"],
 " does not contain Lebesgue integral, then ",
 StyleBox["C[[6]] should be parameterised by ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"e93fc081-37d5-4a7b-8af3-2f4848b322f8"],
 ".\n(b) If ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "18a8adf9-eec5-4341-9772-ec4ce92a05c4"],
 " has Lebesgue integral, then ",
 StyleBox["C[[6]] should be parameterised by ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Xi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"7af5e3b0-b425-489d-b6ec-f6219bebc902"],
 ". "
}], "Text",
 CellChangeTimes->{{3.920616758132341*^9, 3.920616848327636*^9}, {
   3.920620561962808*^9, 3.920620575561614*^9}, {3.920620714244298*^9, 
   3.920620763680347*^9}, 3.92062081819028*^9, {3.920621008647863*^9, 
   3.920621032192764*^9}},ExpressionUUID->"4cfe7fca-839b-42da-9165-\
f8086af277ad"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Outputs:", "Subsection",
 CellChangeTimes->{{3.921038217481924*^9, 
  3.921038220424411*^9}},ExpressionUUID->"33ce07f6-f751-4b07-b25d-\
4f7c9f2c8091"],

Cell[TextData[{
 "list of six lists, each sub-list is a length 2 list which is of the form of \
three-product output.\n1. If ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f42b7304-5375-443b-997e-4c4ff2e2cc63"],
 " does not contain Lebesgue integral, it is of the form \n{\n\tsix lists of \
the form \n\t{\n\t\t{term1 expression, integral range w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["v", "TI"], TraditionalForm], "errors" -> {}, "input" -> "v", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "bcfae4e2-e063-4a52-bca4-1f23c244db7d"],
 ", Kronecker delta terms in term1},\n\t\t{term2 expression, integral range \
w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["v", "TI"], TraditionalForm], "errors" -> {}, "input" -> "v", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e206acf0-d6ec-4891-8348-e6bf55c4bb74"],
 ", Kronecker delta terms in term2}\n\t}\n}\n\n2. If ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c62cc4ba-a2ce-485b-809e-43a3111a0b36"],
 " has Lebesgue integral, it is of the form \n{\n\tsix lists of the form\n\t{\
\n\t\t{term1 expression, integral range w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["v", "TI"], TraditionalForm], "errors" -> {}, "input" -> "v", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ab9e0c10-8e97-480f-9895-88e5394f997f"],
 ", integral range w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Eta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "84f3e1e6-c09a-4388-ac76-11c754cdf132"],
 ", Kronecker delta terms in term1},\n\t\t{term2 expression, integral range \
w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["v", "TI"], TraditionalForm], "errors" -> {}, "input" -> "v", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7ec08899-a774-47f3-ae7b-d80f9c952ce3"],
 ", integral range w.r.t. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Eta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "759c70c1-aff3-4896-82d9-5d5c95516733"],
 ", Kronecker delta terms in term2},\n\t}\n}"
}], "Text",
 CellChangeTimes->{{3.921038252128269*^9, 3.921038272188594*^9}, {
  3.921038313561117*^9, 3.9210383879256*^9}, {3.9210384467667503`*^9, 
  3.921038512119966*^9}},ExpressionUUID->"d291d3a9-8ea8-4273-a145-\
4262ff4b8d18"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fiveProductFImprovedForm2", "[", "\[IndentingNewLine]", 
   RowBox[{
   "XiLebesgue_", ",", "\[IndentingNewLine]", "i_", ",", 
    "\[IndentingNewLine]", "a_", ",", "\[IndentingNewLine]", "drift_", ",", 
    "\[IndentingNewLine]", "C_"}], "\[IndentingNewLine]", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"The", " ", "'"}], 
       RowBox[{"pairing", "'"}], " ", "means", " ", "the", " ", 
       RowBox[{"following", ":", " ", 
        RowBox[{
        "the", " ", "first", " ", "two", " ", "indices", " ", "means", " ", 
         "the", " ", "integrals", " ", "not", " ", "in", " ", "the", " ", 
         "differential"}]}]}], ",", " ", 
      RowBox[{
      "the", " ", "latter", " ", "two", " ", "means", " ", "the", " ", "ones",
        " ", "in", " ", "the", " ", 
       RowBox[{"differential", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "The", " ", "special", " ", "term", " ", "Q", " ", "is", " ", "always", 
      " ", "not", " ", "in", " ", "the", " ", "differential", " ", "in", " ", 
      "form2", " ", 
      RowBox[{"case", "."}]}], "*)"}], 
    RowBox[{
     RowBox[{"pairing", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", "4", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "4", ",", "1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "4", ",", "2", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "outerPair", " ", "here", " ", "means", " ", "the", " ", "pair", " ", 
       "of", " ", "the", " ", "terms", " ", "in", " ", "the", " ", 
       RowBox[{"differential", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"outerPair", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"i", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"pairing", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"i", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"pairing", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}], "]"}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"counter", ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "innerPair", " ", "here", " ", "means", " ", "the", " ", "terms", " ", 
       "in", " ", "the", " ", 
       RowBox[{"integrand", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"innerIndexPair", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"i", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"pairing", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"i", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"pairing", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"i", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"i", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"counter", ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"innerDriftList", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"drift", ",", 
            RowBox[{
             RowBox[{"pairing", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Part", "[", 
           RowBox[{"drift", ",", 
            RowBox[{
             RowBox[{"pairing", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"drift", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"drift", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"counter", ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"innerCList", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"C", ",", 
            RowBox[{
             RowBox[{"pairing", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Part", "[", 
           RowBox[{"C", ",", 
            RowBox[{
             RowBox[{"pairing", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"C", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"C", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"counter", ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"XiLebesgue", "==", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "horizon", " ", "parameters", " ", "of", " ", "the", " ", 
         
         RowBox[{"integrand", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"innerIntervalList", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"pairing", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"pairing", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "6"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Use", " ", "the", " ", "three"}], "-", 
          RowBox[{
          "product", " ", "function", " ", "to", " ", "get", " ", "the", " ", 
           "expression", " ", "for", " ", "the", " ", "expectation", " ", 
           "in", " ", "the", " ", 
           RowBox[{"integrand", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"form", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"threeProductFImproved", "[", "\[IndentingNewLine]", 
            RowBox[{"XiLebesgue", ",", "\[IndentingNewLine]", 
             RowBox[{"innerIndexPair", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"innerIntervalList", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"innerDriftList", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"innerCList", "[", 
              RowBox[{"[", "counter", "]"}], "]"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "6"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Depending", " ", "on", " ", "the", " ", "different", " ", 
           "conditions", " ", "of", " ", "C1C2"}], ",", " ", 
          RowBox[{"split", " ", "into", " ", "different", " ", 
           RowBox[{"expressions", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"term", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"if", " ", "C1C2"}], "=", "1"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"C", ",", 
                 RowBox[{
                  RowBox[{"pairing", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
               RowBox[{"Part", "[", 
                RowBox[{"C", ",", 
                 RowBox[{
                  RowBox[{"pairing", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "===", "1"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{
                "Since", " ", "the", " ", "output", " ", "of", " ", "three"}],
                 "-", 
                RowBox[{
                "product", " ", "is", " ", "a", " ", "length", " ", "2", " ", 
                 "list"}]}], ",", " ", 
               RowBox[{
               "with", " ", "information", " ", "of", " ", "the", " ", "two", 
                " ", "parts", " ", "separately"}], ",", "\[IndentingNewLine]", 
               RowBox[{
               "thus", " ", "we", " ", "follows", " ", "its", " ", "pattern", 
                " ", "and", " ", "has", " ", "a", " ", "length", " ", "2", 
                " ", "list", " ", "with", " ", "separate", " ", "information",
                 " ", "of", " ", "the", " ", "two", " ", 
                RowBox[{"parts", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                "first", " ", "part", " ", "of", " ", "the", " ", "output", 
                 " ", "of", " ", "three"}], "-", "product"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "expression", " ", "of", " ", "first", " ", "part", " ", 
                  "of", " ", 
                  RowBox[{"term1", "."}]}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"t", "*", 
                  RowBox[{"KroneckerDelta", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                  RowBox[{"Part", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "integral", " ", "with", " ", "respect", " ", "to", " ", 
                   "v"}], "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"v", ",", "0", ",", 
                   RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "]"}]}], "}"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "integral", " ", "with", " ", "respect", " ", "to", " ", 
                   "z"}], "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"Part", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"Kronecker", " ", "delta", " ", "term"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"KroneckerDelta", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                  RowBox[{"Part", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "3"}], "]"}]}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                 "second", " ", "part", " ", "of", " ", "the", " ", "output", 
                  " ", "of", " ", "three"}], "-", "product"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "expression", " ", "of", " ", "second", " ", "part", " ", 
                  "of", " ", 
                  RowBox[{"term1", "."}]}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"t", "*", 
                  RowBox[{"KroneckerDelta", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                  RowBox[{"Part", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "integral", " ", "with", " ", "respect", " ", "to", " ", 
                   "v"}], "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"v", ",", "0", ",", 
                   RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "]"}]}], "}"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "integral", " ", "with", " ", "respect", " ", "to", " ", 
                   "z"}], "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"Part", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"Kronecker", " ", "delta", " ", "term"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"KroneckerDelta", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                  RowBox[{"Part", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "3"}], "]"}]}]}], 
                "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Else", " ", "if", " ", "C1C2"}], "=", 
               RowBox[{"1", "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"t", "-", "u"}], ")"}], "."}]}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"C", ",", 
                   RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
                 RowBox[{"Part", "[", 
                  RowBox[{"C", ",", 
                   RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "===", 
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{"t", "-", "u"}], ")"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "The", " ", "rest", " ", "follows", " ", "the", " ", "logic", 
                 " ", 
                 RowBox[{"above", "."}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "v"}], ")"}]}], "*", 
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"v", ",", "0", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "]"}]}], "}"}],
                    ",", "\[IndentingNewLine]", 
                   RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "3"}], "]"}]}]}], 
                  "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "v"}], ")"}]}], "*", 
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"v", ",", "0", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "]"}]}], "}"}],
                    ",", "\[IndentingNewLine]", 
                   RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "3"}], "]"}]}]}], 
                  "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"Else", " ", "if", " ", "C1C2"}], "=", 
                 RowBox[{"1", "/", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"t", "-", "u"}], ")"}], "^", "2."}]}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"1", "/", "t"}], "*", 
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "v"}], ")"}], "^", "2"}], ")"}]}], "*", 
                    
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"v", ",", "0", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "]"}]}], "}"}],
                    ",", "\[IndentingNewLine]", 
                   RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "3"}], "]"}]}]}], 
                  "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"1", "/", "t"}], "*", 
                    RowBox[{"1", "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "v"}], ")"}], "^", "2"}]}], "*", 
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"v", ",", "0", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "]"}]}], "}"}],
                    ",", "\[IndentingNewLine]", 
                   RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "3"}], "]"}]}]}], 
                  "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
                "}"}]}], "\[IndentingNewLine]", "]"}]}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "6"}], "}"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Else", " ", "if", " ", "XiLebesgue"}], "==", "True"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"innerIntervalList", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"pairing", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"pairing", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "6"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"form", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"threeProductFImproved", "[", "\[IndentingNewLine]", 
            RowBox[{"XiLebesgue", ",", "\[IndentingNewLine]", 
             RowBox[{"innerIndexPair", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"innerIntervalList", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"innerDriftList", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"innerCList", "[", 
              RowBox[{"[", "counter", "]"}], "]"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "6"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"term", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"C", ",", 
                 RowBox[{
                  RowBox[{"pairing", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
               RowBox[{"Part", "[", 
                RowBox[{"C", ",", 
                 RowBox[{
                  RowBox[{"pairing", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "===", "1"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"t", "*", 
                  RowBox[{"KroneckerDelta", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                  RowBox[{"Part", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"v", ",", "0", ",", 
                   RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "]"}]}], "}"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Part", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "Now", " ", "we", " ", "this", " ", "extra", " ", 
                   "integral", " ", "with", " ", "respect", " ", "to", " ", 
                   RowBox[{"\[Xi]", "."}]}], "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"Part", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "3"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"KroneckerDelta", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                  RowBox[{"Part", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "4"}], "]"}]}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"t", "*", 
                  RowBox[{"KroneckerDelta", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                  RowBox[{"Part", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"v", ",", "0", ",", 
                   RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "]"}]}], "}"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Part", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Part", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "3"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"KroneckerDelta", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                  RowBox[{"Part", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "4"}], "]"}]}]}], 
                "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Else", " ", "if"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"C", ",", 
                   RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
                 RowBox[{"Part", "[", 
                  RowBox[{"C", ",", 
                   RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "===", 
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{"t", "-", "u"}], ")"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "v"}], ")"}]}], "*", 
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"v", ",", "0", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "]"}]}], "}"}],
                    ",", "\[IndentingNewLine]", 
                   RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "3"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "4"}], "]"}]}]}], 
                  "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "v"}], ")"}]}], "*", 
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"v", ",", "0", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "]"}]}], "}"}],
                    ",", "\[IndentingNewLine]", 
                   RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "3"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "4"}], "]"}]}]}], 
                  "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", "Else", "*)"}], "\[IndentingNewLine]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"1", "/", "t"}], "*", 
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "v"}], ")"}], "^", "2"}], ")"}]}], "*", 
                    
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"v", ",", "0", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "]"}]}], "}"}],
                    ",", "\[IndentingNewLine]", 
                   RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "3"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "4"}], "]"}]}]}], 
                  "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"1", "/", "t"}], "*", 
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "v"}], ")"}], "^", "2"}], ")"}]}], "*", 
                    
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"v", ",", "0", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Part", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"pairing", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "]"}]}], "}"}],
                    ",", "\[IndentingNewLine]", 
                   RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "3"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"outerPair", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"form", "[", 
                    RowBox[{"[", "counter", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "4"}], "]"}]}]}], 
                  "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
                "}"}]}], "\[IndentingNewLine]", "]"}]}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "6"}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "term"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.908795495349468*^9, 3.908795865872505*^9}, {
  3.908795903917926*^9, 3.908795988652982*^9}, {3.908796107741454*^9, 
  3.90879624178384*^9}, {3.909402777778541*^9, 3.90940278949522*^9}, {
  3.920621072401641*^9, 3.920621156070154*^9}, {3.9206212301600647`*^9, 
  3.920621236900807*^9}, {3.920621439402306*^9, 3.920621455227469*^9}, {
  3.920621519189201*^9, 3.920621700760731*^9}, {3.920621941639344*^9, 
  3.920621958133274*^9}, {3.920621992651916*^9, 3.92062233466943*^9}, {
  3.920622371955987*^9, 3.920622424785939*^9}, {3.920622486784027*^9, 
  3.920622533629803*^9}, {3.920622608654051*^9, 3.920622623573753*^9}, {
  3.921038597242025*^9, 3.921038604770625*^9}},
 CellLabel->"In[41]:=",
 CloudRendering -> 
 "InteractiveBoxes",ExpressionUUID->"8c591470-cb00-4e60-8973-f2cdc5f5cd6e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Five-Product Form2 Evaluation", "Subchapter",
 CellChangeTimes->{{3.9206228015960817`*^9, 
  3.920622804619516*^9}},ExpressionUUID->"189a3ee7-7ada-4669-a260-\
5f3dd18f7f96"],

Cell["\<\
The idea follows the evaluation function before. The main difference in this \
case is that, since we have list of lists of lists, we flatten it first and \
then evaluate. We can do this since every sub-sub-list contains all the \
information for evaluation.\
\>", "Text",
 CellChangeTimes->{{3.920622645935191*^9, 
  3.9206227625809593`*^9}},ExpressionUUID->"4893a9cf-c8c5-47d9-ae5b-\
9529482afe0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fiveProductFImprovedForm2Eval", "[", "\[IndentingNewLine]", 
   RowBox[{
   "XiLebesgue_", ",", "\[IndentingNewLine]", "extraCoeff_", ",", 
    "\[IndentingNewLine]", "expression_", ",", "\[IndentingNewLine]", "b1_", 
    ",", "\[IndentingNewLine]", "b2_", ",", "\[IndentingNewLine]", "b3_", ",",
     "\[IndentingNewLine]", "b4_", ",", "\[IndentingNewLine]", "b5_"}], "]"}],
   ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"expressionNew", "=", 
      RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
       RowBox[{"expression", "\[IndentingNewLine]", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"XiLebesgue", "==", "False"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Total", "[", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Integrate", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"extraCoeff", "*", 
               RowBox[{"Coefficient", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"expressionNew", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"expressionNew", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "\[IndentingNewLine]", 
                "]"}]}], "\[IndentingNewLine]", ",", "b1", ",", "b2", ",", 
              "b3", ",", "b4", ",", "b5", ",", 
              RowBox[{
               RowBox[{"expressionNew", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"expressionNew", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}],
             "*", 
            RowBox[{
             RowBox[{"expressionNew", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "12"}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Else", " ", "if", " ", "XiLebesgue"}], "==", "True"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Total", "[", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Integrate", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"extraCoeff", "*", 
               RowBox[{"Coefficient", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"expressionNew", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"expressionNew", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "5", "]"}], "]"}]}], "\[IndentingNewLine]", 
                "]"}]}], "\[IndentingNewLine]", ",", "b1", ",", "b2", ",", 
              "b3", ",", "b4", ",", "b5", ",", 
              RowBox[{
               RowBox[{"expressionNew", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"expressionNew", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"expressionNew", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}],
             "*", 
            RowBox[{
             RowBox[{"expressionNew", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "12"}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9087962825004816`*^9, 3.908796348131281*^9}, {
  3.909402350553008*^9, 3.909402382969808*^9}, {3.909402492424757*^9, 
  3.909402502114552*^9}, {3.9094025435299597`*^9, 3.909402578368978*^9}, {
  3.909402813039381*^9, 3.909402837997428*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"f8b00002-a7f0-4222-976a-68dcef50ce38"],

Cell["", "Section",ExpressionUUID->"f35a845a-d1ae-48be-ba89-a45ffae60105"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Four-Product with two Expandable terms in  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "37c50dd7-ac52-4f73-9022-e0b3ad4cff92"],
 "."
}], "Chapter",
 CellChangeTimes->{{3.920622923439682*^9, 
  3.920622991588845*^9}},ExpressionUUID->"e3b369e7-2e32-42d4-9da3-\
4f19ab9f3538"],

Cell[TextData[{
 "We consider \n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"]}]], 
                 SubscriptBox[
                  StyleBox["C", "TI"], "1"], 
                 SubsuperscriptBox[
                  RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                  StyleBox["u", "TI"], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "1"]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "2"]}]], 
                 SubscriptBox[
                  StyleBox["C", "TI"], "2"], 
                 SubsuperscriptBox[
                  RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                  StyleBox["u", "TI"], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "2"]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "3"]}]], 
                 SubscriptBox[
                  StyleBox["C", "TI"], "3"], 
                 SubsuperscriptBox[
                  RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                  StyleBox["u", "TI"], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "3"]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 SubsuperscriptBox["\[Integral]", "0", 
                  RowBox[{
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "4"]}]], "\[CapitalXi]", 
                 RowBox[{"(", 
                   RowBox[{
                    StyleBox["u", "TI"], ";", 
                    SubscriptBox[
                    StyleBox["i", "TI"], "5"], ",", 
                    SubscriptBox[
                    StyleBox["i", "TI"], "6"]}], ")"}], 
                 SubsuperscriptBox[
                  RowBox[{"(", 
                    RowBox[{"\[Sigma]", 
                    StyleBox["d", "TI"], 
                    StyleBox["B", "TI"]}], ")"}], 
                  StyleBox["u", "TI"], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "4"]]}], ")"}]}], "]"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\mathbb{E}\\left[\\left(\\int_{0}^{ta_{1}}C_{1}(\\sigma \
dB)_{u}^{i_{1}}\\right)\\left(\\int_{0}^{ta_{2}}C_{2}(\\sigma dB)_{u}^{i_{2}}\
\\right)\\left(\\int_{0}^{ta_{3}}C_{3}(\\sigma dB)_{u}^{i_{3}}\\right)\\left(\
\\int_{0}^{ta_{4}}\\Xi(u;i_{5},i_{6})(\\sigma \
dB)_{u}^{i_{4}}\\right)\\right]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "fa4ca36d-a1a4-4e21-b9a6-c836c1805e64"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ac770a84-4764-430c-99f7-07f0c9347cd5"],
 " contains two stochastic integrals with expandable integrands (or Lebesgue \
integral of two stochastic integrals with expandable integrand), and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], 
          StyleBox["i", "TI"]], "\[Element]", 
         RowBox[{"{", 
           RowBox[{"1", ",", 
             FractionBox["1", 
              RowBox[{
                StyleBox["t", "TI"], "-", 
                StyleBox["u", "TI"]}]]}], "}"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "C_i \\in \\{1,\\frac{1}{t-u}\\}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f03bd9b3-02ee-40cf-bd97-02324272aadf"],
 ".\n\nDenote\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox[
          StyleBox["X", "TI"], 
          StyleBox["s", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "1"]], ":", "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["s", "TI"]], 
         SubscriptBox[
          StyleBox["C", "TI"], "1"], 
         SubsuperscriptBox[
          RowBox[{"(", 
            RowBox[{"\[Sigma]", 
              StyleBox["d", "TI"], 
              StyleBox["B", "TI"]}], ")"}], 
          StyleBox["u", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "1"]], ",  ", 
         SubsuperscriptBox[
          StyleBox["Y", "TI"], 
          StyleBox["s", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "2"]], ":", "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["s", "TI"]], 
         SubscriptBox[
          StyleBox["C", "TI"], "2"], 
         SubsuperscriptBox[
          RowBox[{"(", 
            RowBox[{"\[Sigma]", 
              StyleBox["d", "TI"], 
              StyleBox["B", "TI"]}], ")"}], 
          StyleBox["u", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "2"]], ",  ", 
         SubsuperscriptBox[
          StyleBox["Z", "TI"], 
          StyleBox["s", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "3"]], ":", "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["s", "TI"]], 
         SubscriptBox[
          StyleBox["C", "TI"], "3"], 
         SubsuperscriptBox[
          RowBox[{"(", 
            RowBox[{"\[Sigma]", 
              StyleBox["d", "TI"], 
              StyleBox["B", "TI"]}], ")"}], 
          StyleBox["u", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "3"]], ",  ", 
         SubsuperscriptBox[
          StyleBox["Q", "TI"], 
          StyleBox["s", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "4"]], ":", "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["s", "TI"]], "\[CapitalXi]", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["u", "TI"], ";", 
             SubscriptBox[
              StyleBox["i", "TI"], "5"], ",", 
             SubscriptBox[
              StyleBox["i", "TI"], "6"]}], ")"}], 
         SubsuperscriptBox[
          RowBox[{"(", 
            RowBox[{"\[Sigma]", 
              StyleBox["d", "TI"], 
              StyleBox["B", "TI"]}], ")"}], 
          StyleBox["u", "TI"], 
          SubscriptBox[
           StyleBox["i", "TI"], "4"]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "X_{s}^{i_{1}}:=\\int_{0}^{s}C_{1}(\\sigma dB)_{u}^{i_{1}},\\quad \
Y_{s}^{i_{2}}:=\\int_{0}^{s}C_{2}(\\sigma dB)_{u}^{i_{2}},\\quad \
Z_{s}^{i_{3}}:=\\int_{0}^{s}C_{3}(\\sigma dB)_{u}^{i_{3}}, \\quad \
Q_{s}^{i_{4}}:=\\int_{0}^{s}\\Xi(u;i_{5},i_{6})(\\sigma dB)_{u}^{i_{4}}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b747fef4-a2a7-4e97-b3e4-5f724434d553"],
 ",\nand ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Alpha]", ":", "\[LongEqual]", "max", 
         RowBox[{"(", 
           RowBox[{
             SubscriptBox[
              StyleBox["a", "TI"], "1"], ",", 
             SubscriptBox[
              StyleBox["a", "TI"], "2"], ",", 
             SubscriptBox[
              StyleBox["a", "TI"], "3"], ",", 
             SubscriptBox[
              StyleBox["a", "TI"], "4"]}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\alpha:=\\max(a_{1},a_{2},a_{3},a_{4})", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a89f8e25-8cbb-4f06-88f9-4e8970a1d7ce"],
 ". By Ito\[CloseCurlyQuote]s lemma, the expression can be written as\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", "three terms of the form ", 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{
                StyleBox["t", "TI"], "\[Alpha]"}]], 
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "2"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["X", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "1"]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["Q", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "4"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "4"]]}], ")"}]}], "]"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "=\\text{three terms of the form \
}\\mathbb{E}\\left[\\int_{0}^{t\\alpha}Y_{\\min(s,ta_{2})}^{i_{2}}Z_{\\min(s,\
ta_{3})}^{i_{3}}(dX_{\\min(s,ta_{1})}^{i_{1}})(dQ_{\\min(s,ta_{4})}^{i_{4}})\\\
right]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ff3e4cfb-d557-40cd-b4fb-58042cf9e697"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"+", "three terms of the form ", 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{
                StyleBox["t", "TI"], "\[Alpha]"}]], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["Q", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "4"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "4"]], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["X", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "1"]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["Y", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "2"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "2"]]}], ")"}]}], "]"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "+\\text{three terms of the form \
}\\mathbb{E}\\left[\\int_{0}^{t\\alpha}Z_{\\min(s,ta_{3})}^{i_{3}}Q_{\\min(s,\
ta_{4})}^{i_{4}}(dX_{\\min(s,ta_{1})}^{i_{1}})(dY_{\\min(s,ta_{2})}^{i_{2}})\\\
right]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "560034da-1d76-497a-83bf-bcebbc6a923d"],
 ".\nLet\[CloseCurlyQuote]s call the first kind of form \[OpenCurlyQuote]",
 StyleBox["form 1",
  FontVariations->{"Underline"->True}],
 "\[CloseCurlyQuote], and the other \[OpenCurlyQuote]",
 StyleBox["form 2",
  FontVariations->{"Underline"->True}],
 "\[CloseCurlyQuote]. "
}], "Text",
 CellChangeTimes->{{3.920623000955078*^9, 3.920623138084077*^9}, {
  3.920623176201502*^9, 3.920623254511841*^9}, {3.920623315729381*^9, 
  3.9206233160094013`*^9}},ExpressionUUID->"3652ab7c-bf59-45cd-a8cb-\
1de406724c98"],

Cell[CellGroupData[{

Cell[TextData[{
 "Four Product with Two Expansion in ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9b1ddb0f-b155-4da4-ab7a-ef83f8d87219"],
 ", Form 1."
}], "Subchapter",
 CellChangeTimes->{{3.908798938759798*^9, 3.908799013551378*^9}, {
   3.908799060374941*^9, 3.90879912265516*^9}, 
   3.920622986805296*^9},ExpressionUUID->"4952b58e-3154-4963-a922-\
7e2ad90b6b08"],

Cell[TextData[{
 "\nLet\[CloseCurlyQuote]s study the specific term ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{
                StyleBox["t", "TI"], "\[Alpha]"}]], 
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "2"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["X", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "1"]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["Q", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "4"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "4"]]}], ")"}]}], "]"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\mathbb{E}\\left[\\int_{0}^{t\\alpha}Y_{\\min(s,ta_{2})}^{i_{2}}Z_{\\\
min(s,ta_{3})}^{i_{3}}(dX_{\\min(s,ta_{1})}^{i_{1}})(dQ_{\\min(s,ta_{4})}^{i_{\
4}})\\right]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2e0ab37c-d7b5-4858-92c3-d8acf55abe5c"],
 ", and the rest of the terms are just a permutation of  indices and \
parameters. We have\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "4"]}]], "\[CenterDot]", 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{
                StyleBox["t", "TI"], "\[Alpha]"}]], 
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "2"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             RowBox[{"{", 
               SubscriptBox[
                StyleBox["C", "TI"], "1"], "}"}], "\[CapitalXi]", 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["s", "TI"], ";", 
                 SubscriptBox[
                  StyleBox["i", "TI"], "5"], ",", 
                 SubscriptBox[
                  StyleBox["i", "TI"], "6"]}], ")"}], 
             SubscriptBox["1", 
              RowBox[{"{", 
                RowBox[{"0", "\[LessEqual]", 
                  StyleBox["s", "TI"], "\[LessEqual]", "min", 
                  RowBox[{"(", 
                    RowBox[{
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "4"]}], ")"}]}], "}"}]], 
             StyleBox["d", "TI"], 
             StyleBox["s", "TI"]}], "]"}]}], TraditionalForm], "errors" -> {},
      "input" -> 
     "=\\delta_{i_{1},i_{4}}\\cdot\\mathbb{E}\\left[\\int_{0}^{t\\alpha}Y_{\\\
min(s,ta_{2})}^{i_{2}}Z_{\\min(s,ta_{3})}^{i_{3}}\\{C_{1}\\}\\Xi(s;i_{5},i_{6}\
)\\bm{1}_{\\{0\\leq s\\leq\\min(ta_{1},ta_{4})\\}}ds\\right]", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4999c0bb-df1c-4d96-9e8d-fee9112dd20b"],
 ".\n\nIf ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8fa781e1-c0c3-4727-9c21-ba40382b5b4d"],
 " does not contain Lebesgue integral, then after expansion we will have \
product of two stochastic integrals directly, i.e. \n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalXi]", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["t", "TI"], 
             StyleBox["v", "TI"], ";", 
             SubscriptBox[
              StyleBox["i", "TI"], "5"], ",", 
             SubscriptBox[
              StyleBox["i", "TI"], "6"]}], ")"}], "\[LongEqual]", 
         StyleBox["g", "TI"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["t", "TI"], ",", 
             StyleBox["v", "TI"]}], ")"}], 
         SubsuperscriptBox[
          StyleBox["P", "TI"], 
          RowBox[{
            StyleBox["t", "TI"], 
            StyleBox["v", "TI"]}], 
          SubscriptBox[
           StyleBox["i", "TI"], "5"]], 
         SubsuperscriptBox[
          StyleBox["L", "TI"], 
          RowBox[{
            StyleBox["t", "TI"], 
            StyleBox["v", "TI"]}], 
          SubscriptBox[
           StyleBox["i", "TI"], "6"]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi(tv;i_{5},i_{6})=g(t,v)P_{tv}^{i_{5}}L_{tv}^{i_{6}}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2326126d-2d3d-4d8f-bf80-5ceb37fb9b7b"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["g", "TI"], "(", 
         RowBox[{
           StyleBox["t", "TI"], ",", 
           StyleBox["v", "TI"]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "g(t,v)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2e2318d7-060c-4fed-9690-fad802b19f6a"],
 " comes from the expansion.\n\nCondition 1: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "1"], "\[LongEqual]", "1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "C_1=1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5d1755d0-00c4-4df5-b8c9-dbca29aac41a"],
 ". Change of variable, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["s", "TI"], "\[LongEqual]", 
         StyleBox["t", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "s=tv", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "75ef78b7-e483-43a0-bb4a-ae8439cf2d87"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "4"]}]], "\[CenterDot]", 
         StyleBox["t", "TI"], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "1"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "4"]}], ")"}]], 
         StyleBox["g", "TI"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["t", "TI"], ",", 
             StyleBox["v", "TI"]}], ")"}], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["v", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "2"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["v", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "3"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["P", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], 
                StyleBox["v", "TI"]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "5"]], 
             SubsuperscriptBox[
              StyleBox["L", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], 
                StyleBox["v", "TI"]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "6"]]}], "]"}], 
         StyleBox["d", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "=\\delta_{i_{1},i_{4}}\\cdot \
t\\cdot\\int_{0}^{\\min(a_{1},a_{4})}g(t,v)\\mathbb{E}\\left[Y_{t\\min(v,a_{2}\
)}^{i_{2}}Z_{t\\min(v,a_{3})}^{i_{3}}P_{tv}^{i_{5}}L_{tv}^{i_{6}}\\right]dv", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6ccf66bb-912b-40a4-8e7d-8be10912747b"],
 ".\n\nCondition 2: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "1"], "\[LongEqual]", 
         FractionBox["1", 
          RowBox[{
            StyleBox["t", "TI"], "-", 
            StyleBox["u", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "C_1=\\frac{1}{t-u}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "08834a00-b01d-46b3-a75e-55e0f66b6f02"],
 ". Change of variable, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["s", "TI"], "\[LongEqual]", 
         StyleBox["t", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "s=tv", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3a2ab41b-faaa-4952-8675-3e78eaee8292"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "4"]}]], 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "1"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "4"]}], ")"}]], 
         FractionBox["1", 
          RowBox[{"1", "-", 
            StyleBox["v", "TI"]}]], 
         StyleBox["g", "TI"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["t", "TI"], ",", 
             StyleBox["v", "TI"]}], ")"}], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["v", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "2"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["v", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "3"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["P", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], 
                StyleBox["v", "TI"]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "5"]], 
             SubsuperscriptBox[
              StyleBox["L", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], 
                StyleBox["v", "TI"]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "6"]]}], "]"}], 
         StyleBox["d", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "=\\delta_{i_{1},i_{4}}\\int_{0}^{\\min(a_{1},a_{4})}\\frac{1}{1-v}g(t,v)\
\\mathbb{E}\\left[Y_{t\\min(v,a_{2})}^{i_{2}}Z_{t\\min(v,a_{3})}^{i_{3}}P_{tv}\
^{i_{5}}L_{tv}^{i_{6}}\\right]dv", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c0a01266-ef8c-4527-a4b7-e349ec14160e"],
 ".\n\nIf ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "289191b1-f6ae-46e6-bc3d-b2f028468a42"],
 " contains Lebesgue integral, then after expansion ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4c7eedf8-6f0c-4d5a-a0f0-c5340fca8005"],
 " may be Lebesgue of two stochastic integrals, or Lebesgue of only one \
stochastic integral, i.e. \n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalXi]", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["t", "TI"], 
             StyleBox["v", "TI"], ";", 
             SubscriptBox[
              StyleBox["i", "TI"], "5"], ",", 
             SubscriptBox[
              StyleBox["i", "TI"], "6"]}], ")"}], "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["v", "TI"]], 
         StyleBox["g", "TI"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["t", "TI"], ",", "\[Eta]"}], ")"}], 
         SubsuperscriptBox[
          StyleBox["P", "TI"], 
          RowBox[{
            StyleBox["t", "TI"], "\[Eta]"}], 
          SubscriptBox[
           StyleBox["i", "TI"], "5"]], 
         SubsuperscriptBox[
          StyleBox["L", "TI"], 
          RowBox[{
            StyleBox["t", "TI"], "\[Eta]"}], 
          SubscriptBox[
           StyleBox["i", "TI"], "6"]], 
         StyleBox["d", "TI"], "\[Eta]", ","}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\Xi(tv;i_{5},i_{6})=\\int_{0}^{v}g(t,\\eta)P_{t\\eta}^{i_{5}}L_{t\\eta}\
^{i_{6}}d\\eta,", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "fc541e8f-37c1-4fbf-89c7-32d5a681eefa"],
 " \nor\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalXi]", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["t", "TI"], 
             StyleBox["v", "TI"], ";", 
             SubscriptBox[
              StyleBox["i", "TI"], "5"], ",", 
             SubscriptBox[
              StyleBox["i", "TI"], "6"]}], ")"}], "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["v", "TI"]], 
         StyleBox["g", "TI"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["t", "TI"], ",", "\[Eta]", ",", 
             StyleBox["v", "TI"]}], ")"}], 
         SubsuperscriptBox[
          StyleBox["P", "TI"], 
          RowBox[{
            StyleBox["t", "TI"], "\[Eta]"}], 
          SubscriptBox[
           StyleBox["i", "TI"], "5"]], 
         SubsuperscriptBox[
          StyleBox["L", "TI"], 
          RowBox[{
            StyleBox["t", "TI"], 
            StyleBox["v", "TI"]}], 
          SubscriptBox[
           StyleBox["i", "TI"], "6"]], 
         StyleBox["d", "TI"], "\[Eta]", ","}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\Xi(tv;i_{5},i_{6})=\\int_{0}^{v}g(t,\\eta,v)P_{t\\eta}^{i_{5}}L_{tv}^{\
i_{6}}d\\eta,", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "608c4d6f-8ace-46e8-b019-f6f7ecbcc193"],
 "\nwhere ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["g", "TI"], "(", 
         RowBox[{
           StyleBox["t", "TI"], ",", "\[Eta]", ",", 
           StyleBox["v", "TI"]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "g(t,\\eta,v)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e925bffb-f3c3-453c-ae05-29ece823fdcd"],
 " comes from the expansion. We use the notation ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{"\[Eta]", ",", 
           StyleBox["v", "TI"]}], "}"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\{\\eta,v\\}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "881d0e7f-0dc3-4537-9e9e-2a24f3aa2ad6"],
 " to denote that the value is chosen to be either ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Eta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7d1b4ebc-c941-44a1-a263-8fd90aa333f9"],
 " or ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["v", "TI"], TraditionalForm], "errors" -> {}, "input" -> "v", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5fd6f5f5-11f4-42eb-bda5-f234353624d5"],
 ".\n\nCondition 1: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "1"], "\[LongEqual]", "1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "C_1=1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "51af3880-b1e8-42ff-96ee-8c1ad6b60acc"],
 ". Change of variable, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["s", "TI"], "\[LongEqual]", 
         StyleBox["t", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "s=tv", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "47413cb6-d689-4579-a0c8-9372b4f1e8f8"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "4"]}]], "\[CenterDot]", 
         StyleBox["t", "TI"], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "1"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "4"]}], ")"}]], 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["v", "TI"]], 
         StyleBox["g", "TI"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["t", "TI"], ",", "\[Eta]", ",", 
             StyleBox["v", "TI"]}], ")"}], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["v", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "2"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["v", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "3"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["P", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], 
                RowBox[{"{", 
                  RowBox[{"\[Eta]", ",", 
                    StyleBox["v", "TI"]}], "}"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "5"]], 
             SubsuperscriptBox[
              StyleBox["L", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], 
                RowBox[{"{", 
                  RowBox[{"\[Eta]", ",", 
                    StyleBox["v", "TI"]}], "}"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "6"]]}], "]"}], 
         StyleBox["d", "TI"], "\[Eta]", 
         StyleBox["d", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "=\\delta_{i_{1},i_{4}}\\cdot \
t\\cdot\\int_{0}^{\\min(a_{1},a_{4})}\\int_{0}^{v}g(t,\\eta,v)\\mathbb{E}\\\
left[Y_{t\\min(v,a_{2})}^{i_{2}}Z_{t\\min(v,a_{3})}^{i_{3}}P_{t\\{\\eta,v\\}}^\
{i_{5}}L_{t\\{\\eta,v\\}}^{i_{6}}\\right]d\\eta dv", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a70beb0f-3b74-4652-9998-27b346b8d0c4"],
 ".\n\nCondition 2: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "1"], "\[LongEqual]", 
         FractionBox["1", 
          RowBox[{
            StyleBox["t", "TI"], "-", 
            StyleBox["u", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "C_1=\\frac{1}{t-u}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8b91ec86-ba96-4951-afd6-3260fc0c091a"],
 ". Change of variable, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["s", "TI"], "\[LongEqual]", 
         StyleBox["t", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "s=tv", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4aaa5f82-b64b-419d-b6dd-e745bf99f5bf"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "4"]}]], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "1"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "4"]}], ")"}]], 
         FractionBox["1", 
          RowBox[{"1", "-", 
            StyleBox["v", "TI"]}]], 
         SubsuperscriptBox["\[Integral]", "0", 
          StyleBox["v", "TI"]], 
         StyleBox["g", "TI"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["t", "TI"], ",", "\[Eta]", ",", 
             StyleBox["v", "TI"]}], ")"}], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["Y", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["v", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "2"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "2"]], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["v", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "3"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["P", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], 
                RowBox[{"{", 
                  RowBox[{"\[Eta]", ",", 
                    StyleBox["v", "TI"]}], "}"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "5"]], 
             SubsuperscriptBox[
              StyleBox["L", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], 
                RowBox[{"{", 
                  RowBox[{"\[Eta]", ",", 
                    StyleBox["v", "TI"]}], "}"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "6"]]}], "]"}], 
         StyleBox["d", "TI"], "\[Eta]", 
         StyleBox["d", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "=\\delta_{i_{1},i_{4}}\\cdot\\int_{0}^{\\min(a_{1},a_{4})}\\frac{1}{1-v}\
\\int_{0}^{v}g(t,\\eta,v)\\mathbb{E}\\left[Y_{t\\min(v,a_{2})}^{i_{2}}Z_{t\\\
min(v,a_{3})}^{i_{3}}P_{t\\{\\eta,v\\}}^{i_{5}}L_{t\\{\\eta,v\\}}^{i_{6}}\\\
right]d\\eta dv", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "741937c7-6251-410f-9df5-4553d6123c7f"],
 ".\n\nWe can now use the four-product function to derive the expression."
}], "Text",
 CellChangeTimes->{{3.908800003710549*^9, 3.9088000279615498`*^9}, {
   3.908979662924011*^9, 3.908979664542504*^9}, 3.908980750871828*^9, {
   3.920623427016424*^9, 3.920623480290756*^9}, {3.920623707171513*^9, 
   3.920623763781385*^9}, {3.920624179108363*^9, 3.920624205422037*^9}, {
   3.920624242063449*^9, 3.920624288826324*^9}, {3.920624367220285*^9, 
   3.920624431216957*^9}, {3.920624471149958*^9, 3.920624477982174*^9}, {
   3.920624565996158*^9, 3.920624671593156*^9}, {3.920624797891859*^9, 
   3.920624865635814*^9}, {3.920624924582264*^9, 3.920624947934203*^9}, {
   3.921038142952204*^9, 3.921038174408894*^9}, {3.921038648468335*^9, 
   3.921038649170034*^9}, 
   3.921039026476882*^9},ExpressionUUID->"d16cf9ae-9617-4742-ab94-\
987d38cd3b4a"],

Cell[CellGroupData[{

Cell["Inputs:", "Subsection",
 CellChangeTimes->{{3.9210386525330477`*^9, 
  3.921038680704668*^9}},ExpressionUUID->"9db7a8ba-d586-4891-8e13-\
fc6a8a76cbd9"],

Cell[TextData[{
 "XiLebesgue: boolean valued, whether ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7300a639-5c1e-4286-8537-707e914729fc"],
 " contains Lebesgue integral.\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["i", "TI"], TraditionalForm], "errors" -> {}, "input" -> "i", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "534be6f0-a449-4200-b939-bc4868ef744f"],
 ": list valued, length 6, stands for the index list ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{
           SubscriptBox[
            StyleBox["i", "TI"], "1"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "2"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "3"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "4"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "5"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "6"]}], "}"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\{i_{1},i_{2},i_{3},i_{4},i_{5},i_{6}\\}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "844928dc-0419-4c7e-9da3-68dba94bdcc0"],
 ". ",
 StyleBox["In particular, ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["i", "TI"], "5"], TraditionalForm], "errors" -> {}, "input" -> 
     "i_{5}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7b333f94-bf7d-4864-8a9e-371e1666d755"],
 StyleBox[" and  ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["i", "TI"], "6"], TraditionalForm], "errors" -> {}, "input" -> 
     "i_{6}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "accd251e-3776-49de-bac5-e50098a23c7c"],
 StyleBox[" must be the index of ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "709fba2a-1e40-4faa-a87a-a7da14d65cf5"],
 StyleBox[".\n",
  FontWeight->"Bold"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["a", "TI"], TraditionalForm], "errors" -> {}, "input" -> "a", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "adcf08d4-cd77-4b5b-ab68-cff967ce72a9"],
 ": list valued, length 6. The first four position stands for the time \
horizon parameters ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{
           SubscriptBox[
            StyleBox["a", "TI"], "1"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "2"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "3"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "4"]}], "}"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\{a_{1},a_{2},a_{3},a_{4}\\}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b7d63e4a-7eef-49d9-81b3-c6bdc7cf4c81"],
 " of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["X", "TI"], ",", 
         StyleBox["Y", "TI"], ",", 
         StyleBox["Z", "TI"], ",", 
         StyleBox["Q", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "X,Y,Z,Q", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e0c4bd5f-a77f-44cc-afa2-f937fb52fba5"],
 ". The last two position stands for the choice of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Eta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "095aa19b-831a-41bd-bbe6-771751d625eb"],
 " or ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["v", "TI"], TraditionalForm], "errors" -> {}, "input" -> "v", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "bc574d89-747f-4f5f-8838-47d24b588127"],
 ". If XiLebesgue=True, then will be values chosen from ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{"\[Eta]", ",", 
           StyleBox["v", "TI"]}], "}"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\{\\eta,v\\}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e24a795f-6d73-41e9-8fe2-5e739b6a5941"],
 " depending on the expansion. If XiLebesgue=False, then set both to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["v", "TI"], TraditionalForm], "errors" -> {}, "input" -> "v", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5d96871b-5f67-4a3c-b704-dd9bd18f1aa7"],
 ".\n(According to the calculation, the last two inputs will affect the \
result only if the XiLebesgue is True, and the input will depend on the \
expansion. If XiLebesgue is False, it will not affect the result, and by \
default we would just use ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["v", "TI"], TraditionalForm], "errors" -> {}, "input" -> "v", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "289a16b5-b188-44a2-a111-6b6d86a0794c"],
 " to be consistent with the calculation above.)\n\ndrift: list valued, \
length 6, stands for the drift terms of the stochastic integrals. They are \
actually all {0,0,0,0,0,0}.\n\nC: list valued, length 6, stands for the \
coefficient term in front of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubsuperscriptBox[
        RowBox[{"(", 
          RowBox[{"\[Sigma]", 
            StyleBox["d", "TI"], 
            StyleBox["B", "TI"]}], ")"}], 
        StyleBox["u", "TI"], 
        StyleBox["i", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "(\\sigma dB)_{u}^{i}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5a686ba1-0d2e-4c47-8b1e-77e003f4eb2c"],
 ". ",
 StyleBox["In particular, C[[4]] should always be 1 since we treat ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"7105af75-4586-41b2-ae7c-f831ecc71e50"],
 StyleBox[" as a special coefficient itself. And C[[5]], C[[6]] should just \
be the coefficients taking values in {1,",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox["1", 
        RowBox[{
          StyleBox["t", "TI"], "-", 
          StyleBox["u", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\frac{1}{t-u}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9ba8b473-09b5-44e9-a041-561889735162"],
 StyleBox["}. This is now different from the previous cases since the input \
XiCoeff below will take account for the extra term coming from the expansion.",
  FontWeight->"Bold"],
 "\n\nXiCoeff: a function of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["v", "TI"], TraditionalForm], "errors" -> {}, "input" -> "v", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "48ede889-a3ae-41a9-afe0-873264bd3afb"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Eta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "fe6e9a1e-900a-4bc9-9cda-c6b00411a023"],
 ". Essentially it is the function ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["g", "TI"], "(", 
         RowBox[{
           StyleBox["t", "TI"], ",", "\[Eta]", ",", 
           StyleBox["v", "TI"]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "g(t,\\eta,v)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "12a93c0b-3230-48de-a498-4d5e83f36bd1"],
 " we mentioned in the above calculation. It will include all the extra terms \
from the expansion."
}], "Text",
 CellChangeTimes->{{3.921038684734079*^9, 3.92103882467866*^9}, {
  3.9210389174402103`*^9, 3.92103897691003*^9}, {3.921039055055591*^9, 
  3.92103926166949*^9}, {3.9210393068568153`*^9, 3.9210393605697813`*^9}, {
  3.92103940664685*^9, 3.921039521377258*^9}, {3.921039877209031*^9, 
  3.921039889767412*^9}, {3.921041518492912*^9, 3.92104152211557*^9}, {
  3.921041596403365*^9, 3.921041693274317*^9}, {3.921041808846901*^9, 
  3.921041819058373*^9}},ExpressionUUID->"eac58e38-bbe8-4999-800b-\
81aa7e866b2e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fourProductExpFForm1", "[", "\[IndentingNewLine]", 
   RowBox[{
   "XiLebesgue_", ",", "\[IndentingNewLine]", "i_", ",", " ", 
    "\[IndentingNewLine]", "a_", ",", "\[IndentingNewLine]", "drift_", ",", 
    "\[IndentingNewLine]", "C_", ",", " ", "\[IndentingNewLine]", 
    "XiCoeff_"}], " ", "\n", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"outerIndex", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "There", " ", "are", " ", "only", " ", "three", " ", "different", " ", 
        "combinations"}], ",", " ", 
       RowBox[{
       "so", " ", "we", " ", "do", " ", "the", " ", "pairing", " ", "of", " ",
         "indices", " ", 
        RowBox[{"directly", "."}]}]}], "*)"}], "\n", 
     RowBox[{"outerInterval", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"a", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"a", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"a", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
       "}"}]}], ";", "\n", 
     RowBox[{"outerC", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"C", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"C", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"C", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"The", " ", "indices", " ", "of", " ", "the", " ", 
       RowBox[{"integrand", "."}]}], "*)"}], "\n", 
     RowBox[{"innerIndex", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "}"}]}], ";", "\n", 
     RowBox[{"innerDrift", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"drift", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"drift", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"drift", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", 
          RowBox[{"drift", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"drift", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"drift", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"drift", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", 
          RowBox[{"drift", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"drift", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"drift", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"drift", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", 
          RowBox[{"drift", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "}"}]}], ";", "\n", 
     RowBox[{"innerC", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"C", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"C", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"C", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", 
          RowBox[{"C", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"C", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"C", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"C", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", 
          RowBox[{"C", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"C", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"C", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"C", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", 
          RowBox[{"C", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "}"}]}], ";", "\n", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"XiLebesgue", "==", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Recall", " ", "that", " ", "if", " ", "XiLebesgue", " ", "is", " ", 
          "True"}], ",", " ", 
         RowBox[{
         "then", " ", "the", " ", "input", " ", "of", " ", "last", " ", "two",
           " ", "position", " ", "of", " ", "a_", " ", "will", " ", "not", 
          " ", "affect", " ", "the", " ", "result", " ", "since", " ", "they",
           " ", "must", " ", "be", " ", "parameterised", " ", "by", " ", 
          RowBox[{"v", ".", " ", "Here"}], " ", "we", " ", "do", " ", "not", 
          " ", "use", " ", "them", " ", "at", " ", 
          RowBox[{"all", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"innerInterval", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", "v", ",", "v"}],
             "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", "v", ",", "v"}],
             "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "v", ",", "v"}],
             "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Use", " ", "four"}], "-", 
          RowBox[{
          "product", " ", "function", " ", "to", " ", "get", " ", "the", " ", 
           "expression", " ", "of", " ", "the", " ", 
           RowBox[{"expectation", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"form", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"outerIndex", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"outerIndex", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
            RowBox[{"fourProductF", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"innerIndex", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"innerInterval", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"innerDrift", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"innerC", "[", 
               RowBox[{"[", "counter", "]"}], "]"}]}], "\[IndentingNewLine]", 
             "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "3"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Depending", " ", "on", " ", "the", " ", "different", " ", "form", 
           " ", "of", " ", "C_i"}], ",", " ", 
          RowBox[{"produce", " ", "the", " ", "final", " ", 
           RowBox[{"expression", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"outerC", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], "===", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"t", "*", "XiCoeff", "*", 
                RowBox[{
                 RowBox[{"form", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"v", ",", "0", ",", 
                 RowBox[{"outerInterval", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"form", "[", 
                 RowBox[{"[", "counter", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"outerC", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], "===", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"t", "-", "u"}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", "v"}], ")"}]}], "*", "XiCoeff", "*", 
                RowBox[{
                 RowBox[{"form", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"v", ",", "0", ",", 
                 RowBox[{"outerInterval", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"form", "[", 
                 RowBox[{"[", "counter", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
              "}"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "3"}], "}"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Else", " ", "if", " ", "XiLebesgue"}], "==", "True"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Recall", " ", "that", " ", "if", " ", "XiLebesgue", " ", "is", " ", 
          "True"}], ",", " ", 
         RowBox[{
         "then", " ", "the", " ", "last", " ", "two", " ", "position", " ", 
          "of", " ", "a_", " ", "will", " ", "indeed", " ", "affect", " ", 
          "the", " ", 
          RowBox[{"result", ".", " ", "As"}], " ", "it", " ", "can", " ", 
          "be", " ", "seen"}], ",", " ", 
         RowBox[{
          RowBox[{
          "we", " ", "will", " ", "use", " ", "them", " ", "here", " ", "to", 
           " ", "determing", " ", "what", " ", "should", " ", "be", " ", 
           "the", " ", "time", " ", "horizon", " ", "parameter", " ", "of", 
           " ", "the", " ", "integrand", " ", "to", " ", "be", " ", "used", 
           " ", "to", " ", "get", " ", "the", " ", "expresion", " ", "of", 
           " ", "the", " ", "four"}], "-", 
          RowBox[{"product", " ", 
           RowBox[{"expectation", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"innerInterval", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"a", "[", 
              RowBox[{"[", "5", "]"}], "]"}], ",", 
             RowBox[{"a", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"a", "[", 
              RowBox[{"[", "5", "]"}], "]"}], ",", 
             RowBox[{"a", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{"v", ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"a", "[", 
              RowBox[{"[", "5", "]"}], "]"}], ",", 
             RowBox[{"a", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Use", " ", "four"}], "-", 
          RowBox[{
          "product", " ", "function", " ", "to", " ", "get", " ", "the", " ", 
           "expression", " ", "of", " ", "the", " ", 
           RowBox[{"expectation", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"form", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"outerIndex", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"outerIndex", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
            RowBox[{"fourProductF", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"innerIndex", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"innerInterval", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"innerDrift", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"innerC", "[", 
               RowBox[{"[", "counter", "]"}], "]"}]}], "\[IndentingNewLine]", 
             "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "3"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Depending", " ", "on", " ", "the", " ", "different", " ", "form", 
           " ", "of", " ", "C_i"}], ",", " ", 
          RowBox[{"produce", " ", "the", " ", "final", " ", 
           RowBox[{"expression", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"outerC", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], "===", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"t", "*", "XiCoeff", "*", 
                RowBox[{
                 RowBox[{"form", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"v", ",", "0", ",", 
                 RowBox[{"outerInterval", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Eta]", ",", "0", ",", "v"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"form", "[", 
                 RowBox[{"[", "counter", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"outerC", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], "===", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"t", "-", "u"}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", "v"}], ")"}]}], "*", "XiCoeff", "*", 
                RowBox[{
                 RowBox[{"form", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"v", ",", "0", ",", 
                 RowBox[{"outerInterval", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Eta]", ",", "0", ",", "v"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"form", "[", 
                 RowBox[{"[", "counter", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
              "}"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "3"}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "result"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.908799145825732*^9, 3.908799340102525*^9}, {
  3.908799394564697*^9, 3.908799404530797*^9}, {3.90897931451042*^9, 
  3.908979346487893*^9}, {3.9210399641757317`*^9, 3.921040013824743*^9}, {
  3.9210400646112747`*^9, 3.9210402043642063`*^9}, {3.92104023602282*^9, 
  3.921040298115827*^9}, {3.921040328960449*^9, 3.921040528616361*^9}},
 CellLabel->"In[43]:=",
 CloudRendering -> 
 "InteractiveBoxes",ExpressionUUID->"ce39a138-2306-4efe-b022-5b4b6a96c5ec"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Four Product with two Expansion in ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "050cbd75-68fb-483a-82d2-22c485450b1f"],
 ", Form 2."
}], "Subchapter",
 CellChangeTimes->{{3.908799350935793*^9, 
  3.908799359852105*^9}},ExpressionUUID->"446e3bec-fbc8-44aa-ab08-\
308597f66d2f"],

Cell[TextData[{
 "Now let\[CloseCurlyQuote]s move to form2. For form 2, \
let\[CloseCurlyQuote]s investigate a specific term ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{
                StyleBox["t", "TI"], "\[Alpha]"}]], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["Q", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "4"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "4"]], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["X", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "1"]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["Y", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "2"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "2"]]}], ")"}]}], "]"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\mathbb{E}\\left[\\int_{0}^{t\\alpha}Z_{\\min(s,ta_{3})}^{i_{3}}Q_{\\\
min(s,ta_{4})}^{i_{4}}(dX_{\\min(s,ta_{1})}^{i_{1}})(dY_{\\min(s,ta_{2})}^{i_{\
2}})\\right]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2c954ae3-1c4a-47bf-ae96-94bfe9f35708"],
 ". For the rest of the terms, it will just be a permutation of indices. We \
can calculate that \n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{
                StyleBox["t", "TI"], "\[Alpha]"}]], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["Q", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "4"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "4"]], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["X", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "1"]]}], ")"}], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["d", "TI"], 
                 SubsuperscriptBox[
                  StyleBox["Y", "TI"], 
                  RowBox[{"min", "(", 
                    RowBox[{
                    StyleBox["s", "TI"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "2"]}], ")"}], 
                  SubscriptBox[
                   StyleBox["i", "TI"], "2"]]}], ")"}]}], "]"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\mathbb{E}\\left[\\int_{0}^{t\\alpha}Z_{\\min(s,ta_{3})}^{i_{3}}Q_{\\\
min(s,ta_{4})}^{i_{4}}(dX_{\\min(s,ta_{1})}^{i_{1}})(dY_{\\min(s,ta_{2})}^{i_{\
2}})\\right]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0ce4a044-3d92-4a77-a3e7-85dbd8289e39"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "2"]}]], "\[CenterDot]", 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", "0", 
              RowBox[{
                StyleBox["t", "TI"], "\[Alpha]"}]], 
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["Q", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "4"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "4"]], 
             RowBox[{"{", 
               RowBox[{
                 SubscriptBox[
                  StyleBox["C", "TI"], "1"], 
                 SubscriptBox[
                  StyleBox["C", "TI"], "2"]}], "}"}], 
             SubscriptBox["1", 
              RowBox[{"{", 
                RowBox[{"0", "\[LessEqual]", 
                  StyleBox["s", "TI"], "\[LessEqual]", "min", 
                  RowBox[{"(", 
                    RowBox[{
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "1"], ",", 
                    StyleBox["t", "TI"], 
                    SubscriptBox[
                    StyleBox["a", "TI"], "2"]}], ")"}]}], "}"}]], 
             StyleBox["d", "TI"], 
             StyleBox["s", "TI"]}], "]"}]}], TraditionalForm], "errors" -> {},
      "input" -> 
     "=\\delta_{i_{1},i_{2}}\\cdot\\mathbb{E}\\left[\\int_{0}^{t\\alpha}Z_{\\\
min(s,ta_{3})}^{i_{3}}Q_{\\min(s,ta_{4})}^{i_{4}} \\{C_{1}C_{2}\\} \
\\bm{1}_{\\{0\\leq s\\leq\\min(ta_{1},ta_{2})\\}}ds\\right]", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "cef09368-e16c-42f2-884e-ee53a0bc78a4"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "2"]}]], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              StyleBox["t", "TI"], 
              SubscriptBox[
               StyleBox["a", "TI"], "1"], ",", 
              StyleBox["t", "TI"], 
              SubscriptBox[
               StyleBox["a", "TI"], "2"]}], ")"}]], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "3"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["Q", "TI"], 
              RowBox[{"min", "(", 
                RowBox[{
                  StyleBox["s", "TI"], ",", 
                  StyleBox["t", "TI"], 
                  SubscriptBox[
                   StyleBox["a", "TI"], "4"]}], ")"}], 
              SubscriptBox[
               StyleBox["i", "TI"], "4"]], 
             RowBox[{"{", 
               RowBox[{
                 SubscriptBox[
                  StyleBox["C", "TI"], "1"], 
                 SubscriptBox[
                  StyleBox["C", "TI"], "2"]}], "}"}]}], "]"}], 
         StyleBox["d", "TI"], 
         StyleBox["s", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "=\\delta_{i_{1},i_{2}}\\cdot\\int_{0}^{\\min(ta_{1},ta_{2})}\\mathbb{E}\
\\left[Z_{\\min(s,ta_{3})}^{i_{3}}Q_{\\min(s,ta_{4})}^{i_{4}} \
\\{C_{1}C_{2}\\}\\right]ds", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "574c84e1-da8b-4253-a064-104f88b5de07"],
 ".\n\n\nCondition 1: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "1"], 
         SubscriptBox[
          StyleBox["C", "TI"], "2"], "\[LongEqual]", "1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "C_1 C_2=1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d130b05c-2523-4909-887d-b8c17c0394d3"],
 ". Change of variable, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["s", "TI"], "\[LongEqual]", 
         StyleBox["v", "TI"], 
         StyleBox["t", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "s=vt", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e313a064-3b3b-4c46-8477-795b59100b58"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "2"]}]], "\[CenterDot]", 
         StyleBox["t", "TI"], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "1"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "2"]}], ")"}]], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["Z", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["v", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "3"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "3"]], 
             SubsuperscriptBox[
              StyleBox["Q", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], "min", 
                RowBox[{"(", 
                  RowBox[{
                    StyleBox["v", "TI"], ",", 
                    SubscriptBox[
                    StyleBox["a", "TI"], "4"]}], ")"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "4"]]}], "]"}], 
         StyleBox["d", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "=\\delta_{i_{1},i_{2}}\\cdot \
t\\cdot\\int_{0}^{\\min(a_{1},a_{2})}\\mathbb{E}\\left[Z_{t\\min(v,a_{3})}^{i_\
{3}}Q_{t\\min(v,a_{4})}^{i_{4}}\\right]dv", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6703688d-c3a3-4bc8-8fb0-d12cd2e33278"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "2"]}]], "\[CenterDot]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "3"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "4"]}]], "\[CenterDot]", 
         StyleBox["t", "TI"], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "1"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "2"]}], ")"}]], 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{
            StyleBox["t", "TI"], "min", 
            RowBox[{"(", 
              RowBox[{
                StyleBox["v", "TI"], ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "3"], ",", 
                SubscriptBox[
                 StyleBox["a", "TI"], "4"]}], ")"}]}]], 
         RowBox[{"{", 
           SubscriptBox[
            StyleBox["C", "TI"], "3"], "}"}], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["E", FontSlant -> "Plain"], 
             RowBox[{"[", 
               RowBox[{"\[CapitalXi]", "(", 
                 StyleBox["u", "TI"], ")"}], "]"}]}], ")"}], 
         StyleBox["d", "TI"], 
         StyleBox["u", "TI"], 
         StyleBox["d", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "=\\delta_{i_{1},i_{2}}\\cdot\\delta_{i_{3},i_{4}}\\cdot \
t\\cdot\\int_{0}^{\\min(a_{1},a_{2})}\\int_{0}^{t\\min(v,a_{3},a_{4})} \
\\{C_{3}\\}\\left(\\mathbb{E}\\left[\\Xi(u)\\right]\\right)dudv", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6febf0b6-1e2e-473e-89d0-02a6a7ac0b7d"],
 ".\nNow we need sub-conditions to get the final expression depending on ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["C", "TI"], "3"], TraditionalForm], "errors" -> {}, "input" -> 
     "C_3", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2d2ada2d-0c7f-4436-8ff1-6d851db74d41"],
 ". The main reason is that we need to use a further change of variable, and \
different ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["C", "TI"], "3"], TraditionalForm], "errors" -> {}, "input" -> 
     "C_3", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2840e319-abf7-4f76-bbb7-0ce26e118dc0"],
 " will result in different results.\n\nSub-Condition 1: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "3"], "\[LongEqual]", "1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "C_3=1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2a169ce7-1cef-4421-b73d-e544a2bdb474"],
 ". Change of variable, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["v", "TI"], "\[LongEqual]", 
         StyleBox["t", "TI"], "\[Eta]"}], TraditionalForm], "errors" -> {}, 
     "input" -> "v=t\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4aa4f688-d392-4143-af01-0e52f2c8e893"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "2"]}]], "\[CenterDot]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "3"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "4"]}]], "\[CenterDot]", 
         SuperscriptBox[
          StyleBox["t", "TI"], "2"], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "1"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "2"]}], ")"}]], 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              StyleBox["v", "TI"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "3"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "4"]}], ")"}]], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{"\[CapitalXi]", "(", 
             RowBox[{
               StyleBox["t", "TI"], "\[Eta]"}], ")"}], "]"}], 
         StyleBox["d", "TI"], "\[Eta]", 
         StyleBox["d", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "=\\delta_{i_{1},i_{2}}\\cdot\\delta_{i_{3},i_{4}}\\cdot \
t^{2}\\cdot\\int_{0}^{\\min(a_{1},a_{2})}\\int_{0}^{\\min(v,a_{3},a_{4})}\\\
mathbb{E}\\left[\\Xi(t\\eta)\\right]d\\eta dv", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"93a2ffc3-4f31-4049-b714-9656d1192cce"],
 ".\n\nSub-Condition 2: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "3"], "\[LongEqual]", 
         FractionBox["1", 
          RowBox[{
            StyleBox["t", "TI"], "-", 
            StyleBox["u", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "C_3 = \\frac{1}{t-u}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ea9c7f73-f25c-4ccd-b42e-8b506d5b2fdb"],
 ". Change of variable, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["v", "TI"], "\[LongEqual]", 
         StyleBox["t", "TI"], "\[Eta]"}], TraditionalForm], "errors" -> {}, 
     "input" -> "v=t\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "dbf294cd-d233-4802-a8a0-65ef44451473"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "2"]}]], "\[CenterDot]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "3"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "4"]}]], "\[CenterDot]", 
         StyleBox["t", "TI"], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "1"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "2"]}], ")"}]], 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              StyleBox["v", "TI"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "3"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "4"]}], ")"}]], 
         FractionBox["1", 
          RowBox[{"1", "-", "\[Eta]"}]], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{"\[CapitalXi]", "(", 
             RowBox[{
               StyleBox["t", "TI"], "\[Eta]"}], ")"}], "]"}], 
         StyleBox["d", "TI"], "\[Eta]", 
         StyleBox["d", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "=\\delta_{i_{1},i_{2}}\\cdot\\delta_{i_{3},i_{4}}\\cdot \
t\\cdot\\int_{0}^{\\min(a_{1},a_{2})}\\int_{0}^{\\min(v,a_{3},a_{4})}\\frac{1}\
{1-\\eta}\\mathbb{E}\\left[\\Xi(t\\eta)\\right]d\\eta dv", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"b21e44c0-e214-4b10-be1d-2234ebc9e377"],
 ".\n\n\nCondition 2: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "1"], 
         SubscriptBox[
          StyleBox["C", "TI"], "2"], "\[LongEqual]", 
         FractionBox["1", 
          RowBox[{
            StyleBox["t", "TI"], "-", 
            StyleBox["u", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "C_1 C_2 = \\frac{1}{t-u}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d2ec08d7-b44d-45b6-b31a-c33f8a52c815"],
 ". Change of variable, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["s", "TI"], "\[LongEqual]", 
         StyleBox["v", "TI"], 
         StyleBox["t", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "s=vt", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9b60cbca-8be3-4247-8afb-62f159ea50db"],
 ", \nSub-Condition 1: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "3"], "\[LongEqual]", "1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "C_3=1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "634595dd-d0c5-4527-89b5-38e56abf7b22"],
 ". Change of variable, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["v", "TI"], "\[LongEqual]", 
         StyleBox["t", "TI"], "\[Eta]"}], TraditionalForm], "errors" -> {}, 
     "input" -> "v=t\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4b1dfc56-9968-44ed-abda-0fadb4297428"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "2"]}]], "\[CenterDot]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "3"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "4"]}]], "\[CenterDot]", 
         StyleBox["t", "TI"], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "1"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "2"]}], ")"}]], 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              StyleBox["v", "TI"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "3"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "4"]}], ")"}]], 
         FractionBox["1", 
          RowBox[{"1", "-", 
            StyleBox["v", "TI"]}]], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{"\[CapitalXi]", "(", 
             RowBox[{
               StyleBox["t", "TI"], "\[Eta]"}], ")"}], "]"}], 
         StyleBox["d", "TI"], "\[Eta]", 
         StyleBox["d", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "=\\delta_{i_{1},i_{2}}\\cdot\\delta_{i_{3},i_{4}}\\cdot \
t\\cdot\\int_{0}^{\\min(a_{1},a_{2})}\\int_{0}^{\\min(v,a_{3},a_{4})}\\frac{1}\
{1-v}\\mathbb{E}\\left[\\Xi(t\\eta)\\right]d\\eta dv", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"b7c6ad1f-a5f2-4880-bab6-8695e910e5fe"],
 ".\n\nSub-Condition 2: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "3"], "\[LongEqual]", 
         FractionBox["1", 
          RowBox[{
            StyleBox["t", "TI"], "-", 
            StyleBox["u", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "C_3 = \\frac{1}{t-u}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "84aa84b9-68e9-42cf-b876-3728b97f8218"],
 ". Change of variable, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["v", "TI"], "\[LongEqual]", 
         StyleBox["t", "TI"], "\[Eta]"}], TraditionalForm], "errors" -> {}, 
     "input" -> "v=t\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "12bc9eab-3ee2-461e-98e1-88d7952a6d47"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "2"]}]], "\[CenterDot]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "3"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "4"]}]], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "1"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "2"]}], ")"}]], 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              StyleBox["v", "TI"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "3"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "4"]}], ")"}]], 
         FractionBox["1", 
          RowBox[{
            RowBox[{"(", 
              RowBox[{"1", "-", 
                StyleBox["v", "TI"]}], ")"}], "(", 
            RowBox[{"1", "-", "\[Eta]"}], ")"}]], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{"\[CapitalXi]", "(", 
             RowBox[{
               StyleBox["t", "TI"], "\[Eta]"}], ")"}], "]"}], 
         StyleBox["d", "TI"], "\[Eta]", 
         StyleBox["d", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "=\\delta_{i_{1},i_{2}}\\cdot\\delta_{i_{3},i_{4}}\\cdot\\int_{0}^{\\min(\
a_{1},a_{2})}\\int_{0}^{\\min(v,a_{3},a_{4})}\\frac{1}{(1-v)(1-\\eta)}\\\
mathbb{E}\\left[\\Xi(t\\eta)\\right]d\\eta dv", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"37972505-31ec-4cd9-b711-685131a9e394"],
 ".\n\n\nCondition 3: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "1"], 
         SubscriptBox[
          StyleBox["C", "TI"], "2"], "\[LongEqual]", 
         FractionBox["1", 
          SuperscriptBox[
           RowBox[{"(", 
             RowBox[{
               StyleBox["t", "TI"], "-", 
               StyleBox["u", "TI"]}], ")"}], "2"]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "C_1 C_2 = \\frac{1}{(t-u)^2}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "318c28ac-653f-4a68-8d90-68a2f9eb55ef"],
 ". Change of variable, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["s", "TI"], "\[LongEqual]", 
         StyleBox["v", "TI"], 
         StyleBox["t", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "s=vt", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b1303428-9f59-4d28-82ba-f4893f5de36f"],
 ", \n\nSub-Condition 1: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "3"], "\[LongEqual]", "1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "C_3=1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9841c34e-599d-4e03-a379-0f885ace7a58"],
 ". Change of variable, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["v", "TI"], "\[LongEqual]", 
         StyleBox["t", "TI"], "\[Eta]"}], TraditionalForm], "errors" -> {}, 
     "input" -> "v=t\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8ae4f881-398b-464c-b699-a3724ceff04e"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "2"]}]], "\[CenterDot]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "3"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "4"]}]], "\[CenterDot]", 
         StyleBox["t", "TI"], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "1"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "2"]}], ")"}]], 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              StyleBox["v", "TI"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "3"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "4"]}], ")"}]], 
         FractionBox["1", 
          RowBox[{"1", "-", 
            StyleBox["v", "TI"]}]], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{"\[CapitalXi]", "(", 
             RowBox[{
               StyleBox["t", "TI"], "\[Eta]"}], ")"}], "]"}], 
         StyleBox["d", "TI"], "\[Eta]", 
         StyleBox["d", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "=\\delta_{i_{1},i_{2}}\\cdot\\delta_{i_{3},i_{4}}\\cdot \
t\\cdot\\int_{0}^{\\min(a_{1},a_{2})}\\int_{0}^{\\min(v,a_{3},a_{4})}\\frac{1}\
{1-v}\\mathbb{E}\\left[\\Xi(t\\eta)\\right]d\\eta dv", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"3fc697c6-b7b2-49d2-837d-2c508886abd3"],
 ".\n\nSub-Condition 2: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "3"], "\[LongEqual]", 
         FractionBox["1", 
          RowBox[{
            StyleBox["t", "TI"], "-", 
            StyleBox["u", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "C_3 = \\frac{1}{t-u}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f0e027c8-ecfe-49de-bc08-5057371ca189"],
 ". Change of variable, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["v", "TI"], "\[LongEqual]", 
         StyleBox["t", "TI"], "\[Eta]"}], TraditionalForm], "errors" -> {}, 
     "input" -> "v=t\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c9cb7871-1bed-4096-8880-eb382873d330"],
 ",\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "2"]}]], "\[CenterDot]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "3"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "4"]}]], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "1"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "2"]}], ")"}]], 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              StyleBox["v", "TI"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "3"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "4"]}], ")"}]], 
         FractionBox["1", 
          RowBox[{
            RowBox[{"(", 
              RowBox[{"1", "-", 
                StyleBox["v", "TI"]}], ")"}], "(", 
            RowBox[{"1", "-", "\[Eta]"}], ")"}]], 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{"\[CapitalXi]", "(", 
             RowBox[{
               StyleBox["t", "TI"], "\[Eta]"}], ")"}], "]"}], 
         StyleBox["d", "TI"], "\[Eta]", 
         StyleBox["d", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "=\\delta_{i_{1},i_{2}}\\cdot\\delta_{i_{3},i_{4}}\\cdot\\int_{0}^{\\min(\
a_{1},a_{2})}\\int_{0}^{\\min(v,a_{3},a_{4})}\\frac{1}{(1-v)(1-\\eta)}\\\
mathbb{E}\\left[\\Xi(t\\eta)\\right]d\\eta dv", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"05848018-2e30-49be-84f7-98550ddba4a9"],
 ".\n\nIf XiLebesgue is False, then after expansion we will have product of \
two stochastic integrals directly, i.e. \n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalXi]", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["t", "TI"], "\[Eta]", ";", 
             SubscriptBox[
              StyleBox["i", "TI"], "5"], ",", 
             SubscriptBox[
              StyleBox["i", "TI"], "6"]}], ")"}], "\[LongEqual]", 
         StyleBox["g", "TI"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["t", "TI"], ",", "\[Eta]"}], ")"}], 
         SubsuperscriptBox[
          StyleBox["P", "TI"], 
          RowBox[{
            StyleBox["t", "TI"], "\[Eta]"}], 
          SubscriptBox[
           StyleBox["i", "TI"], "5"]], 
         SubsuperscriptBox[
          StyleBox["L", "TI"], 
          RowBox[{
            StyleBox["t", "TI"], "\[Eta]"}], 
          SubscriptBox[
           StyleBox["i", "TI"], "6"]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\Xi(t\\eta;i_{5},i_{6})=g(t,\\eta)P_{t\\eta}^{i_{5}}L_{t\\eta}^{i_{6}}\
", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4b194d29-1035-4f1b-9dd9-45b4fe7e9f9f"],
 ",\n\nIf XiLebesgue is True, then every term will have another change of \
variable, which will be represented through another layer of integral with \
respect to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Delta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\delta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a79b7338-ab34-4c55-a978-a191ec4626e2"],
 ". For instance, if ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "1"], 
         SubscriptBox[
          StyleBox["C", "TI"], "2"], "\[LongEqual]", 
         FractionBox["1", 
          SuperscriptBox[
           RowBox[{"(", 
             RowBox[{
               StyleBox["t", "TI"], "-", 
               StyleBox["u", "TI"]}], ")"}], "2"]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "C_1C_2=\\frac{1}{(t-u)^2}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "122d8644-476f-4feb-bea2-1e0ce403e8a9"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["C", "TI"], "3"], "\[LongEqual]", 
         FractionBox["1", 
          RowBox[{
            StyleBox["t", "TI"], "-", 
            StyleBox["u", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "C_3=\\frac{1}{t-u}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "cb6e5b5c-4860-458e-b301-aae09094ca21"],
 ", then\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "1"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "2"]}]], "\[CenterDot]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            SubscriptBox[
             StyleBox["i", "TI"], "3"], ",", 
            SubscriptBox[
             StyleBox["i", "TI"], "4"]}]], "\[CenterDot]", 
         FractionBox["1", 
          StyleBox["t", "TI"]], "\[CenterDot]", 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              SubscriptBox[
               StyleBox["a", "TI"], "1"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "2"]}], ")"}]], 
         SubsuperscriptBox["\[Integral]", "0", 
          RowBox[{"min", "(", 
            RowBox[{
              StyleBox["v", "TI"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "3"], ",", 
              SubscriptBox[
               StyleBox["a", "TI"], "4"]}], ")"}]], 
         SubsuperscriptBox["\[Integral]", "0", "\[Eta]"], 
         FractionBox["1", 
          RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
               RowBox[{"1", "-", 
                 StyleBox["v", "TI"]}], ")"}], "2"], "(", 
            RowBox[{"1", "-", "\[Eta]"}], ")"}]], "\[CenterDot]", 
         StyleBox["g", "TI"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["t", "TI"], ",", "\[Delta]"}], ")"}], "\[CenterDot]", 
         StyleBox["E", FontSlant -> "Plain"], 
         RowBox[{"[", 
           RowBox[{
             SubsuperscriptBox[
              StyleBox["P", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], 
                RowBox[{"{", 
                  RowBox[{"\[Delta]", ",", "\[Eta]"}], "}"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "5"]], 
             SubsuperscriptBox[
              StyleBox["L", "TI"], 
              RowBox[{
                StyleBox["t", "TI"], 
                RowBox[{"{", 
                  RowBox[{"\[Delta]", ",", "\[Eta]"}], "}"}]}], 
              SubscriptBox[
               StyleBox["i", "TI"], "6"]]}], "]"}], 
         StyleBox["d", "TI"], "\[Delta]", 
         StyleBox["d", "TI"], "\[Eta]", 
         StyleBox["d", "TI"], 
         StyleBox["v", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "=\\delta_{i_{1},i_{2}}\\cdot\\delta_{i_{3},i_{4}}\\cdot\\frac{1}{t}\\\
cdot\\int_{0}^{\\min(a_{1},a_{2})}\\int_{0}^{\\min(v,a_{3},a_{4})}\\int_{0}^{\
\\eta}\\frac{1}{(1-v)^{2}(1-\\eta)}\\cdot \
g(t,\\delta)\\cdot\\mathbb{E}\\left[P_{t\\{\\delta,\\eta\\}}^{i_{5}}L_{t\\{\\\
delta,\\eta\\}}^{i_{6}}\\right]d\\delta d\\eta dv", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "75acd0b9-f523-4515-8205-acade6799411"],
 ".\n\n",
 StyleBox["In this case, the parameters ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Eta]", ",", 
         StyleBox["v", "TI"], ",", "\[Delta]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\eta,v,\\delta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"5a96ad2a-0189-4444-8875-303dc344cc6c"],
 StyleBox[" will be reserved for the use of change of variable.",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.908800040841099*^9, 3.9088000665240517`*^9}, {
  3.908979639004759*^9, 3.908979652134716*^9}, {3.920616471929075*^9, 
  3.92061647232069*^9}, {3.92104054172325*^9, 3.921040582757393*^9}, {
  3.921040701843729*^9, 3.921040726918847*^9}, {3.92104103602211*^9, 
  3.92104120265833*^9}, {3.921041260277972*^9, 3.921041298731693*^9}, {
  3.921041401819808*^9, 
  3.921041439780464*^9}},ExpressionUUID->"6e626875-a5bf-4c64-89bf-\
fe458ebad088"],

Cell[CellGroupData[{

Cell["Inputs:", "Subsection",
 CellChangeTimes->{{3.921040747124827*^9, 
  3.921040749611442*^9}},ExpressionUUID->"94d28d4b-2f03-4d29-be5f-\
28e6f3e0c431"],

Cell[TextData[{
 "XiLebesgue: boolean valued, whether ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "948d03b6-5c63-4c00-a5aa-b93a033ab0ce"],
 " contains Lebesgue integral.\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["i", "TI"], TraditionalForm], "errors" -> {}, "input" -> "i", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f42e436a-a734-44b0-9d8d-dabcd5aae4bc"],
 ": list valued, length 6, stands for the index list ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{
           SubscriptBox[
            StyleBox["i", "TI"], "1"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "2"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "3"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "4"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "5"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "6"]}], "}"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\{i_{1},i_{2},i_{3},i_{4},i_{5},i_{6}\\}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "073691c4-ebae-42b8-9bbf-b1aad1c13301"],
 ". ",
 StyleBox["In particular, ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["i", "TI"], "5"], ",", 
         SubscriptBox[
          StyleBox["i", "TI"], "6"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "i_{5}, i_{6}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "dded11de-b16e-486d-8191-4e2982fcda03"],
 StyleBox[" must be the index of ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a673d876-4a34-49b9-92cb-24b913086c22"],
 StyleBox[".\n",
  FontWeight->"Bold"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["a", "TI"], TraditionalForm], "errors" -> {}, "input" -> "a", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "99337148-374e-43fa-8024-801ca6e2fdfc"],
 ": list valued, length 6. The first four position stands for the time \
horizon parameters ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{
           SubscriptBox[
            StyleBox["a", "TI"], "1"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "2"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "3"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "4"]}], "}"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\{a_{1},a_{2},a_{3},a_{4}\\}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "881ad7d6-29f0-4c57-8d22-6d62965558fd"],
 " of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["X", "TI"], ",", 
         StyleBox["Y", "TI"], ",", 
         StyleBox["Z", "TI"], ",", 
         StyleBox["Q", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "X,Y,Z,Q", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "89809bc5-e4f4-4c4f-a38d-249b41189ba5"],
 ". The last two position stands for the choice of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Eta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d78bd55d-a78b-462d-a353-f28764d8fa97"],
 " or ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Delta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\delta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d9d1ac82-2e44-401e-bda1-306bfc5f8314"],
 ". If XiLebesgue=True, then will be values chosen from ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{"\[Eta]", ",", "\[Delta]"}], "}"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\{\\eta,\\delta\\}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "684be169-90f1-4a6d-8929-e251250218b5"],
 " depending on the expansion. If XiLebesgue=False, then set both to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Eta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f2665f13-ad0c-4624-b0a0-2e01a23007ee"],
 ".\n(According to the calculation, the last two inputs will affect the \
result only if the XiLebesgue is True, and the input will depend on the \
expansion. If XiLebesgue is False, it will not affect the result, and by \
default we would just use ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Eta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f464df69-7a8b-4109-b997-537df747d070"],
 " to be consistent with the calculation above.)\n\ndrift: list valued, \
length 6, stands for the drift terms of the stochastic integrals. They are \
actually all {0,0,0,0,0,0}.\n\nC: list valued, length 6, stands for the \
coefficient term in front of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubsuperscriptBox[
        RowBox[{"(", 
          RowBox[{"\[Sigma]", 
            StyleBox["d", "TI"], 
            StyleBox["B", "TI"]}], ")"}], 
        StyleBox["u", "TI"], 
        StyleBox["i", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "(\\sigma dB)_{u}^{i}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e8216320-9128-433b-b56b-437432b434f8"],
 ". ",
 StyleBox["In particular, C[[4]] should always be 1 since we treat ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"c088e257-54a3-46d3-a5db-d39a96730647"],
 StyleBox[" as a special coefficient itself. And C[[5]], C[[6]] should just \
be the coefficients taking values in {1,",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox["1", 
        RowBox[{
          StyleBox["t", "TI"], "-", 
          StyleBox["u", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\frac{1}{t-u}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f0c2a9c7-1693-4ebb-9065-62fe49301588"],
 StyleBox["}. This is now different from the previous cases since the input \
XiCoeff below will take account for the extra term coming from the expansion.",
  FontWeight->"Bold"],
 "\n\nXiCoeff: a function of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Eta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\eta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "30afffd2-ddf9-49dd-9022-687fb4f917e0"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Delta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\delta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "aac62536-cd0d-49f6-a50b-eb7a7a0fbdc8"],
 ". Essentially it is the function ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["g", "TI"], "(", 
         RowBox[{
           StyleBox["t", "TI"], ",", "\[Eta]", ",", "\[Delta]"}], ")"}], 
       TraditionalForm], "errors" -> {}, "input" -> "g(t,\\eta,\\delta)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f0b4a6e1-71c1-4bcb-be9c-a4230d051ee9"],
 " we mentioned in the above calculation. It will include all the extra terms \
from the expansion."
}], "Text",
 CellChangeTimes->{
  3.921040807169921*^9, {3.921041499370084*^9, 3.92104150146408*^9}, {
   3.921041709531685*^9, 3.921041748898191*^9}, {3.921041781543664*^9, 
   3.921041840799332*^9}},ExpressionUUID->"d4f2dede-f0e7-4189-8847-\
c4fac1e7f746"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fourProductExpFForm2", "[", "\[IndentingNewLine]", 
   RowBox[{
   "XiLebesgue_", ",", "\[IndentingNewLine]", "i_", ",", 
    "\[IndentingNewLine]", "a_", ",", "\[IndentingNewLine]", "drift_", ",", 
    "\[IndentingNewLine]", "C_", ",", "\[IndentingNewLine]", "XiCoeff_"}], 
   "  ", "\[IndentingNewLine]", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"outerIndex1", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "}"}]}], ";", "\n", 
     RowBox[{"outerIndex2", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"i", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "}"}]}], ";", "\n", 
     RowBox[{"outerInterval1", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"a", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"a", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"a", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
       "}"}]}], ";", "\n", 
     RowBox[{"outerInterval2", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Min", "[", 
         RowBox[{"v", ",", 
          RowBox[{"a", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"a", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Min", "[", 
         RowBox[{"v", ",", 
          RowBox[{"a", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"a", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Min", "[", 
         RowBox[{"v", ",", 
          RowBox[{"a", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"a", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "\n", "}"}]}], ";", 
     "\n", 
     RowBox[{"outerC1", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"C", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"C", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"C", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"C", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"C", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "*", 
         RowBox[{"C", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
     ";", "\n", 
     RowBox[{"outerC2", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"C", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"C", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"C", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
     ";", "\n", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"XiLebesgue", "==", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "According", " ", "to", " ", "the", " ", "calculation", " ", "we", 
          " ", "use", " ", "the", " ", "two"}], "-", 
         RowBox[{"product", " ", 
          RowBox[{"function", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"form", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"outerIndex1", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"outerIndex1", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]",
             "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"outerIndex2", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"outerIndex2", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
            RowBox[{"twoProductF", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], ",", 
                RowBox[{"i", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\[Eta]", ",", "\[Eta]"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"C", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], ",", 
                RowBox[{"C", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "3"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Different", " ", "cases", " ", "according", " ", "to", " ", "the", 
          " ", "subconditions", " ", "of", " ", "the", " ", 
          RowBox[{"C_i", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"outerC1", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", "1"}], "&&", 
              RowBox[{
               RowBox[{"outerC2", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", "1"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"t", "^", "2"}], "*", "XiCoeff", "*", 
                RowBox[{
                 RowBox[{"form", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"v", ",", "0", ",", 
                 RowBox[{"outerInterval1", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Eta]", ",", "0", ",", 
                 RowBox[{"outerInterval2", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"form", "[", 
                 RowBox[{"[", "counter", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"outerC1", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", "1"}], "&&", 
              RowBox[{
               RowBox[{"outerC2", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", 
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"t", "-", "u"}], ")"}]}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"t", "*", "XiCoeff", "*", 
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", "\[Eta]"}], ")"}]}], "*", 
                RowBox[{
                 RowBox[{"form", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"v", ",", "0", ",", 
                 RowBox[{"outerInterval1", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Eta]", ",", "0", ",", 
                 RowBox[{"outerInterval2", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"form", "[", 
                 RowBox[{"[", "counter", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"outerC1", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", 
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"t", "-", "u"}], ")"}]}]}], "&&", 
              RowBox[{
               RowBox[{"outerC2", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", "1"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"t", "*", "XiCoeff", "*", 
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", "v"}], ")"}]}], "*", 
                RowBox[{
                 RowBox[{"form", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"v", ",", "0", ",", 
                 RowBox[{"outerInterval1", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Eta]", ",", "0", ",", 
                 RowBox[{"outerInterval2", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"form", "[", 
                 RowBox[{"[", "counter", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"outerC1", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", 
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"t", "-", "u"}], ")"}]}]}], "&&", 
              RowBox[{
               RowBox[{"outerC2", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", 
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"t", "-", "u"}], ")"}]}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"XiCoeff", "*", 
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "v"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{"1", "-", "\[Eta]"}], ")"}]}], ")"}]}], "*", 
                RowBox[{
                 RowBox[{"form", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"v", ",", "0", ",", 
                 RowBox[{"outerInterval1", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Eta]", ",", "0", ",", 
                 RowBox[{"outerInterval2", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"form", "[", 
                 RowBox[{"[", "counter", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"outerC1", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", 
               RowBox[{"1", "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"t", "-", "u"}], ")"}], "^", "2"}]}]}], "&&", 
              RowBox[{
               RowBox[{"outerC2", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", "1"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"XiCoeff", "*", 
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "v"}], ")"}], "^", "2"}], ")"}]}], "*", 
                
                RowBox[{
                 RowBox[{"form", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"v", ",", "0", ",", 
                 RowBox[{"outerInterval1", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Eta]", ",", "0", ",", 
                 RowBox[{"outerInterval2", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"form", "[", 
                 RowBox[{"[", "counter", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"outerC1", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", 
               RowBox[{"1", "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"t", "-", "u"}], ")"}], "^", "2"}]}]}], "&&", 
              RowBox[{
               RowBox[{"outerC2", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", 
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"t", "-", "u"}], ")"}]}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"1", "/", "t"}], "*", "XiCoeff", "*", 
                RowBox[{"(", 
                 RowBox[{"1", "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "v"}], ")"}], "^", "2"}], ")"}]}], 
                 ")"}], "*", 
                RowBox[{"(", 
                 RowBox[{"1", "/", 
                  RowBox[{"(", 
                   RowBox[{"1", "-", "\[Eta]"}], ")"}]}], ")"}], "*", 
                RowBox[{
                 RowBox[{"form", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"v", ",", "0", ",", 
                 RowBox[{"outerInterval1", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Eta]", ",", "0", ",", 
                 RowBox[{"outerInterval2", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"form", "[", 
                 RowBox[{"[", "counter", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
              "}"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "3"}], "}"}]}], "]"}]}]}], ",", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Else", " ", "if", " ", "XiLebesgue"}], "==", "True"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"form", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"outerIndex1", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"outerIndex1", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]",
             "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"outerIndex2", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"outerIndex2", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
            RowBox[{"twoProductF", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], ",", 
                RowBox[{"i", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], ",", 
                RowBox[{"a", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"C", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], ",", 
                RowBox[{"C", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "3"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"outerC1", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", "1"}], "&&", 
              RowBox[{
               RowBox[{"outerC2", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", "1"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"t", "^", "2"}], "*", "XiCoeff", "*", 
                RowBox[{
                 RowBox[{"form", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"v", ",", "0", ",", 
                 RowBox[{"outerInterval1", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Eta]", ",", "0", ",", 
                 RowBox[{"outerInterval2", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Delta]", ",", "0", ",", "\[Eta]"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"form", "[", 
                 RowBox[{"[", "counter", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"outerC1", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", "1"}], "&&", 
              RowBox[{
               RowBox[{"outerC2", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", 
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"t", "-", "u"}], ")"}]}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"t", "*", "XiCoeff", "*", 
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", "\[Eta]"}], ")"}]}], "*", 
                RowBox[{
                 RowBox[{"form", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"v", ",", "0", ",", 
                 RowBox[{"outerInterval1", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Eta]", ",", "0", ",", 
                 RowBox[{"outerInterval2", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Delta]", ",", "0", ",", "\[Eta]"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"form", "[", 
                 RowBox[{"[", "counter", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"outerC1", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", 
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"t", "-", "u"}], ")"}]}]}], "&&", 
              RowBox[{
               RowBox[{"outerC2", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", "1"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"t", "*", "XiCoeff", "*", 
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", "v"}], ")"}]}], "*", 
                RowBox[{
                 RowBox[{"form", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"v", ",", "0", ",", 
                 RowBox[{"outerInterval1", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Eta]", ",", "0", ",", 
                 RowBox[{"outerInterval2", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Delta]", ",", "0", ",", "\[Eta]"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"form", "[", 
                 RowBox[{"[", "counter", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"outerC1", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", 
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"t", "-", "u"}], ")"}]}]}], "&&", 
              RowBox[{
               RowBox[{"outerC2", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", 
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"t", "-", "u"}], ")"}]}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"XiCoeff", "*", 
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "v"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{"1", "-", "\[Eta]"}], ")"}]}], ")"}]}], "*", 
                RowBox[{
                 RowBox[{"form", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"v", ",", "0", ",", 
                 RowBox[{"outerInterval1", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Eta]", ",", "0", ",", 
                 RowBox[{"outerInterval2", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Delta]", ",", "0", ",", "\[Eta]"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"form", "[", 
                 RowBox[{"[", "counter", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"outerC1", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", 
               RowBox[{"1", "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"t", "-", "u"}], ")"}], "^", "2"}]}]}], "&&", 
              RowBox[{
               RowBox[{"outerC2", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", "1"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"XiCoeff", "*", 
                RowBox[{"1", "/", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "v"}], ")"}], "^", "2"}]}], "*", 
                RowBox[{
                 RowBox[{"form", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"v", ",", "0", ",", 
                 RowBox[{"outerInterval1", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Eta]", ",", "0", ",", 
                 RowBox[{"outerInterval2", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Delta]", ",", "0", ",", "\[Eta]"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"form", "[", 
                 RowBox[{"[", "counter", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"outerC1", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", 
               RowBox[{"1", "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"t", "-", "u"}], ")"}], "^", "2"}]}]}], "&&", 
              RowBox[{
               RowBox[{"outerC2", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "===", 
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"t", "-", "u"}], ")"}]}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"1", "/", "t"}], "*", "XiCoeff", "*", 
                RowBox[{"(", 
                 RowBox[{"1", "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "v"}], ")"}], "^", "2"}], ")"}]}], 
                 ")"}], "*", 
                RowBox[{"(", 
                 RowBox[{"1", "/", 
                  RowBox[{"(", 
                   RowBox[{"1", "-", "\[Eta]"}], ")"}]}], ")"}], "*", 
                RowBox[{
                 RowBox[{"form", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"v", ",", "0", ",", 
                 RowBox[{"outerInterval1", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Eta]", ",", "0", ",", 
                 RowBox[{"outerInterval2", "[", 
                  RowBox[{"[", "counter", "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Delta]", ",", "0", ",", "\[Eta]"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"form", "[", 
                 RowBox[{"[", "counter", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
              "}"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "3"}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "result"}]}], 
   "\n", "]"}]}]], "Input",
 CellChangeTimes->{{3.908799365822183*^9, 3.908799561001255*^9}, {
   3.908799598103484*^9, 3.908799680839309*^9}, 3.908799754935902*^9, {
   3.908799825985083*^9, 3.908799861951966*^9}, {3.908799894022896*^9, 
   3.908799897344038*^9}, {3.908800513879515*^9, 3.908800520162444*^9}, {
   3.908800551722022*^9, 3.908800636216729*^9}, {3.908969260686821*^9, 
   3.9089693951465473`*^9}, {3.9089695336454897`*^9, 
   3.9089695860823812`*^9}, {3.908979574780921*^9, 3.908979580398568*^9}, {
   3.911304915910482*^9, 3.9113049194226017`*^9}, {3.9214023027371597`*^9, 
   3.921402324698786*^9}, {3.921402626338017*^9, 3.9214026574349422`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"648ef99f-bcc7-4597-935a-89f0c2ab6cc4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Four Product with two Expansion in ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e8c227f2-073b-40ef-9de0-c9be20bd4b4d"],
 " Form 1 Evaluation."
}], "Subchapter",
 CellChangeTimes->{{3.908984662312706*^9, 
  3.908984669343423*^9}},ExpressionUUID->"beddff38-b462-430f-874a-\
41c2a9bc2165"],

Cell["The idea is same as the evaluation functions before.", "Text",
 CellChangeTimes->{{3.9214010656722107`*^9, 
  3.921401094260057*^9}},ExpressionUUID->"2bd5cebc-ed31-4f55-9d3b-\
ac638c045235"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fourProductExpFForm1Eval", "[", "\[IndentingNewLine]", 
   RowBox[{
   "XiLebesgue_", ",", "\[IndentingNewLine]", "extraCoeff_", ",", 
    "\[IndentingNewLine]", "expression_", ",", "\[IndentingNewLine]", "b1_", 
    ",", "\[IndentingNewLine]", "b2_", ",", "\[IndentingNewLine]", "b3_", ",",
     "\[IndentingNewLine]", "b4_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"result", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"XiLebesgue", "==", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Total", "[", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Total", "[", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Integrate", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"extraCoeff", "*", 
                  RowBox[{"Coefficient", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"expression", "[", 
                    RowBox[{"[", "counter1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"expression", "[", 
                    RowBox[{"[", "counter1", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "[", 
                    RowBox[{"[", "counter2", "]"}], "]"}]}], 
                   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",",
                  "b1", ",", "b2", ",", "b3", ",", "b4", ",", 
                 RowBox[{
                  RowBox[{"expression", "[", 
                   RowBox[{"[", "counter1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"expression", "[", 
                   RowBox[{"[", "counter1", "]"}], "]"}], "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "\[IndentingNewLine]", 
                "]"}], "*", 
               RowBox[{
                RowBox[{
                 RowBox[{"expression", "[", 
                  RowBox[{"[", "counter1", "]"}], "]"}], "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "[", 
                RowBox[{"[", "counter2", "]"}], "]"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"counter2", ",", "3"}], "}"}]}], "]"}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter1", ",", "3"}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Else", " ", "if", " ", "XiLebesgue"}], "==", "False"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Total", "[", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Total", "[", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Integrate", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"extraCoeff", "*", 
                  RowBox[{"Coefficient", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"expression", "[", 
                    RowBox[{"[", "counter1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"expression", "[", 
                    RowBox[{"[", "counter1", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "counter2", "]"}], "]"}]}], 
                   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",",
                  "b1", ",", "b2", ",", "b3", ",", "b4", ",", 
                 RowBox[{
                  RowBox[{"expression", "[", 
                   RowBox[{"[", "counter1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
                "]"}], "*", 
               RowBox[{
                RowBox[{
                 RowBox[{"expression", "[", 
                  RowBox[{"[", "counter1", "]"}], "]"}], "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "[", 
                RowBox[{"[", "counter2", "]"}], "]"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"counter2", ",", "3"}], "}"}]}], "]"}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter1", ",", "3"}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.908968480557262*^9, 3.908968563237788*^9}, {
  3.908968595980441*^9, 3.908968604083693*^9}, {3.9089696383105593`*^9, 
  3.908969644697689*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"f7d607b3-2d1d-4db8-ae32-11532ef6f73f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Four Product with two Expansion in ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalXi]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Xi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "13082707-dfd0-4857-b211-c019fd52375a"],
 " Form 2 Evaluation."
}], "Subchapter",
 CellChangeTimes->{{3.908984702085758*^9, 
  3.908984704445677*^9}},ExpressionUUID->"157f6fec-6039-404c-a886-\
eebcd19d3ce2"],

Cell["The idea is same as the evaluation functions before.", "Text",
 CellChangeTimes->{
  3.921403266698703*^9},ExpressionUUID->"228beb30-0f70-4727-82b5-\
a6419c75a5a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fourProductExpFForm2Eval", "[", "\[IndentingNewLine]", 
   RowBox[{
   "XiLebesgue_", ",", "\[IndentingNewLine]", "extraCoeff_", ",", 
    "\[IndentingNewLine]", "expression_", ",", "\[IndentingNewLine]", "b1_", 
    ",", "\[IndentingNewLine]", "b2_", ",", "\[IndentingNewLine]", "b3_", ",",
     "\[IndentingNewLine]", "b4_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"result", "=", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"XiLebesgue", "==", "False"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Total", "[", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Integrate", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"extraCoeff", "*", 
               RowBox[{"Coefficient", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"expression", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"expression", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "\[IndentingNewLine]", 
                "]"}]}], "\[IndentingNewLine]", ",", "b1", ",", "b2", ",", 
              "b3", ",", "b4", ",", 
              RowBox[{
               RowBox[{"expression", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"expression", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}],
             "*", 
            RowBox[{
             RowBox[{"expression", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "3"}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Else", " ", "if", " ", "XiLebesgue"}], "==", "True"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Total", "[", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Integrate", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"extraCoeff", "*", 
               RowBox[{"Coefficient", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"expression", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"expression", "[", 
                   RowBox[{"[", "counter", "]"}], "]"}], "[", 
                  RowBox[{"[", "5", "]"}], "]"}]}], "\[IndentingNewLine]", 
                "]"}]}], "\[IndentingNewLine]", ",", "b1", ",", "b2", ",", 
              "b3", ",", "b4", ",", 
              RowBox[{
               RowBox[{"expression", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"expression", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"expression", "[", 
                RowBox[{"[", "counter", "]"}], "]"}], "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}],
             "*", 
            RowBox[{
             RowBox[{"expression", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"counter", ",", "3"}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{3.908984685246237*^9},
 CellLabel->"In[46]:=",ExpressionUUID->"64b659fd-2018-4683-9342-f204f412da55"],

Cell["", "Section",ExpressionUUID->"f517fd4e-2bc4-40ca-b530-2324fff5d9cb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Six-Product-Formula Case", "Chapter",
 CellChangeTimes->{{3.929458010769742*^9, 
  3.929458011711052*^9}},ExpressionUUID->"107e939d-be48-4dad-a451-\
c2f2bdd145a5"],

Cell["\<\
We use the Isserlis\[CloseCurlyQuote]s theorem again to express the \
expectation of product of mean-zero multivariate Gaussians.
The difference from the four-product case is that we need a larger covariance \
matrix.\
\>", "Text",
 CellChangeTimes->{{3.921400498592581*^9, 3.921400533267703*^9}, {
  3.921400749101716*^9, 3.921400760065771*^9}, {3.921400834057453*^9, 
  3.921400858316663*^9}},ExpressionUUID->"1acd5e39-22d1-4c4b-a023-\
0468a268dbaf"],

Cell[CellGroupData[{

Cell["Inputs:", "Subsection",
 CellChangeTimes->{{3.9214008642650747`*^9, 
  3.9214008766022863`*^9}},ExpressionUUID->"ef3827ef-7538-4915-9410-\
b279047a1f14"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["i", "TI"], TraditionalForm], "errors" -> {}, "input" -> "i", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c338d4c6-52cd-48b5-a083-d5477ae8333b"],
 ": list valued, length 6, stands for the index list ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{
           SubscriptBox[
            StyleBox["i", "TI"], "1"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "2"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "3"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "4"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "5"], ",", 
           SubscriptBox[
            StyleBox["i", "TI"], "6"]}], "}"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\{i_{1},i_{2},i_{3},i_{4},i_{5},i_{6}\\}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7cd93bc2-eb09-4042-9c8d-ce3b913f632f"],
 ". \n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["a", "TI"], TraditionalForm], "errors" -> {}, "input" -> "a", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "994f3811-2d17-44d1-b3fe-feae5e92a443"],
 ": list valued, length 6, stands for the time horizon parameters ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         RowBox[{
           SubscriptBox[
            StyleBox["a", "TI"], "1"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "2"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "3"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "4"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "5"], ",", 
           SubscriptBox[
            StyleBox["a", "TI"], "6"]}], "}"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\{a_{1},a_{2},a_{3}, a_4, a_{5}, a_{6}\\}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "67a025a1-5bed-4a6d-a5db-70026ad26e9c"],
 ".\n\ndrift: list valued, length 6, stands for the drift terms of the \
stochastic integrals. They are actually all {0,0,0,0,0,0} throughout.\n\nC: \
list valued, length 6, stands for the coefficient term in front of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubsuperscriptBox[
        RowBox[{"(", 
          RowBox[{"\[Sigma]", 
            StyleBox["d", "TI"], 
            StyleBox["B", "TI"]}], ")"}], 
        StyleBox["u", "TI"], 
        StyleBox["i", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "(\\sigma dB)_{u}^{i}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1cfb4dac-e2c5-4049-9dff-d159d6417ac8"],
 ". "
}], "Text",
 CellChangeTimes->{
  3.922426429221586*^9, 3.922426484453974*^9, {3.922426519452476*^9, 
   3.92242654585294*^9}},ExpressionUUID->"1c7bc487-a05b-49b6-8a55-\
5194d2309d3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Outputs:", "Subsection",
 CellChangeTimes->{{3.921400867639367*^9, 
  3.921400873319302*^9}},ExpressionUUID->"950300ea-fa61-43d6-a403-\
5968835fb531"],

Cell["\<\
length 2 list, 

first position: the full expression of the resulting term;

second position: the associated Kronecker delta term.\
\>", "Text",
 CellChangeTimes->{
  3.922426647010511*^9},ExpressionUUID->"5c6d3a65-480d-42fa-b0aa-\
a042ff3f64cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sixProductF", "[", "\n", 
   RowBox[{"i_", ",", "\n", "a_", ",", "\n", "drift_", ",", "\n", "C_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Get", " ", "the", " ", "partition", " ", "list", " ", "in", " ", "the", 
      " ", 
      RowBox[{"formula", ".", "\[IndentingNewLine]", "The"}], " ", "idea", 
      " ", "is", " ", "the", " ", "same", " ", "as", " ", "the", " ", 
      "partition", " ", "when", " ", "deriving", " ", "the", " ", "auxiliary",
       " ", "delta", " ", 
      RowBox[{"list", "."}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"partitionTwoList", "=", 
      RowBox[{"Subsets", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"associatedFourPartition", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Complement", "[", 
         RowBox[{"i", ",", 
          RowBox[{"partitionTwoList", "[", 
           RowBox[{"[", "counter", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"counter", ",", "5"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partitionOfAssociatedFourPartition", "=", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"associatedFourPartition", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"associatedFourPartition", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"associatedFourPartition", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"associatedFourPartition", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"associatedFourPartition", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"associatedFourPartition", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"associatedFourPartition", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"associatedFourPartition", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"associatedFourPartition", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"associatedFourPartition", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"associatedFourPartition", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"associatedFourPartition", "[", 
              RowBox[{"[", "counter", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]",
          "}"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"counter", ",", "5"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partitionList", " ", "=", " ", "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"(*", 
            RowBox[{"join", " ", "the", " ", "index", " ", "together"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"partitionTwoList", "[", 
             RowBox[{"[", "counter1", "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"partitionOfAssociatedFourPartition", "[", 
              RowBox[{"[", "counter1", "]"}], "]"}], "[", 
             RowBox[{"[", "counter2", "]"}], "]"}]}], "\[IndentingNewLine]", 
           "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"counter1", ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"counter2", ",", "3"}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Create", " ", "the", " ", "Kronecker", " ", "delta", " ", "list", " ", 
       "according", " ", "to", " ", "the", " ", "index", " ", 
       RowBox[{"partition", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"deltaList", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"partitionList", "[", 
             RowBox[{"[", "counter", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"partitionList", "[", 
             RowBox[{"[", "counter", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"partitionList", "[", 
             RowBox[{"[", "counter", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"partitionList", "[", 
             RowBox[{"[", "counter", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "*", 
         "\[IndentingNewLine]", 
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"partitionList", "[", 
             RowBox[{"[", "counter", "]"}], "]"}], "[", 
            RowBox[{"[", "5", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"partitionList", "[", 
             RowBox[{"[", "counter", "]"}], "]"}], "[", 
            RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", 
         RowBox[{"counter", ",", "15"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Create", " ", "the", " ", "covariance", " ", 
       RowBox[{"matrix", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"covSetup", "=", 
      RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"\[CapitalSigma]", ",", "\[IndentingNewLine]", 
            RowBox[{"i", "[", 
             RowBox[{"[", "counter1", "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"i", "[", 
             RowBox[{"[", "counter2", "]"}], "]"}]}], "\[IndentingNewLine]", 
           "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"counter1", ",", "6"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"counter2", ",", "6"}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Use", " ", "two"}], "-", 
       RowBox[{
       "product", " ", "function", " ", "to", " ", "fill", " ", "in", " ", 
        "the", " ", "covariance", " ", 
        RowBox[{"matrix", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"covTerm", "=", "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Refine", "[", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"twoProductF", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], ",", 
                RowBox[{"i", "[", 
                 RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], ",", 
                RowBox[{"a", "[", 
                 RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"drift", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], ",", 
                RowBox[{"drift", "[", 
                 RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"C", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], ",", 
                RowBox[{"C", "[", 
                 RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "6"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
         "]"}], "\[IndentingNewLine]", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"covMatrixRule", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"covSetup", "[", 
          RowBox[{"[", "counter", "]"}], "]"}], "\[Rule]", 
         RowBox[{"covTerm", "[", 
          RowBox[{"[", "counter", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"counter", ",", "36"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", 
      RowBox[{
       RowBox[{"Total", "[", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"\[CapitalSigma]", ",", 
             RowBox[{
              RowBox[{"partitionList", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"partitionList", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
           RowBox[{"Subscript", "[", 
            RowBox[{"\[CapitalSigma]", ",", 
             RowBox[{
              RowBox[{"partitionList", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"partitionList", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "*", 
           RowBox[{"Subscript", "[", 
            RowBox[{"\[CapitalSigma]", ",", 
             RowBox[{
              RowBox[{"partitionList", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], "[", 
              RowBox[{"[", "5", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"partitionList", "[", 
               RowBox[{"[", "counter", "]"}], "]"}], "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"counter", ",", "15"}], "}"}]}], "]"}], "]"}], "/.", 
       "covMatrixRule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"result", ",", "deltaList"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.911208873487455*^9, 3.911209006757084*^9}, {
  3.91120906578585*^9, 3.911209069901304*^9}, {3.921403296337194*^9, 
  3.921403373141275*^9}, {3.921403958359104*^9, 3.921403984244404*^9}, {
  3.922426560972545*^9, 3.922426583042328*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"dd53810f-8f8f-4462-a115-35b568e97f85"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The Symmetric function", "Chapter",
 CellChangeTimes->{{3.9224355062233143`*^9, 
  3.92243550975144*^9}},ExpressionUUID->"7e0114b2-b347-434a-a935-\
3064aabffbca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"symmetric", "[", "term_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp1", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"term", "/.", 
          RowBox[{"i", "\[Rule]", "k1"}]}], "/.", 
         RowBox[{"j", "\[Rule]", "l1"}]}], "/.", 
        RowBox[{"k", "\[Rule]", "i1"}]}], "/.", 
       RowBox[{"l", "\[Rule]", "j1"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"temp1", "/.", 
          RowBox[{"i1", "\[Rule]", "i"}]}], "/.", 
         RowBox[{"j1", "\[Rule]", "j"}]}], "/.", 
        RowBox[{"k1", "\[Rule]", "k"}]}], "/.", 
       RowBox[{"l1", "\[Rule]", "l"}]}]}], ";", "\[IndentingNewLine]", 
     "temp2"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.910806745371291*^9, 3.910806750231144*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"8d94c688-6bd8-477d-a484-cbf359d8217a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"symmetric2", "[", "term_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp1", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"term", "/.", 
            RowBox[{"i", "\[Rule]", "k1"}]}], "/.", 
           RowBox[{"j", "\[Rule]", "l1"}]}], "/.", 
          RowBox[{"k", "\[Rule]", "i1"}]}], "/.", 
         RowBox[{"l", "\[Rule]", "j1"}]}], "/.", 
        RowBox[{"p", "->", "q1"}]}], "/.", 
       RowBox[{"q", "->", "p1"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"temp1", "/.", 
            RowBox[{"i1", "\[Rule]", "i"}]}], "/.", 
           RowBox[{"j1", "\[Rule]", "j"}]}], "/.", 
          RowBox[{"k1", "\[Rule]", "k"}]}], "/.", 
         RowBox[{"l1", "\[Rule]", "l"}]}], "/.", 
        RowBox[{"p1", "->", "p"}]}], "/.", 
       RowBox[{"q1", "->", "q"}]}]}], ";", "\[IndentingNewLine]", "temp2"}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9108067759718027`*^9, 3.910806817100131*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"87238e59-37bc-4cb4-b7f1-5881370f4681"]
}, Open  ]]
},
WindowSize->{1061, 1027},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"14.0 for Mac OS X ARM (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d42cd059-aeae-4fa0-a814-4639fcfedbbb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 224, 4, 30, "Input",ExpressionUUID->"622a88d2-5018-4af6-8546-c6868657da8f"],
Cell[807, 28, 918, 13, 34, "Output",ExpressionUUID->"0b5d706a-a7de-4980-a6ce-f6b2968dc99d"]
}, Open  ]],
Cell[1740, 44, 1481, 37, 220, "Input",ExpressionUUID->"82a62473-b86e-40bb-8d40-a27094d513a1"],
Cell[CellGroupData[{
Cell[3246, 85, 167, 3, 69, "Chapter",ExpressionUUID->"b8d705e7-71c4-47df-9638-cf7624df4216"],
Cell[3416, 90, 424, 9, 58, "Text",ExpressionUUID->"871e7092-775b-4520-9b4a-0ad7d7a0ae72"],
Cell[3843, 101, 1640, 34, 61, "Text",ExpressionUUID->"cc3d0fa1-c919-4ba1-a3e9-5e777bf2648d"],
Cell[5486, 137, 11874, 333, 469, "Text",ExpressionUUID->"97dc56c2-148a-4914-be07-14f2233ef70f"],
Cell[17363, 472, 7171, 200, 348, "Text",ExpressionUUID->"aa2ec057-a4c6-4d4c-b072-c08851ed61f2"],
Cell[24537, 674, 6879, 192, 232, "Text",ExpressionUUID->"826606b0-33f8-477c-ad89-ea58b52a530b"],
Cell[31419, 868, 3588, 101, 160, "Text",ExpressionUUID->"9cff77cb-bd89-4f63-8e47-c30339f8a685"],
Cell[35010, 971, 12404, 319, 258, "Text",ExpressionUUID->"f1dd0c08-c7fa-4dc6-b04e-db6a2b64a40f"],
Cell[47417, 1292, 17286, 502, 608, "Text",ExpressionUUID->"d88f598b-4962-46ac-a21a-111743bca040"],
Cell[64706, 1796, 11494, 306, 539, "Text",ExpressionUUID->"a47c6f90-a60c-4a97-b005-4658a7351725"],
Cell[76203, 2104, 289, 7, 58, "Text",ExpressionUUID->"326b2e98-b275-40e0-b0ec-fbbe58930110"],
Cell[76495, 2113, 10798, 279, 499, "Text",ExpressionUUID->"2d61291d-ea5f-4318-adf1-50410028ee69"],
Cell[87296, 2394, 11039, 276, 411, "Text",ExpressionUUID->"be3e6ff6-b7e8-425a-b41e-516ec4c94e1a"],
Cell[98338, 2672, 5529, 129, 297, "Text",ExpressionUUID->"4057f7e3-51b5-49bc-8a56-b553e41086aa"],
Cell[103870, 2803, 19355, 518, 352, "Text",ExpressionUUID->"4efdc493-aa31-4a84-89db-4bd912501f7f"],
Cell[CellGroupData[{
Cell[123250, 3325, 378, 6, 65, "Subchapter",ExpressionUUID->"d6397ca6-fdf5-422a-a256-69020a92a015"],
Cell[123631, 3333, 475, 9, 58, "Text",ExpressionUUID->"760e5b17-16d7-4fbc-b7be-17ebf422751b"],
Cell[CellGroupData[{
Cell[124131, 3346, 653, 15, 56, "Subsection",ExpressionUUID->"85731122-edc7-4971-b1fd-da89335585ea"],
Cell[124787, 3363, 837, 18, 60, "Text",ExpressionUUID->"f8e3fd00-e6c3-4b7f-9ee0-bc0e132fb770"],
Cell[CellGroupData[{
Cell[125649, 3385, 2386, 63, 178, "Input",ExpressionUUID->"1b2b06fb-2c74-4475-b181-a6b74b788970"],
Cell[128038, 3450, 1858, 51, 77, "Output",ExpressionUUID->"7df90009-5eb1-4e9a-9ef1-89744f14d34a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129933, 3506, 2794, 71, 199, "Input",ExpressionUUID->"9571b2b4-e2af-498c-933b-e28bdd3b62c8"],
Cell[132730, 3579, 4919, 165, 60, "Output",ExpressionUUID->"2650e366-1f62-42a2-9851-c218289fcb00"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[137698, 3750, 643, 17, 57, "Subsection",ExpressionUUID->"8425f8be-9a2e-41b2-a051-5346127a734e"],
Cell[138344, 3769, 866, 17, 83, "Text",ExpressionUUID->"6ba185fe-ca14-473f-bd7d-1e2207d21a86"],
Cell[139213, 3788, 401, 8, 58, "Text",ExpressionUUID->"53880351-eced-48e8-b02b-92c7855fe2a2"],
Cell[CellGroupData[{
Cell[139639, 3800, 4311, 103, 556, "Input",ExpressionUUID->"44397d24-85a0-4d54-96a3-ff70190b4381"],
Cell[143953, 3905, 3750, 122, 60, "Output",ExpressionUUID->"8bb8e08c-b9a4-4c1e-a9f8-95f010c7b031"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[147752, 4033, 728, 19, 57, "Subsection",ExpressionUUID->"b46f4227-2ede-4941-8ac2-1a0267f8e0c5"],
Cell[148483, 4054, 999, 21, 83, "Text",ExpressionUUID->"3d12afc7-62b8-41bd-9a33-a00e1478c1b4"],
Cell[CellGroupData[{
Cell[149507, 4079, 3412, 81, 451, "Input",ExpressionUUID->"b4e4ea58-a506-443f-a794-74afa20f3dfc"],
Cell[152922, 4162, 3551, 132, 60, "Output",ExpressionUUID->"5894c31e-9df3-44ba-9c6a-66307933547d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[156546, 4302, 214, 4, 69, "Chapter",ExpressionUUID->"83e91c71-7610-41db-bc65-c921bbaf9637"],
Cell[CellGroupData[{
Cell[156785, 4310, 233, 4, 65, "Subchapter",ExpressionUUID->"8b460f9f-6771-45fa-9b48-a9724ed0ece5"],
Cell[157021, 4316, 1466, 38, 65, "Text",ExpressionUUID->"8cf64fe7-5da1-4a09-b739-6b7d7e7b02d7"],
Cell[158490, 4356, 3785, 105, 64, "Text",ExpressionUUID->"e88c1f8a-b65e-4196-8917-435cc95205e7"],
Cell[162278, 4463, 2998, 74, 110, "Text",ExpressionUUID->"b1f1cfbf-0961-4c22-9470-d8fcc80f3cfb"],
Cell[CellGroupData[{
Cell[165301, 4541, 155, 3, 54, "Subsection",ExpressionUUID->"c922f4db-06eb-4068-8621-017d6df18e23"],
Cell[165459, 4546, 1381, 34, 106, "Text",ExpressionUUID->"be6b7ec9-2382-4999-bee5-c708042b9069"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166877, 4585, 156, 3, 54, "Subsection",ExpressionUUID->"ae582b85-da77-49a2-b5aa-f601185c2131"],
Cell[167036, 4590, 312, 7, 58, "Text",ExpressionUUID->"4bd6cceb-bf3b-4842-a805-5d2ec99d251c"],
Cell[167351, 4599, 6967, 180, 497, "Input",ExpressionUUID->"31c87814-7601-44d9-9596-016f99e18240"]
}, Open  ]],
Cell[CellGroupData[{
Cell[174355, 4784, 151, 3, 67, "Section",ExpressionUUID->"6ee757fb-375a-4949-a93e-ca8df22a9e40"],
Cell[CellGroupData[{
Cell[174531, 4791, 704, 20, 30, "Input",ExpressionUUID->"e126293a-42ab-42e0-baf7-c152cc608aa7"],
Cell[175238, 4813, 737, 21, 54, "Output",ExpressionUUID->"26a4fe4a-d676-475c-afdd-9e83fc6e9559"]
}, Open  ]],
Cell[175990, 4837, 3684, 96, 167, "Text",ExpressionUUID->"129a39b1-b6d0-43c3-8e44-8ce822890760"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[179723, 4939, 172, 3, 65, "Subchapter",ExpressionUUID->"2174cc1f-05cc-47e1-b11b-4b1055f9d751"],
Cell[179898, 4944, 2619, 63, 95, "Text",ExpressionUUID->"095c330e-b689-462e-82c6-90d2289ebeaa"],
Cell[CellGroupData[{
Cell[182542, 5011, 155, 3, 54, "Subsection",ExpressionUUID->"60908d52-6695-41cc-8170-3a7f81b88db0"],
Cell[182700, 5016, 1676, 40, 96, "Text",ExpressionUUID->"48bbcabc-f1da-4af3-80c3-0b0b539c2999"]
}, Open  ]],
Cell[CellGroupData[{
Cell[184413, 5061, 156, 3, 54, "Subsection",ExpressionUUID->"e65690b3-70f9-4cdd-8f31-b02302663cd4"],
Cell[184572, 5066, 189, 3, 35, "Text",ExpressionUUID->"5a022667-9513-4f5e-86b3-eca66cb7ddfe"],
Cell[184764, 5071, 1310, 30, 325, "Input",ExpressionUUID->"5efc7cbd-c1b0-42ec-896a-48da319b850f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[186111, 5106, 152, 3, 67, "Section",ExpressionUUID->"b7f7cf0e-98f0-44f4-836c-47a729f75860"],
Cell[CellGroupData[{
Cell[186288, 5113, 757, 14, 178, "Input",ExpressionUUID->"90445e2f-35bb-4b62-b8f2-6b406624d08c"],
Cell[187048, 5129, 375, 9, 51, "Output",ExpressionUUID->"09b45ba4-c5fb-4d5f-bb09-6f5472d5ed2f"]
}, Open  ]],
Cell[187438, 5141, 2514, 65, 77, "Text",ExpressionUUID->"93072ec0-7d6a-4670-857e-111c16b9bdcf"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[190013, 5213, 266, 4, 69, "Chapter",ExpressionUUID->"a17ac781-a991-4a1e-a7ee-8bc635ef7515"],
Cell[CellGroupData[{
Cell[190304, 5221, 236, 4, 65, "Subchapter",ExpressionUUID->"d52f0ffc-6ed8-4c1b-9032-bbec44b6fb00"],
Cell[190543, 5227, 57524, 1477, 1675, "Text",ExpressionUUID->"0a98f787-b6db-48f3-9944-0ca70e126739"],
Cell[CellGroupData[{
Cell[248092, 6708, 155, 3, 54, "Subsection",ExpressionUUID->"6bfe10c5-a46b-40be-8bd6-c1b78a13fcc3"],
Cell[248250, 6713, 7402, 194, 338, "Text",ExpressionUUID->"0248316e-4572-41bd-9dc1-2f82dc63be4c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[255689, 6912, 158, 3, 54, "Subsection",ExpressionUUID->"4a284143-1269-4524-9df3-57938f9dcc79"],
Cell[255850, 6917, 3551, 82, 342, "Text",ExpressionUUID->"9c7264c6-d6d0-4590-984e-235e67436ebc"],
Cell[259404, 7001, 27307, 666, 2467, "Input",ExpressionUUID->"d856de01-7aac-4f2d-b25c-92d6176c8c6a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[286748, 7672, 205, 4, 67, "Section",ExpressionUUID->"d675b39d-6c12-4427-ae0e-cd34cb2aa084"],
Cell[286956, 7678, 3160, 79, 83, "Text",ExpressionUUID->"ea5a8cb5-96cc-4654-b431-4a2c74543def"],
Cell[290119, 7759, 174, 3, 35, "Text",ExpressionUUID->"b7f49a90-ec5c-42a0-acee-9f07617d4901"],
Cell[CellGroupData[{
Cell[290318, 7766, 1146, 28, 157, "Input",ExpressionUUID->"919dcf02-4f34-4be9-a8af-6a515b79ff6d"],
Cell[291467, 7796, 2334, 71, 98, "Output",ExpressionUUID->"5ee32e5e-4117-4a71-ad27-86dab402131f"]
}, Open  ]],
Cell[293816, 7870, 8121, 211, 154, "Text",ExpressionUUID->"2b32bfa5-1f1e-4940-965a-39017ede9d03"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[301986, 8087, 171, 3, 65, "Subchapter",ExpressionUUID->"5207fd74-ae97-4fa1-837a-e32dfa006f9b"],
Cell[302160, 8092, 452, 8, 58, "Text",ExpressionUUID->"f587a9c2-ec5b-49fa-a027-bb6a256dce2e"],
Cell[302615, 8102, 4117, 89, 703, "Input",ExpressionUUID->"1d730cd9-aae4-4aaa-a961-28964d39286d"],
Cell[CellGroupData[{
Cell[306757, 8195, 154, 3, 67, "Section",ExpressionUUID->"15154530-0edb-442e-a06b-494f90db3d66"],
Cell[306914, 8200, 260, 6, 35, "Text",ExpressionUUID->"95cec26c-b572-4731-a335-f0bfe04c1486"],
Cell[CellGroupData[{
Cell[307199, 8210, 819, 17, 199, "Input",ExpressionUUID->"6df981a9-81ef-4cac-a6a7-349c49cd5e4b"],
Cell[308021, 8229, 681, 21, 49, "Output",ExpressionUUID->"94828532-418c-4acf-9e55-8f46ad001d7b"]
}, Open  ]],
Cell[308717, 8253, 4088, 102, 83, "Text",ExpressionUUID->"3cd8052b-2141-435d-8308-29167449dda7"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[312866, 8362, 215, 4, 69, "Chapter",ExpressionUUID->"d82f19be-d0ff-44b1-9202-4a96e5e5021e"],
Cell[CellGroupData[{
Cell[313106, 8370, 256, 4, 65, "Subchapter",ExpressionUUID->"c4e424ff-b5c8-4bb2-808b-7fdebf20ea9f"],
Cell[313365, 8376, 9302, 254, 289, "Text",ExpressionUUID->"5244e795-3771-497b-8b1a-27039f7ee06b"],
Cell[CellGroupData[{
Cell[322692, 8634, 155, 3, 54, "Subsection",ExpressionUUID->"d8f29fbd-096a-4222-b464-7281c8f4709c"],
Cell[322850, 8639, 3364, 90, 179, "Text",ExpressionUUID->"77a04de1-6ccd-4080-abb1-51e0cf2a2821"]
}, Open  ]],
Cell[CellGroupData[{
Cell[326251, 8734, 156, 3, 54, "Subsection",ExpressionUUID->"4541c047-42d5-4b8f-b978-2027faef9eec"],
Cell[326410, 8739, 308, 10, 127, "Text",ExpressionUUID->"cee4db3f-6db6-409e-9081-e443bf0634d9"],
Cell[326721, 8751, 9605, 240, 1144, "Input",ExpressionUUID->"968698a3-912c-4935-b5d8-48baad63daaf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[336363, 8996, 152, 3, 67, "Section",ExpressionUUID->"2673d6e3-047f-4b94-94b9-f5256737fe5b"],
Cell[CellGroupData[{
Cell[336540, 9003, 989, 29, 136, "Input",ExpressionUUID->"43751d8c-343e-4674-a11c-5725402b4519"],
Cell[337532, 9034, 2954, 96, 84, "Output",ExpressionUUID->"a89802cd-aee2-4d22-8005-5714c62bb226"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[340547, 9137, 171, 3, 65, "Subchapter",ExpressionUUID->"5022d66a-1ebd-4f68-9e0a-de482d3660ec"],
Cell[340721, 9142, 263, 6, 35, "Text",ExpressionUUID->"cbb4aaff-1a41-4ad6-9532-2fe986145814"],
Cell[340987, 9150, 1398, 31, 346, "Input",ExpressionUUID->"c9b60cc4-5fdd-41d0-830c-986e54fb2d67"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[342434, 9187, 318, 5, 69, "Chapter",ExpressionUUID->"ff7936bd-7846-4c8e-a752-80e3ffcdb983"],
Cell[342755, 9194, 20225, 515, 627, "Text",ExpressionUUID->"fc0ac06d-efb9-402f-b210-99f3286302ad"],
Cell[CellGroupData[{
Cell[363005, 9713, 275, 4, 65, "Subchapter",ExpressionUUID->"a9eb2cc4-a4a7-4d03-88f0-77715be500a8"],
Cell[363283, 9719, 19835, 506, 465, "Text",ExpressionUUID->"e48edd50-8a5b-43df-9ed4-714055556481"],
Cell[CellGroupData[{
Cell[383143, 10229, 155, 3, 54, "Subsection",ExpressionUUID->"d37e1ed8-b2db-4303-98ff-08959e6d74e1"],
Cell[383301, 10234, 7014, 186, 323, "Text",ExpressionUUID->"181ddba6-1f35-42b2-a5f7-5b10ef9dd69b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[390352, 10425, 155, 3, 54, "Subsection",ExpressionUUID->"576b6152-68e4-4d8c-8ed7-8714c34746dd"],
Cell[390510, 10430, 5092, 127, 415, "Text",ExpressionUUID->"ed3df861-e7cf-484b-a827-5524892913b0"],
Cell[395605, 10559, 19774, 461, 2467, "Input",ExpressionUUID->"0053fbec-cc28-4366-92a7-5699f099dd6e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[415428, 11026, 254, 5, 65, "Subchapter",ExpressionUUID->"6a0a86ff-9c18-4ec9-b93c-1a1482de963f"],
Cell[415685, 11033, 239, 4, 35, "Text",ExpressionUUID->"df797d7f-5320-42d8-8b92-6108e140c4a6"],
Cell[415927, 11039, 5462, 115, 871, "Input",ExpressionUUID->"597c431c-2b39-4e17-a00c-78cf03e19af9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[421426, 11159, 215, 4, 65, "Subchapter",ExpressionUUID->"407291c8-1c19-4ea0-8b8c-4b484abbe882"],
Cell[421644, 11165, 16996, 434, 476, "Text",ExpressionUUID->"3a056efe-b1b7-4774-bf9a-97efe153747f"],
Cell[CellGroupData[{
Cell[438665, 11603, 154, 3, 54, "Subsection",ExpressionUUID->"b09a3f0e-c888-42fe-af90-c1a20c16958d"],
Cell[438822, 11608, 7303, 192, 323, "Text",ExpressionUUID->"4cfe7fca-839b-42da-9165-f8086af277ad"]
}, Open  ]],
Cell[CellGroupData[{
Cell[446162, 11805, 156, 3, 54, "Subsection",ExpressionUUID->"33ce07f6-f751-4b07-b25d-4f7c9f2c8091"],
Cell[446321, 11810, 3146, 75, 434, "Text",ExpressionUUID->"d291d3a9-8ea8-4273-a145-4262ff4b8d18"],
Cell[449470, 11887, 60315, 1329, 4378, "Input",ExpressionUUID->"8c591470-cb00-4e60-8973-f2cdc5f5cd6e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[509834, 13222, 179, 3, 65, "Subchapter",ExpressionUUID->"189a3ee7-7ada-4669-a260-5f3dd18f7f96"],
Cell[510016, 13227, 410, 8, 58, "Text",ExpressionUUID->"4893a9cf-c8c5-47d9-ae5b-9529482afe0f"],
Cell[510429, 13237, 4992, 105, 808, "Input",ExpressionUUID->"f8b00002-a7f0-4222-976a-68dcef50ce38"],
Cell[515424, 13344, 74, 0, 67, "Section",ExpressionUUID->"f35a845a-d1ae-48be-ba89-a45ffae60105"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[515547, 13350, 480, 13, 71, "Chapter",ExpressionUUID->"e3b369e7-2e32-42d4-9da3-4f19ab9f3538"],
Cell[516030, 13365, 14014, 361, 342, "Text",ExpressionUUID->"3652ab7c-bf59-45cd-a8cb-1de406724c98"],
Cell[CellGroupData[{
Cell[530069, 13730, 555, 14, 66, "Subchapter",ExpressionUUID->"4952b58e-3154-4963-a922-7e2ad90b6b08"],
Cell[530627, 13746, 27559, 727, 824, "Text",ExpressionUUID->"d16cf9ae-9617-4742-ab94-987d38cd3b4a"],
Cell[CellGroupData[{
Cell[558211, 14477, 157, 3, 54, "Subsection",ExpressionUUID->"9db7a8ba-d586-4891-8e13-fc6a8a76cbd9"],
Cell[558371, 14482, 9333, 236, 431, "Text",ExpressionUUID->"eac58e38-bbe8-4999-800b-81aa7e866b2e"],
Cell[567707, 14720, 22264, 537, 2446, "Input",ExpressionUUID->"ce39a138-2306-4efe-b022-5b4b6a96c5ec"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[590020, 15263, 483, 13, 66, "Subchapter",ExpressionUUID->"446e3bec-fbc8-44aa-ab08-308597f66d2f"],
Cell[590506, 15278, 40630, 1054, 1377, "Text",ExpressionUUID->"6e626875-a5bf-4c64-89bf-fe458ebad088"],
Cell[CellGroupData[{
Cell[631161, 16336, 155, 3, 54, "Subsection",ExpressionUUID->"94d28d4b-2f03-4d29-be5f-28e6f3e0c431"],
Cell[631319, 16341, 8760, 225, 433, "Text",ExpressionUUID->"d4f2dede-f0e7-4189-8847-c4fac1e7f746"],
Cell[640082, 16568, 33126, 773, 3412, "Input",ExpressionUUID->"648ef99f-bcc7-4597-935a-89f0c2ab6cc4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[673257, 17347, 493, 13, 66, "Subchapter",ExpressionUUID->"beddff38-b462-430f-874a-41c2a9bc2165"],
Cell[673753, 17362, 196, 3, 35, "Text",ExpressionUUID->"2bd5cebc-ed31-4f55-9d3b-ac638c045235"],
Cell[673952, 17367, 5371, 113, 871, "Input",ExpressionUUID->"f7d607b3-2d1d-4db8-ae32-11532ef6f73f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[679360, 17485, 493, 13, 66, "Subchapter",ExpressionUUID->"157f6fec-6039-404c-a886-eebcd19d3ce2"],
Cell[679856, 17500, 170, 3, 35, "Text",ExpressionUUID->"228beb30-0f70-4727-82b5-a6419c75a5a8"],
Cell[680029, 17505, 4473, 97, 724, "Input",ExpressionUUID->"64b659fd-2018-4683-9342-f204f412da55"],
Cell[684505, 17604, 74, 0, 67, "Section",ExpressionUUID->"f517fd4e-2bc4-40ca-b530-2324fff5d9cb"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[684628, 17610, 169, 3, 69, "Chapter",ExpressionUUID->"107e939d-be48-4dad-a451-c2f2bdd145a5"],
Cell[684800, 17615, 462, 9, 58, "Text",ExpressionUUID->"1acd5e39-22d1-4c4b-a023-0468a268dbaf"],
Cell[CellGroupData[{
Cell[685287, 17628, 159, 3, 54, "Subsection",ExpressionUUID->"ef3827ef-7538-4915-9410-b279047a1f14"],
Cell[685449, 17633, 3111, 81, 179, "Text",ExpressionUUID->"1c7bc487-a05b-49b6-8a55-5194d2309d3f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[688597, 17719, 156, 3, 54, "Subsection",ExpressionUUID->"950300ea-fa61-43d6-a403-5968835fb531"],
Cell[688756, 17724, 256, 9, 127, "Text",ExpressionUUID->"5c6d3a65-480d-42fa-b0aa-a042ff3f64cd"],
Cell[689015, 17735, 12398, 292, 1312, "Input",ExpressionUUID->"dd53810f-8f8f-4462-a115-35b568e97f85"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[701462, 18033, 168, 3, 69, "Chapter",ExpressionUUID->"7e0114b2-b347-434a-a935-3064aabffbca"],
Cell[701633, 18038, 1044, 27, 115, "Input",ExpressionUUID->"8d94c688-6bd8-477d-a484-cbf359d8217a"],
Cell[702680, 18067, 1313, 35, 115, "Input",ExpressionUUID->"87238e59-37bc-4cb4-b7f1-5881370f4681"]
}, Open  ]]
}
]
*)

